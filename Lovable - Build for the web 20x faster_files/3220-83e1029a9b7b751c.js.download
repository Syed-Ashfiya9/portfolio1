try{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{})["__faroBundleId_gptengineer-app"]="1763700104234434d6be17b"}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3220],{214:(e,t,s)=>{"use strict";s.d(t,{AE:()=>p,B1:()=>y,Um:()=>v,WW:()=>u,Ws:()=>g,Z8:()=>j,ZG:()=>f,ZS:()=>m,aR:()=>d,b0:()=>N,dO:()=>_,pk:()=>x,s0:()=>b,sC:()=>w,vD:()=>h,zJ:()=>c});var a=s(83220),r=s(92918),l=s(94087),n=s(15365),i=s(680),o=s(72632);let c=()=>(0,r.Tp)(i.x.ModelSelector),d=()=>(0,r.Tp)(i.x.InAppTeaching),u=()=>{let e=(0,n.WW)(),t=(0,r.Tp)(i.x.DownloadZip),s=(0,a.j4)(e=>e.currentWorkspace),{isBizOrEnterprisePlan:l}=(0,o.cb)(null==s?void 0:s.plan);return e||t||l},p=()=>(0,r.Tp)(i.x.Embed),m=()=>(0,r.Tp)(i.x.SetCreditLimit),h=()=>{let e=(0,r.Tp)(i.x.DashboardV2);return(0,l.Q)(r.PostHogExperiment.DASHBOARD_V2_EXPERIMENT,{control:!1,test:!0})||e},x=()=>(0,r.Tp)(i.x.ThemeSelectorTool),g=()=>(0,r.Tp)(i.x.ChatFullscreen),f=()=>(0,r.Tp)(i.x.ThemeSelectorTool),v=()=>(0,r.Tp)(i.x.DesignLibraries),b=()=>(0,r.Tp)(i.x.ShopifyExistingStores),j=()=>(0,r.Tp)(i.x.AppStore),w=()=>{var e;return null!=(e=(0,r.Tp)(i.x.ThemeSelectorTool))&&e},y=()=>(0,r.Tp)(i.x.DesignSystemLibraries),_=()=>(0,r.Tp)(i.x.Notifications),N=()=>(0,r.Tp)(i.x.LargePromptbox)},2231:(e,t,s)=>{"use strict";s.d(t,{h:()=>i});var a=s(77145),r=s(67539),l=s(72632),n=s(51573);function i(e){let{options:t,selectedOption:s,onSelect:i,disabled:o=!1,disabledText:c,showCreditDifference:d=!1,currentPlanLimit:u,priceInDropdown:p}=e,m=e=>{let t=(0,l.RL)(e);if(d&&void 0!==u){let s=t-u;if(e===n.VL.KTLO)return"5 daily credits";if(s>0)return"+".concat(s," additional credits");if(0===s)return"No additional credits"}return"".concat(t," credits / month")},h=()=>m(s);if(o){let e=c||h();return e?(0,a.jsx)("div",{className:"flex w-full items-center justify-between rounded-md border border-muted-border bg-muted px-3 py-2 text-sm text-muted-foreground",children:e}):null}return(0,a.jsxs)(r.l6,{value:s,onValueChange:i,disabled:o,children:[(0,a.jsx)(r.bq,{className:"justify-start bg-background",children:(0,a.jsxs)("span",{className:"flex min-w-0 flex-1 items-center gap-2",children:[(0,a.jsx)("span",{className:"min-w-0 truncate",children:h()}),(null==p?void 0:p.show)&&(0,a.jsxs)("span",{className:"ml-auto shrink-0 whitespace-nowrap text-muted-foreground",children:["$",p.getDisplayPrice(s)," / month"]})]})}),(0,a.jsx)(r.gC,{children:t.map(e=>(0,a.jsx)(r.tJ,{value:e,label:m(e),endContent:(null==p?void 0:p.show)?(0,a.jsxs)("span",{className:"text-muted-foreground",children:["$",p.getDisplayPrice(e)," / month"]}):void 0,showIndicator:!1,variant:"twilight"},e))})]})}},3201:(e,t,s)=>{"use strict";s.d(t,{R:()=>ep,u:()=>eu});var a=s(77145),r=s(95661),l=s(49974),n=s(53384),i=s(26158),o=s(20247),c=s(72632),d=s(91169),u=s(51573),p=s(76058),m=function(e){return e.SUGGEST_LOWER_PLAN="SUGGEST_LOWER_PLAN",e.FEATURES_TO_TRY="FEATURES_TO_TRY",e.KTLO_OFFER="KTLO_OFFER",e.FEEDBACK="FEEDBACK",e.FINAL_CONFIRMATION="FINAL_CONFIRMATION",e}({});let h=(0,r.createContext)(void 0),x=e=>{let{children:t,targetPlan:s,onCancel:n,workspace:i}=e,o=i.plan!==p.G.KTLO&&s===u.VL.FREE,c=(0,r.useCallback)(()=>o?m.KTLO_OFFER:m.FEEDBACK,[o]),x=(0,r.useMemo)(()=>c(),[c]),[g,f]=(0,r.useState)(x),[v,b]=(0,r.useState)({reason:""}),[j,w]=(0,r.useState)(!1),y=(0,l.et)(),{toCheckout:_}=(0,d.R)(),N=async e=>{w(!0);try{let t=null!=e?e:s;(null==i?void 0:i.id)&&(t&&t!==u.VL.FREE?await _({plan:t,workspaceId:i.id,grandfatheredDiscount:!1,planType:y.planType,changeType:"downgrade"}):(await y.cancelSubscription(),n()))}finally{w(!1)}},C=async()=>{w(!0);try{(null==i?void 0:i.id)&&await _({plan:u.VL.KTLO,workspaceId:i.id,grandfatheredDiscount:!1,planType:"monthly",changeType:"downgrade"})}catch(e){w(!1)}},P={currentStep:g,feedback:v,currentPlan:i.plan,targetPlan:null!=s?s:u.VL.FREE,shouldShowKtloOffer:o,setCurrentStep:f,setFeedback:b,onCancel:n,onConfirm:N,onSwitchToKtlo:C,isLoading:j||y.isCancelSubscriptionLoading,getNextStepAfterSuggestLowerPlan:()=>m.FEATURES_TO_TRY,getNextStepAfterFeatures:c,getNextStepAfterKtlo:()=>m.FEEDBACK,getNextStepAfterFeedback:()=>m.FINAL_CONFIRMATION,getPreviousStepBeforeFeedback:()=>o?m.KTLO_OFFER:m.FEATURES_TO_TRY,getPreviousStepBeforeFinalConfirmation:()=>m.FEEDBACK};return(0,a.jsx)(h.Provider,{value:P,children:t})},g=()=>{let e=(0,r.useContext)(h);if(void 0===e)throw Error("useDowngrade must be used within a DowngradeProvider");return e};var f=s(92912),v=s(52811),b=s(6397),j=s(77563),w=s(26846),y=s(39528),_=s(56024);let N=[{value:"technical_issues",label:"I am having too many technical issues"},{value:"too_expensive",label:"It's too expensive"},{value:"not_using",label:"I'm not using Lovable enough"},{value:"missing_features",label:"It's missing features"},{value:"switched_to_competitor",label:"I switched to a competitor"},{value:"other",label:"Other reason"}],C=[{id:"custom-domains",name:"Custom domains",description:"Connect your own domain to your projects",icon:"link"},{id:"team-collab",name:"Team collaboration",description:"Invite team members to work together",icon:"people"},{id:"visual-editor",name:"Visual editor",description:"Edit the frontend of your project instantly",icon:"draw"},{id:"code-editor",name:"Code editor",description:"Edit the backend of your project in code",icon:"code"},{id:"chat-mode",name:"Chat mode",description:"Plan your next step with AI",icon:"message_text"},{id:"security-checks",name:"Security checks",description:"Run checks when publishing with Supabase to find and fix vulnerabilities",icon:"shield"}];var P=s(27458);let E=e=>{let{title:t,description:s}=e;return(0,a.jsxs)("div",{className:"flex flex-col items-start gap-4",children:[(0,a.jsx)(P.Fy,{className:"h-9"}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)(o.L3,{className:"text-2xl font-medium md:text-3xl",children:t}),s&&(0,a.jsx)(o.rr,{className:"text-base text-muted-foreground",children:s})]})]})},k=()=>{let e=g();return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,a.jsx)(E,{title:"Why are you downgrading?",description:"We use this information to improve our product."}),(0,a.jsx)(w.z,{value:e.feedback.reason,onValueChange:t=>e.setFeedback({...e.feedback,reason:t}),className:"flex flex-col gap-1",children:N.map(t=>(0,a.jsxs)("div",{className:(0,_.cn)("flex cursor-pointer items-center gap-3 rounded-lg px-4 py-3 transition-colors",e.feedback.reason===t.value?"bg-primary/5":"hover:bg-muted/50"),onClick:()=>e.setFeedback({...e.feedback,reason:t.value}),children:[(0,a.jsx)(w.C,{value:t.value,id:t.value}),(0,a.jsx)(j.Label,{htmlFor:t.value,className:"text-base font-normal leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:t.label})]},t.value))}),(0,a.jsx)(b.p,{placeholder:"Tell us more about your decision...",className:"h-12",maxLength:500,value:e.feedback.additionalNotes,onChange:t=>e.setFeedback({...e.feedback,additionalNotes:t.target.value})}),(0,a.jsxs)("div",{className:"flex flex-col gap-4 pt-2",children:[(0,a.jsx)(v.$,{variant:"affirmative",className:"w-full",onClick:()=>{f.Ay.capture(y.rz.FEEDBACK.KEEP_PLAN_CLICKED),e.onCancel()},children:"Keep current plan"}),(0,a.jsx)(v.$,{variant:"outline",className:"w-full",onClick:()=>{f.Ay.capture(y.rz.FEEDBACK.CONTINUE_CLICKED,{reason:e.feedback.reason}),e.setCurrentStep(e.getNextStepAfterFeedback())},children:"Downgrade plan"})]})]})})};var I=s(6698),A=s(31088),S=s(75222),L=s(65949),T=s(69730),R=s(63851),O=s(19620);let D=e=>{let{children:t,className:s}=e;return(0,a.jsx)("div",{className:(0,_.cn)("rounded-xl border bg-background p-5",s),children:t})},F=S.Ik({reason:S.Yj().optional(),additional_notes:S.Yj().max(500,"Additional notes must be less than 500 characters").optional()}),M=()=>{let e=g(),t=(0,R.P)(),s=(0,I.n)({mutationFn:async()=>{let s=F.parse({reason:e.feedback.reason,additional_notes:e.feedback.additionalNotes});await t.post("/user/cancellation",s),await e.onConfirm()},onSuccess:()=>{f.Ay.capture(y.rz.FINAL_CONFIRMATION.CONFIRM_CLICKED,{from_plan:e.currentPlan,to_plan:e.targetPlan})},onError:e=>{if(O.logging.error("Error submitting feedback:",e),e instanceof L.G){let t=e.errors[0];A.toast.error("Validation Error",{description:t.message})}else{var t;A.toast.error("Error",{description:(null==(t=e.data)?void 0:t.detail)||"Failed to submit feedback"})}}}),r=((e,t)=>{let s=(0,c.m6)(e),a=(0,c.m6)(t),r=(0,c.RL)(e),l=(0,c.RL)(t);if("pro"===s){if("pro"===a)return[{text:"Credit limit will decrease from ".concat(r," to ").concat(l," per month"),isPositive:!1},{text:"Credit rollover maximum will be ".concat(l," from next month"),isPositive:!1},{text:"You keep all of your current Pro plan features",isPositive:!0}];if("free"===a)return[{text:"All new projects will be public",isPositive:!1},{text:"A Lovable badge will be added to all new projects",isPositive:!1},{text:"You will lose team management features",isPositive:!1},{text:"Custom domains will be removed",isPositive:!1},{text:"Monthly credit limit will decrease from ".concat(r," to 0"),isPositive:!1},{text:"Credit rollover will be disabled",isPositive:!1}]}if("biz"===s){if("biz"===a)return[{text:"Credit limit will decrease from ".concat(r," to ").concat(l," per month"),isPositive:!1},{text:"Credit rollover maximum will be ".concat(l," from next month"),isPositive:!1},{text:"You keep all of your current Business plan features",isPositive:!0}];if("pro"===a)return[{text:"No SSO",isPositive:!1},{text:"No design templates",isPositive:!1},{text:"No data opt out",isPositive:!1},{text:"No personal projects",isPositive:!1},{text:"Credit limit will decrease from ".concat(r," to ").concat(l," per month"),isPositive:!1},{text:"Credit rollover maximum will be ".concat(l," from next month"),isPositive:!1},{text:"You keep all of your current Pro plan features",isPositive:!0}];if("free"===a)return[{text:"No SSO",isPositive:!1},{text:"No design templates",isPositive:!1},{text:"No data opt out",isPositive:!1},{text:"No personal projects",isPositive:!1},{text:"All new projects will be public",isPositive:!1},{text:"A Lovable badge will be added to all new projects",isPositive:!1},{text:"You will lose team management features",isPositive:!1},{text:"Custom domains will be removed",isPositive:!1},{text:"Monthly credit limit will decrease from ".concat(r," to 0"),isPositive:!1},{text:"Credit rollover will be disabled",isPositive:!1}]}return"ktlo"===a?[{text:"Credits will change from ".concat(r," per month to freemium (").concat(5," per day, up to 30 per month)"),isPositive:!1},{text:"No credit rollovers",isPositive:!1},{text:"You keep: Pro features: Private Projects, No Lovable Badge, Roles and Permissions, Custom Domains",isPositive:!0}]:[]})(e.currentPlan,e.targetPlan);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(E,{title:"Continue downgrading?",description:"Keep your momentum. Finish your project. You can do it."}),(0,a.jsxs)(D,{children:[(0,a.jsx)("div",{className:"mb-4 text-lg font-medium",children:"Here is what will change if you downgrade:"}),(0,a.jsxs)("ul",{className:"flex flex-col gap-4",children:[0===r.length&&(0,a.jsxs)("li",{className:"flex items-start gap-3",children:[(0,a.jsx)(T.A,{name:"x",className:"size-5"}),(0,a.jsx)("span",{children:"Features of your current plan"})]}),r.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-start gap-3",children:[(0,a.jsx)(T.A,{name:e.isPositive?"check":"x",className:"size-5 ".concat(e.isPositive?"text-green-600":"text-muted-foreground")}),(0,a.jsx)("span",{children:e.text})]},t))]}),(0,a.jsx)(v.$,{variant:"outline",className:"mt-4 w-full",onClick:()=>{f.Ay.capture(y.rz.FINAL_CONFIRMATION.KEEP_PLAN_CLICKED),e.onCancel()},children:"Keep current plan"})]}),(0,a.jsx)(v.$,{variant:"destructive",className:"w-full",onClick:()=>s.mutate(),loading:s.isPending,children:"Confirm downgrade"})]})};var U=s(92918),W=s(94087);let B={control:15,variant1:9,variant2:5},K=(0,c.jL)({id:u.VL.PRO_1,type:"monthly"}),V=()=>{let e=g(),t=(0,W.Q)(U.PostHogExperiment.LITE_PRICING,B),s=Math.round((K-t)/K*100),r=f.Ay.getFeatureFlag(U.PostHogExperiment.LITE_PRICING),l=async()=>{f.Ay.capture(y.rz.KTLO_OFFER.SWITCH_CLICKED,{plan_price:t,experiment_variant:r,experiment_name:U.PostHogExperiment.LITE_PRICING}),await e.onSwitchToKtlo()};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(E,{title:"Switch to Lite",description:"Try our new Lite plan and retain important features that keep your project going."}),(0,a.jsxs)(D,{children:[(0,a.jsx)("div",{className:"mb-2 text-lg font-medium",children:"Lite plan"}),(0,a.jsxs)("div",{className:"mb-2 flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"text-3xl font-medium md:text-4xl",children:["$",t]}),(0,a.jsx)("span",{className:"text-base font-medium text-muted-foreground",children:"per month"}),(0,a.jsxs)("span",{className:"rounded bg-success px-2 py-0.5 text-xs text-success-foreground",children:[s,"% off"]})]}),(0,a.jsx)("ul",{className:"mt-4 flex flex-col gap-3",children:["5 daily credits","Keep custom domains","No Lovable badge","Team settings stay in place"].map((e,t)=>(0,a.jsxs)("li",{className:"flex items-center gap-2",children:[(0,a.jsx)(T.A,{name:"check",className:"size-5"}),(0,a.jsx)("span",{children:e})]},t))}),(0,a.jsx)(v.$,{className:"mt-6 w-full",variant:"affirmative",onClick:l,loading:e.isLoading,children:"Switch to Lite"})]}),(0,a.jsx)(v.$,{variant:"outline",className:"w-full",onClick:()=>{f.Ay.capture(y.rz.KTLO_OFFER.CONTINUE_DOWNGRADE_CLICKED,{plan_price:t,experiment_variant:r,experiment_name:U.PostHogExperiment.LITE_PRICING}),e.setCurrentStep(e.getNextStepAfterKtlo())},children:"Downgrade plan"})]})},z=()=>{let e=g();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(E,{title:"Have you tried these features?"}),(0,a.jsxs)(D,{children:[(0,a.jsx)("div",{className:"flex flex-col gap-1.5 md:gap-2",children:C.map(e=>(0,a.jsxs)("div",{className:"flex items-start gap-3 rounded-lg px-2 py-2 transition-colors md:gap-4 md:px-3",children:[(0,a.jsx)("span",{className:"mt-1.5 select-none text-base md:mt-2 md:text-lg",children:(0,a.jsx)(T.A,{name:e.icon,className:"h-4 w-4"})}),(0,a.jsxs)("div",{className:"flex flex-1 flex-col gap-0.5",children:[(0,a.jsx)(j.Label,{htmlFor:e.id,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description})]})]},e.id))}),(0,a.jsxs)(v.$,{variant:"affirmative",className:"mt-4 w-full",onClick:()=>{f.Ay.capture(y.rz.FEATURE_USAGE.KEEP_PLAN_CLICKED),e.onCancel()},children:["Keep Lovable ",(0,c._R)(e.currentPlan||"unknown")]})]}),(0,a.jsx)(v.$,{variant:"outline",onClick:()=>{f.Ay.capture(y.rz.FEATURE_USAGE.CONTINUE_CLICKED),e.setCurrentStep(e.getNextStepAfterFeatures())},children:"Downgrade plan"})]})};var Y=s(83220),G=s(2231),Z=s(47226),H=s(53792);let $=()=>{let e=g(),t=(0,l.et)(),s=(0,Y.j4)(e=>e.currentWorkspace),{isEnterprisePlan:n}=(0,c.cb)(t.currentPlan.id),i=(0,r.useMemo)(()=>(0,c.e3)(e.currentPlan,e.currentPlan.startsWith(H.lV)?"biz":"pro"),[e.currentPlan]),o=(0,r.useMemo)(()=>(null==s?void 0:s.plan)&&i.length>0&&!i.some(e=>e===(null==s?void 0:s.plan))?i[0]:null,[i,null==s?void 0:s.plan]),[d,u]=(0,r.useState)(o);(0,r.useEffect)(()=>{t.setPlanType("monthly")},[t.setPlanType]),(0,r.useEffect)(()=>{(null==s?void 0:s.plan)&&!d&&e.setCurrentStep(e.getNextStepAfterSuggestLowerPlan())},[null==s?void 0:s.plan,d,e]);let p=async()=>{d&&(f.Ay.capture(y.rz.SUGGEST_LOWER_PLAN.DOWNGRADE_CREDITS_CLICKED,{current_plan_id:e.currentPlan,target_plan_id:d,target_plan_type:t.planType,plan_price:t.getDisplayPrice(d)}),await e.onConfirm(d))};return d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(E,{title:"Downgrade now",description:"Do you want to downgrade by changing your monthly credits?"}),(0,a.jsxs)(D,{children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("div",{className:"text-lg font-medium",children:"Reduce monthly credits"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"text-3xl font-medium md:text-4xl",children:["$",t.getDisplayPrice(d)]}),(0,a.jsx)("span",{className:"text-base font-medium text-muted-foreground",children:"per month"})]}),(0,a.jsx)(G.h,{options:i,selectedOption:d,disabled:t.shouldDisableWorkspaceAdminActions,onSelect:u})]}),(0,a.jsx)(v.$,{className:"mt-4 w-full",variant:"affirmative",disabled:d===e.currentPlan||n||t.shouldDisableWorkspaceAdminActions,onClick:p,loading:e.isLoading,children:"Downgrade credits"})]}),(0,a.jsx)(v.$,{variant:"outline",onClick:()=>{f.Ay.capture(y.rz.SUGGEST_LOWER_PLAN.CONTINUE_CLICKED),e.setCurrentStep(e.getNextStepAfterSuggestLowerPlan())},children:"Downgrade plan"})]}):(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(Z.E,{className:"h-16 w-full"})})},q=()=>{let e=g();return(0,a.jsx)(a.Fragment,{children:(()=>{switch(e.currentStep){case m.SUGGEST_LOWER_PLAN:return(0,a.jsx)($,{});case m.FEATURES_TO_TRY:return(0,a.jsx)(z,{});case m.KTLO_OFFER:return(0,a.jsx)(V,{});case m.FEEDBACK:return(0,a.jsx)(k,{});case m.FINAL_CONFIRMATION:return(0,a.jsx)(M,{});default:return null}})()})};var Q=s(8974),J=s(63424),X=s(33966),ee=s(52873),et=s(69994),es=s(92763),ea=s(87252),er=s(30849),el=s(89931);let en=e=>{let{workspace:t}=e,s=(0,c._R)(t.plan),r=t.billing_period_end_date?(0,Q.GP)((0,el.ay)(t.billing_period_end_date),"MMM d, yyyy"):"";return(0,a.jsxs)("div",{className:"flex items-center justify-start gap-4",children:[(0,a.jsx)(er.default,{src:"/img/logo/lovable-logo-icon.svg",alt:"Lovable",width:36,height:36,className:"h-9 w-9"}),(0,a.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,a.jsxs)("p",{className:"text-base font-medium text-foreground",children:["You're on ",s," Plan"]}),(0,a.jsx)("p",{className:"text-base text-muted-foreground",children:t.plan_scheduled?"free"===t.plan_scheduled?"Cancels ".concat(r):"Updates ".concat(r):"Renews ".concat(r)})]})]})},ei=e=>{let{workspace:t,open:s,onOpenChange:r}=e,{createPortalSession:n,isCreatePortalSessionLoading:i,setFreePlanAsTarget:c,onDowngradeClick:d}=(0,l.et)(),u=async()=>{await n()},p=async()=>{await n()},m="free"===t.plan_scheduled;return(0,a.jsx)(o.lG,{open:s,onOpenChange:()=>{r(!1)},children:(0,a.jsxs)(o.Cf,{className:"sm:max-w-[500px]",children:[(0,a.jsxs)(o.c7,{children:[(0,a.jsx)(o.L3,{children:"Manage Plan"}),(0,a.jsx)(o.rr,{children:"Subscription & Billing Settings"})]}),(0,a.jsx)("div",{className:"flex flex-col gap-4 border-y py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4 rounded-xl bg-muted p-4",children:[(0,a.jsx)(en,{workspace:t}),m?(0,a.jsx)(v.$,{onClick:p,disabled:i,variant:"outline",children:i?"Opening...":"Cancel Downgrade"}):(0,a.jsx)(v.$,{variant:"outline",onClick:()=>{c(),d(),r(!1)},children:"Downgrade to Free"})]})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(v.$,{variant:"secondary",onClick:u,disabled:i,className:"w-5/6",children:i?"Opening...":"View Invoices"}),(0,a.jsx)(v.$,{onClick:u,disabled:i,className:"w-full",children:i?"Opening...":"Payment Preferences"})]})]})})},eo=e=>{let{workspace:t,shouldDisableWorkspaceAdminActions:s}=e,{cancelSubscriptionChanges:r,isCancelSubscriptionChangesLoading:n}=(0,l.et)();if(!t.plan_scheduled)return null;let i=e=>{let t=(0,c._R)(e),s=(0,c.RL)(e);return s>0?"".concat(t," (").concat(s," credits)"):t},o=i(t.plan),d=i(t.plan_scheduled),u=t.billing_period_end_date?(0,Q.GP)((0,el.ay)(t.billing_period_end_date),"MMM d, yyyy"):"",p=async()=>{await r()};return(0,a.jsx)("div",{className:"space-y-3",children:(0,a.jsx)("div",{className:"space-y-3 rounded-md bg-warning p-3",children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)(T.A,{name:"info_circle",size:"small",className:"mt-0.5 flex-shrink-0 text-warning-primary"}),(0,a.jsxs)("div",{className:"flex w-full flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-warning-primary",children:["Pending changes scheduled for ",u]}),(0,a.jsxs)("p",{className:"text-sm text-warning-primary",children:[o," â†’ ",d]})]}),(0,a.jsx)("div",{children:(0,a.jsx)(v.$,{variant:"warning",size:"default",disabled:n||s,onClick:p,children:n?"Canceling...":"Cancel changes"})})]})]})})})},ec=e=>{let{workspace:t}=e,[s,n]=(0,r.useState)(!1),i=(0,X.X5)(),o=(0,et.D)(t),{currentPlan:d,shouldDisableWorkspaceAdminActions:u}=(0,l.et)(),{canTopUpCredits:p}=(0,es.S)(t),m=(0,J.x_)(o.currentlyConsuming,o.sources),h=(0,c._R)(d.id),{isPaidPlan:x,isLegacyPlan:g,isEnterprisePlan:b,isFreePlan:j,isLitePlan:w,isAmbassadorPlan:_}=(0,c.cb)(t.plan),N=j||w,C=()=>(!g&&!_&&!w||(null==t?void 0:t.billing_period_credits_limit)!==0&&(null==t?void 0:t.billing_period_credits_limit)!==void 0)&&!j&&!!t.billing_period_credits_limit&&!(t.billing_period_credits_limit<=0)&&!0,P=(()=>{if(N||"free"===t.plan_scheduled)return{text:"No credits will rollover",icon:"x"};if(!C())return null;let e="annual"===t.plan_type,s=t.billing_period_credits_limit;return{text:"Up to ".concat((0,ea.Q)(e?12*s:s)," credits rollover"),icon:"check"}})(),E=(()=>{if(N)return"Daily credits reset at midnight UTC";if(!C()||!o.creditsResetDate||(null==t?void 0:t.plan_scheduled)==="free")return null;let e=(e=>{let t=new Date(e);return t.setTime(t.getTime()+18e5),t})(o.creditsResetDate),s=(0,Q.GP)(e,"dd MMM 'at' h:mm a"),a=t.plan_scheduled?(0,c.RL)(t.plan_scheduled):null,r=null!=a?a:t.billing_period_credits_limit;return r?"".concat((0,ea.Q)(r)," credits reset on ").concat(s):"Monthly credits reset on ".concat(s)})();return((0,r.useEffect)(()=>{p&&f.Ay.capture(y.ZK.BILLING_PAGE.SECTION_VIEWED,{credits_remaining:o.totalRemaining,current_plan:t.plan})},[p,o.totalRemaining,t.plan]),x)?(0,a.jsxs)("div",{className:"mx-auto flex w-full flex-col gap-4 lg:max-w-[888px]",children:[(0,a.jsx)(eo,{workspace:t,shouldDisableWorkspaceAdminActions:u}),(0,a.jsxs)("div",{className:"flex flex-col gap-6 lg:grid lg:grid-cols-3",children:[(0,a.jsx)(ee.Zp,{className:"rounded-xl bg-muted p-4 shadow-sm",children:(0,a.jsxs)("div",{className:"flex h-full flex-col justify-between gap-4",children:[(0,a.jsx)(en,{workspace:t}),!b&&(0,a.jsx)("div",{className:"flex justify-start",children:(0,a.jsx)(v.$,{variant:"muted",size:"sm",disabled:u,onClick:()=>n(!0),children:"Manage"})})]})}),(0,a.jsx)(ee.Zp,{className:"col-span-2 rounded-xl bg-muted p-4 shadow-sm outline outline-1 outline-offset-[-1px] outline-border",children:(0,a.jsxs)("div",{className:"flex h-full flex-col gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-base font-medium text-foreground",children:"Credits remaining"}),(0,a.jsxs)("p",{className:"text-sm font-normal text-muted-foreground",children:[(0,ea.Q)(o.totalRemaining)," of"," ",(0,ea.Q)(o.totalAllocation)]})]}),(0,a.jsx)(J.bY,{progressData:o}),(o.currentlyConsuming||0===o.totalRemaining)&&(0,a.jsxs)("div",{className:"flex flex-col gap-2 sm:relative sm:min-h-14",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-start sm:justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 sm:order-2",children:[(0,a.jsx)("div",{className:"ml-1 mr-0.5 h-2 w-2 rounded-full ".concat(m)}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:(0,J.bT)(o.currentlyConsuming)})]}),(P||E||o.topUpCreditsExpireDate)&&(0,a.jsxs)("div",{className:"flex flex-col gap-2 sm:order-1",children:[P&&(0,a.jsxs)("div",{className:"flex items-start gap-1.5",children:[(0,a.jsx)(T.A,{name:P.icon,size:"small",className:"mt-0.5 text-foreground"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:P.text})]}),E&&(0,a.jsxs)("div",{className:"flex items-start gap-1.5",children:[(0,a.jsx)(T.A,{name:"check",size:"small",className:"mt-0.5 text-foreground"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:E})]}),o.topUpCreditsExpireDate&&(0,a.jsxs)("div",{className:"flex items-start gap-1.5",children:[(0,a.jsx)(T.A,{name:"check",size:"small",className:"mt-0.5 text-foreground"}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Top up credits expire on"," ",(0,Q.GP)(o.topUpCreditsExpireDate,"dd MMM yyyy")]})]})]})]}),p&&(0,a.jsx)("div",{className:"flex justify-end sm:absolute sm:bottom-0 sm:right-0",children:(0,a.jsx)(v.$,{variant:"muted",size:"sm",disabled:u,onClick:()=>{f.Ay.capture(y.ZK.BILLING_PAGE.BUTTON_CLICKED,{credits_remaining:o.totalRemaining,current_plan:t.plan}),i({preSelectedOption:"topup"})},children:"Top up credits"})})]})]})})]}),!b&&(0,a.jsx)(ei,{workspace:t,open:s,onOpenChange:n})]}):"inactive"!==t.plan?(0,a.jsx)(ee.Zp,{className:"flex w-full flex-col gap-4 bg-muted p-4",children:(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(0,a.jsxs)("span",{children:["You're currently on plan: ",(0,a.jsx)("span",{className:"font-medium capitalize",children:h}),". "]})," ",(0,a.jsx)(ed,{workspace:t,children:"Manage your payment preferences and view past invoices"}),", or change your plan below."]})}):void 0},ed=e=>{let{workspace:t,children:s}=e,{createPortalSession:r,isCreatePortalSessionLoading:l}=(0,d.R)();return(0,a.jsx)("span",{role:"button",tabIndex:0,onClick:()=>{l||r({workspaceId:t.id})},onKeyDown:e=>{l||("Enter"===e.key||" "===e.key)&&r({workspaceId:t.id})},className:"inline cursor-pointer underline disabled:opacity-50","aria-disabled":l,children:s})},eu=e=>{let{workspace:t,onClose:s}=e,{targetDowngradePlan:r,setTargetDowngradePlan:n}=(0,l.et)();return(0,a.jsx)(o.Cf,{className:"pointer-events-auto flex max-h-[95vh] flex-col gap-4 overflow-y-auto outline-none",children:(0,a.jsx)(x,{targetPlan:null!=r?r:void 0,onCancel:()=>{n(null),s()},workspace:t,children:(0,a.jsx)(q,{})})})},ep=e=>{let{workspace:t}=e,{setPricingScenario:s}=(0,l.et)(),o="inactive"===t.plan,d=(0,c.cb)(t.plan).isEnterprisePlan;return(0,r.useEffect)(()=>{s("billing")},[s]),(0,a.jsxs)(i.Pt,{title:"Plans & credits",value:"billing",docsLink:"https://docs.lovable.dev/user-guides/messaging-limits",children:[o?(0,a.jsxs)("span",{children:["Your subscription is currently ",(0,a.jsx)("span",{className:"font-medium",children:"inactive"}),". You can select a new plan below to restore full functionality to your workspace."]}):null,(0,a.jsx)(ec,{workspace:t}),!d&&(0,a.jsx)(n.s,{showStudentDiscountCard:!0})]})}},6971:(e,t,s)=>{"use strict";s.d(t,{Y:()=>o});var a=s(53789),r=s(36119),l=s(63851),n=s(19620),i=s(69850);let o={workspace:e=>{let{workspaceId:t,userData:s}=e;return(0,a.j)({queryKey:i.a$.workspace(t),queryFn:async()=>{let e=(0,l.P)();return(await e.get("/user/workspaces/".concat(t))).workspace},enabled:!!s&&!!t})},experimentalFeatures:e=>{let{user:t}=e;return(0,a.j)({queryKey:i.a$.experimentalFeatures(),enabled:!!t&&!!t.idToken&&(0,r.H)(t),refetchOnWindowFocus:!1,queryFn:async()=>{let e=(0,l.P)();try{return await e.get("/users/".concat(null==t?void 0:t.uid,"/experimental-features"))}catch(e){return n.logging.error("Failed to fetch experimental features",{error:e}),null}}})},contributions:e=>{let{userId:t}=e;return(0,a.j)({queryKey:i.a$.contributions(t),queryFn:async()=>t?(0,l.P)().get("/users/".concat(t,"/contributions")):{},enabled:!!t})},publicProfile:e=>{let{username:t}=e;return(0,a.j)({queryKey:i.a$.profile(t),queryFn:()=>(0,l.g)().get("/profile/".concat(t)),enabled:!!t,staleTime:36e5,retry:!1})},studentDomains:()=>(0,a.j)({queryKey:i.a$.studentDomains(),queryFn:async()=>(0,l.P)().get("/user/student/domains")}),toolApprovalPreferences:()=>(0,a.j)({queryKey:i.a$.toolApprovalPreferences(),queryFn:async()=>(0,l.P)().get("/user/preferences/tool-preferences"),staleTime:6e5})}},7204:(e,t,s)=>{"use strict";s.d(t,{o:()=>r});var a=s(40074);let r=async e=>{let{projectId:t,deploymentId:s}=e;if(!t)throw Error("Project ID is required");let r=a.env.NEXT_PUBLIC_PROXY_WORKER_PROTOCOL||"https",l=new URL("".concat(r,"://deployments.").concat("lovable.app"));(l=new URL("https://proxy-worker.lovable.run")).pathname="/__l5e/proxy/new-deployment";let n=await fetch(l.toString(),{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({project_id:t,deployment_id:s})});if(!n.ok)throw Error("Failed to update deployment ID: ".concat(n.status));return n}},8904:(e,t,s)=>{"use strict";s.d(t,{U:()=>c});var a=s(18502),r=s(61374),l=s(82149),n=s(63851),i=s(69850),o=s(74507);let c=e=>{let t=(0,l.mb)(e=>e.projectId),{permitted:s}=(0,r.J)(o.eZ.ManageProjectSettings),{data:c,isLoading:d}=(0,a.I)({queryKey:i.gO.integration(null!=e?e:"","supabase"),queryFn:async()=>{let t=await (0,n.P)().get("/projects/".concat(e,"/integrations/supabase"));return""===t.supabase_project_id?null:t},enabled:!!e&&t===e&&s});return{supabaseIntegrationData:c,isSupabaseIntegrationDataLoading:d}}},21016:(e,t,s)=>{"use strict";s.d(t,{A:()=>n,f:()=>l});var a=s(95661),r=s(32738);let l={sm:640,md:768,lg:1024,xl:1280,"2xl":1536},n=e=>{if("number"==typeof e&&e<0)throw Error("Breakpoint value must be positive");let t=(0,r.A)(),s=(0,a.useMemo)(()=>"number"==typeof e?e:l[e],[e]);return(0,a.useMemo)(()=>void 0!==t.width&&t.width<s,[t.width,s])}},21227:(e,t,s)=>{"use strict";s.d(t,{D:()=>r});var a=s(54436);let r=()=>{let e={},t=(0,a.R)("_fbc");t&&(e.fbc=t);let s=(0,a.R)("_fbp");s&&(e.fbp=s);let r=(0,a.R)("_ttp");r&&(e.ttp=r);let l=(0,a.R)("ttclid");return l&&(e.ttclid=l),e}},21789:(e,t,s)=>{"use strict";s.d(t,{H:()=>n,k:()=>i});var a=s(77145),r=s(95661);let l=(0,r.createContext)(null),n=()=>(0,r.useContext)(l),i=e=>{let{children:t,searchParams:s}=e;return(0,a.jsx)(l.Provider,{value:s,children:t})}},24092:(e,t,s)=>{"use strict";s.d(t,{E:()=>u});var a=s(77145),r=s(36137),l=s(96373),n=s(95661),i=s(52811),o=s(69730),c=s(27458),d=s(56024);let u=e=>{let{title:t,description:s,children:u,open:p,onOpenChange:m,className:h}=e;return(0,n.useEffect)(()=>(p?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[p]),(0,a.jsx)(r.lG,{open:p,onOpenChange:m,children:(0,a.jsx)(r.ZJ,{children:(0,a.jsxs)(r.Cf,{className:"fixed inset-0 z-[10000] flex items-center justify-center overflow-y-auto bg-background",onCloseAutoFocus:e=>{e.preventDefault(),document.body.style.pointerEvents=""},children:[(0,a.jsxs)(l.s6,{children:[(0,a.jsx)(r.L3,{children:t}),(0,a.jsx)(r.rr,{children:s})]}),(0,a.jsxs)("div",{className:(0,d.cn)("flex max-h-full w-full max-w-96 flex-col gap-6 px-4 py-4 md:px-1",h),children:[(0,a.jsx)(c.Fy,{className:"size-9 shrink-0"}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("h2",{className:"mr-auto text-2xl md:text-3xl",children:t}),(0,a.jsx)("p",{className:"w-full",children:s})]}),u]}),(0,a.jsx)("div",{className:"absolute right-2 top-2 md:right-8 md:top-8",children:(0,a.jsx)(r.HM,{asChild:!0,children:(0,a.jsx)(i.$,{className:"hover:bg-transparent hover:opacity-75",variant:"ghost",children:(0,a.jsx)(o.A,{name:"x",size:"small"})})})})]})})})}},25080:(e,t,s)=>{"use strict";s.d(t,{Ft:()=>u,K4:()=>c,_A:()=>o,yj:()=>d});var a=s(95661),r=s(40911),l=s(99989),n=s(74507),i=s(81818);function o(e){let{workspaceId:t}=e,[s,o]=(0,a.useState)({query:"",status:"all",limit:i.m,offset:0}),{data:c,isLoading:d,error:u}=(0,r.I)({...l.y.searchWorkspaceMemberships({workspaceId:t,params:s}),permission:n.eZ.ViewWorkspaceMembers}),p=(0,a.useCallback)(e=>{o(t=>{let s={...t,...e};return(void 0!==e.query||void 0!==e.status||void 0!==e.roles)&&(s.offset=0),s})},[]),m=(0,a.useCallback)(()=>{(null==c?void 0:c.has_more)&&o(e=>({...e,offset:(e.offset||0)+i.m}))},[null==c?void 0:c.has_more]);return{members:(null==c?void 0:c.members)||[],total:(null==c?void 0:c.total)||0,hasMore:(null==c?void 0:c.has_more)||!1,isLoading:d,error:u,search:p,loadMore:m,searchParams:s}}function c(e){let{workspaceId:t}=e,{data:s,isLoading:a,error:i}=(0,r.I)({...l.y.searchWorkspaceMemberships({workspaceId:t,params:{query:"",status:"active",roles:["owner"],limit:1}}),permission:n.eZ.ViewWorkspaceMembers});return{owner:(null==s?void 0:s.members[0])||null,isLoading:a,error:i}}function d(e){let{workspaceId:t,status:s="active",enabled:a=!0}=e,{data:i}=(0,r.I)({...l.y.searchWorkspaceMemberships({workspaceId:t,params:{query:"",status:s,limit:1}}),permission:n.eZ.ViewWorkspaceMembers,enabled:a&&!!t});return{memberCount:(null==i?void 0:i.total)||0}}function u(e){let{workspaceId:t}=e,{data:s,isLoading:a}=(0,r.I)({...l.y.builderCount({workspaceId:t}),permission:n.eZ.ViewWorkspaceMembers,enabled:!!t});return{builderCount:s||0,isLoading:a}}},26158:(e,t,s)=>{"use strict";s.d(t,{G1:()=>x,Jz:()=>m,Pt:()=>h,WQ:()=>p,cY:()=>d,mm:()=>u});var a=s(77145),r=s(34400),l=s(47679),n=s(69730),i=s(21016),o=s(56024),c=s(39055);let d=e=>{let{href:t,className:s}=e;return(0,a.jsxs)("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:(0,o.cn)("flex items-center gap-1 text-sm text-muted-foreground duration-150 ease-in-out hover:text-muted-foreground/80",s),children:[(0,a.jsx)(n.A,{name:"question_circle",size:"small"}),"Docs"]})},u=e=>{let{children:t,className:s,...l}=e;return(0,a.jsx)(r.tU,{className:(0,o.cn)("mt-0 flex w-full flex-1 flex-col items-start overflow-hidden md:flex-row",s),orientation:"vertical",...l,children:t})},p=e=>{let{children:t,className:s,hasActiveTab:l,...n}=e;return(0,a.jsxs)(r.j7,{className:(0,o.cn)("mt-[22px] flex h-full w-full flex-col gap-0.5 overflow-y-auto px-4 py-6 md:mt-0 md:w-[240px] md:flex-nowrap md:border-r",s,l?"hidden md:flex":"flex"),...n,children:[(0,a.jsx)(g,{hideBackButton:!0,className:"mt-[22px]",children:"Settings"}),t]})},m=e=>{let{children:t,className:s,...l}=e;return(0,a.jsx)(r.Xi,{className:(0,o.cn)("flex min-h-10 w-full items-center justify-start gap-3 rounded-md px-2.5 py-2 text-start text-base data-[state=active]:bg-muted hover:bg-muted-hover md:min-h-8 md:w-auto md:gap-2 md:text-sm [&>svg]:size-5 md:[&>svg]:size-4",s),...l,children:t})},h=e=>{let{children:t,className:s,title:l,description:n,docsLink:i,descriptionAction:u,badge:p,customBadge:m,...h}=e;return(0,a.jsxs)(r.av,{className:(0,o.cn)("flex max-h-full w-full flex-1 flex-col gap-6 overflow-y-auto px-6 pb-6 pt-20 data-[state=inactive]:hidden focus:outline-none md:px-10 md:pt-6",s),...h,children:[l&&(0,a.jsxs)("div",{className:"hidden w-full flex-col gap-2 border-b pb-3 md:flex",children:[(0,a.jsxs)("h4",{className:"flex items-center gap-2 text-lg font-medium",children:[(0,a.jsx)("span",{"data-testid":"settings-tab-title",children:l}),p&&(0,a.jsx)(c.x,{badge:p}),m]}),n&&(0,a.jsxs)("div",{className:(0,o.cn)("flex items-start justify-between gap-2 text-sm text-muted-foreground"),children:[(0,a.jsx)("div",{className:"",children:n}),i&&(0,a.jsx)(d,{href:i}),u&&u]})]}),(0,a.jsx)(g,{descriptionAction:u,children:l}),t]})},x=e=>{let{title:t}=e;return(0,a.jsx)("div",{className:(0,o.cn)("mb-1 mt-6 px-3 text-sm font-medium text-muted-foreground first:mt-0 md:text-xs"),children:t})},g=e=>{let{children:t,className:s,hideBackButton:r=!1,descriptionAction:c,...d}=e,{openSettings:u}=(0,l.t)();return(0,i.A)("md")?(0,a.jsxs)("div",{className:(0,o.cn)("absolute inset-x-0 top-0 z-20 flex min-h-8 items-center justify-between border-b bg-background px-2 py-3 md:hidden",s),...d,children:[(0,a.jsx)("div",{className:"flex items-baseline",children:!r&&(0,a.jsxs)("button",{className:(0,o.cn)("flex items-center gap-1 text-base md:text-sm"),onClick:()=>u("settings"),"aria-label":"Back to settings menu",children:[(0,a.jsx)(n.A,{name:"chevron_left",size:"default"})," Settings"]})}),(0,a.jsx)("div",{className:"absolute left-1/2 flex -translate-x-1/2 items-baseline justify-center text-center text-lg font-medium","data-testid":"settings-tab-mobile-title",children:t}),(0,a.jsx)("div",{className:"flex min-h-7 items-baseline pr-0.5",children:c})]}):null}},27458:(e,t,s)=>{"use strict";s.d(t,{Fy:()=>M,I_:()=>W,Qn:()=>U,Wu:()=>F,gu:()=>D});var a=s(77145),r=s(71855),l=s(72035),n=s(67336),i=s(43646),o=s(85796),c=s(55950),d=s(88281),u=s(34975),p=s(9516),m=s(91111),h=s(50551),x=s(83696),g=s(82341),f=s(91638),v=s(24098),b=s(61424),j=s(2479),w=s(83649),y=s(92976),_=s(8369),N=s(13870),C=s(58219),P=s(75962),E=s(57550),k=s(51854),I=s(31740),A=s(5423),S=s(94634),L=s(78181),T=s(68686),R=s(18229);let O={Anthropic:p.default,Apple:C.default,BuilderIO:r.default,Discord:c.default,Figma:n.default,FigmaColor:l.default,GitHub:P.default,Google:d.default,ImagiLogotype:u.default,Linkedin:f.default,Lovable:j.default,LovableMonotone:i.default,LovableWithTextDark:v.default,LovableWithTextLight:b.default,OpenAILogomark:m.default,OpenAILogotype:o.default,Outlook:E.default,PayPal:w.default,ReactLogo:k.default,Reddit:y.default,Resend:h.default,ShadcnLogo:I.default,ShopifyLogomark:_.default,ShopifyLogotype:N.default,Supabase:x.default,TailwindLogo:A.default,ThreeJS:g.default,TypescriptLogo:S.default,Vite:L.default,X:T.default,Youtube:R.default},D=e=>{let{name:t,...s}=e,r=O[t];return(0,a.jsx)(r,{fill:"currentColor",...s})},F=e=>(0,a.jsx)(D,{...e,name:"Supabase"}),M=e=>(0,a.jsx)(D,{...e,name:"Lovable"}),U=e=>(0,a.jsx)(D,{...e,name:"LovableWithTextLight"}),W=e=>(0,a.jsx)(D,{...e,name:"LovableWithTextDark"})},27623:(e,t,s)=>{"use strict";s.d(t,{KU:()=>g,BK:()=>b});var a=s(95661),r=s(92912),l=s(51762),n=s(39528),i=s(77145),o=s(49974),c=s(51433),d=s(54557),u=s(72632),p=s(20247),m=s(52811),h=s(27458);function x(e){let{title:t,subtitle:s}=e;return(0,i.jsxs)(p.Cf,{className:"max-h-[90vh] max-w-[425px] overflow-y-auto",children:[(0,i.jsxs)(p.c7,{className:"space-y-4",children:[(0,i.jsx)(h.Fy,{className:"size-9 shrink-0"}),(0,i.jsxs)("div",{children:[(0,i.jsx)(p.L3,{className:"mb-2 text-3xl font-medium",children:t}),(0,i.jsx)("p",{className:"text-sm text-foreground",children:s})]})]}),(0,i.jsxs)(p.Es,{className:"pt-4",children:[(0,i.jsx)(p.HM,{asChild:!0,children:(0,i.jsx)(m.$,{variant:"decline",className:"flex-1",children:"Cancel"})}),(0,i.jsx)(m.$,{className:"flex-1",variant:"default",onClick:()=>{window.open("https://enterpriseform.lovable.app/","_blank, no","noopener,noreferrer")},children:"Contact Sales"})]})]})}var g=function(e){return e.BIZ_TEMPLATES="BIZ_TEMPLATES",e.BIZ_PERSONAL_PROJECT="BIZ_PERSONAL_PROJECT",e.BIZ_SSO="BIZ_SSO",e.BIZ_WEBSITE_ACCESS="BIZ_WEBSITE_ACCESS",e.BIZ_DATA_OPT_OUT="BIZ_DATA_OPT_OUT",e.ENTERPRISE_RESTRICT_INVITATIONS="ENTERPRISE_RESTRICT_INVITATIONS",e.ENTERPRISE_PUBLISH_PERMISSION_LEVEL="ENTERPRISE_PUBLISH_PERMISSION_LEVEL",e.PRO_SUPPORT="PRO_SUPPORT",e.PRO_VIEWER_INVITE_LINK="PRO_VIEWER_INVITE_LINK",e.PRO_SEND_ADMIN_INVITE="PRO_SEND_ADMIN_INVITE",e.PRO_SEND_VIEWER_INVITE="PRO_SEND_VIEWER_INVITE",e.PRO_CHANGE_VIEWER_ROLE="PRO_CHANGE_VIEWER_ROLE",e.PRO_CHANGE_ADMIN_ROLE="PRO_CHANGE_ADMIN_ROLE",e.PRO_DOMAIN_CONNECT="PRO_DOMAIN_CONNECT",e.PRO_HIDE_BADGE="PRO_HIDE_BADGE",e.PRO_CHANGE_CLOUD_INSTANCE_SIZE="PRO_CHANGE_CLOUD_INSTANCE_SIZE",e.PRO_SEND_ADMIN_COLLABORATOR="PRO_SEND_ADMIN_COLLABORATOR",e.PRO_SEND_VIEWER_COLLABORATOR="PRO_SEND_VIEWER_COLLABORATOR",e.PRO_CHANGE_COLLABORATOR_TO_ADMIN="PRO_CHANGE_COLLABORATOR_TO_ADMIN",e.PRO_CHANGE_COLLABORATOR_TO_VIEWER="PRO_CHANGE_COLLABORATOR_TO_VIEWER",e}({});let f={BIZ_TEMPLATES:{title:"Upgrade to Business",subtitle:"You need to be on a business plan to use templates.",targetPlanCategory:"biz"},BIZ_PERSONAL_PROJECT:{title:"Upgrade to Business",subtitle:"You need to be on a business plan to make a project personal.",targetPlanCategory:"biz"},BIZ_SSO:{title:"Upgrade to Business",subtitle:"You need to be on a business plan to add SSO providers.",targetPlanCategory:"biz"},BIZ_WEBSITE_ACCESS:{title:"Upgrade to Business",subtitle:"You need to be on a business plan to make published websites accessible only to logged in workspace members.",targetPlanCategory:"biz"},ENTERPRISE_PUBLISH_PERMISSION_LEVEL:{title:"Upgrade to Enterprise",subtitle:"Configuring who can publish projects externally is only available on Enterprise plans.",targetPlanCategory:"enterprise"},BIZ_DATA_OPT_OUT:{title:"Upgrade to Business",subtitle:"Data collection opt-out is only available on Business plan and above.",targetPlanCategory:"biz"},ENTERPRISE_RESTRICT_INVITATIONS:{title:"Upgrade to Enterprise",subtitle:"Restricting workspace invitations is only available on Enterprise plans.",targetPlanCategory:"enterprise"},PRO_SUPPORT:{title:"Upgrade to Pro",subtitle:"You need to be on a paid plan to access direct support.",targetPlanCategory:"pro"},PRO_VIEWER_INVITE_LINK:{title:"Upgrade to Pro",subtitle:"You need to be on a pro plan to create a viewer invite link.",targetPlanCategory:"pro"},PRO_SEND_VIEWER_INVITE:{title:"Upgrade to Pro",subtitle:"You need to be on a pro plan to invite viewers.",targetPlanCategory:"pro"},PRO_SEND_ADMIN_INVITE:{title:"Upgrade to Pro",subtitle:"You need to be on a pro plan to invite admins.",targetPlanCategory:"pro"},PRO_CHANGE_ADMIN_ROLE:{title:"Upgrade to Pro",subtitle:"You need to be on a pro plan to change the role to admin.",targetPlanCategory:"pro"},PRO_CHANGE_VIEWER_ROLE:{title:"Upgrade to Pro",subtitle:"You need to be on a pro plan to change the role to viewer.",targetPlanCategory:"pro"},PRO_DOMAIN_CONNECT:{title:"Upgrade to Pro",subtitle:"You need to be on a pro plan to connect a domain.",targetPlanCategory:"pro"},PRO_HIDE_BADGE:{title:"Upgrade to Pro",subtitle:'You need to be on a pro plan to hide the "Edit with Lovable" badge.',targetPlanCategory:"pro"},PRO_CHANGE_CLOUD_INSTANCE_SIZE:{title:"Upgrade to Pro",subtitle:"You need to be on a pro plan to change the cloud instance size.",targetPlanCategory:"pro"},PRO_SEND_ADMIN_COLLABORATOR:{title:"Upgrade to Pro",subtitle:"You need to be on a pro plan to invite admin collaborators.",targetPlanCategory:"pro"},PRO_SEND_VIEWER_COLLABORATOR:{title:"Upgrade to Pro",subtitle:"You need to be on a pro plan to invite viewer collaborators.",targetPlanCategory:"pro"},PRO_CHANGE_COLLABORATOR_TO_ADMIN:{title:"Upgrade to Pro",subtitle:"You need to be on a pro plan to change a collaborator's role to admin.",targetPlanCategory:"pro"},PRO_CHANGE_COLLABORATOR_TO_VIEWER:{title:"Upgrade to Pro",subtitle:"You need to be on a pro plan to change a collaborator's role to viewer.",targetPlanCategory:"pro"}},v=e=>{let{scenario:t}=e,s=f[t],{currentPlan:a,planType:l,getDisplayPrice:p}=(0,o.et)(),m=(0,d.Y)({currentPlan:a,targetPlanCategory:s.targetPlanCategory});return 0===m.length&&"enterprise"===s.targetPlanCategory?(0,i.jsx)(x,{title:s.title,subtitle:s.subtitle}):(0,i.jsx)(c.n,{targetPlan:m[0],availablePlans:m,title:s.title,subtitle:s.subtitle,showCreditDifference:!0,showWhatsChanging:!1,showPlanFeatures:!0,showNextBillingCycle:!0,showPlanDropdown:!1,handleConfirm:(e,s)=>{t&&s&&r.Ay.capture(n.t3.UPGRADE_CLICKED,{scenario:t,current_plan_id:a.id,current_plan_type:a.type,target_plan_id:s,target_plan_type:l,plan_type:(0,u.m6)(s),plan_price:p(s)})}})},b=()=>{let e=(0,l.f)(v);return(0,a.useCallback)(t=>{r.Ay.capture(n.t3.DIALOG_SHOWN,{scenario:t}),e({childProps:{onClose:()=>e(!1),scenario:t}})},[e])}},27835:(e,t,s)=>{"use strict";s.d(t,{WorkspacePaymentFailedDialog:()=>v,Yv:()=>f,a_:()=>x,cK:()=>h,wB:()=>g});var a=s(77145),r=s(13410),l=s(92912),n=s(95661),i=s(31088),o=s(83220),c=s(33966),d=s(91169),u=s(52811),p=s(24092),m=s(39528);let h="payment_status",x="plan_id",g="change_type",f="failed",v=()=>{let[e,t]=(0,n.useState)(!1),[s,i]=(0,n.useState)(),[c,d]=(0,n.useState)(),u=(0,r.useSearchParams)(),v=(0,r.useRouter)(),j=(0,r.usePathname)(),w=(0,o.j4)(e=>e.currentWorkspace),y=(0,n.useCallback)(()=>{let e=new URLSearchParams(u.toString());e.delete(h),e.delete(x),e.delete(g);let t=j+"?"+e.toString();v.replace(t,{scroll:!1})},[v,u,j]);return(0,n.useEffect)(()=>{i(u.get(x));let e=u.get(g);d(e),u.get(h)===f&&("topup"===e&&w&&l.Ay.capture(m.ZK.PURCHASE.FAILED,{current_plan:w.plan}),t(!0))},[u,w]),(0,a.jsx)(p.E,{title:"topup"===c?"Topup Cancelled":"Payment Failed",description:"topup"===c?"Your credit topup couldn't be completed":"Payment couldn't complete or has lapsed on this workspace.",open:e,onOpenChange:e=>{t(e),!e&&(u.has(h)||u.has(x)||u.has(g))&&y()},children:(0,a.jsx)(b,{closeDialog:()=>{t(!1),y()},currentWorkspace:w,planId:s,changeType:c})})},b=e=>{let{closeDialog:t,currentWorkspace:s,planId:r,changeType:l}=e,{createPortalSession:n,isCreatePortalSessionLoading:i,checkoutLoading:o,toCheckout:p}=(0,d.R)(),m=(0,c.X5)(),h=async()=>{s&&r&&"topup"!==l&&await p({plan:r,workspaceId:s.id,changeType:l})},x="topup"===l?{text:"Retry Top-up",onClick:()=>{t(),m({preSelectedOption:"topup"})},loading:!1,disabled:!1}:{text:"Retry payment",onClick:h,loading:o===r,disabled:!r||!!o||i};return(0,a.jsxs)("div",{className:"mt-2 flex w-full gap-6",children:[(0,a.jsx)(u.$,{className:"flex-1",variant:"secondary",onClick:t,children:"Go Back"}),(0,a.jsx)(u.$,{onClick:x.onClick,className:"flex-1",loading:x.loading,disabled:x.disabled,children:x.text})]})}},32738:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(95661);let r=()=>{let[e,t]=(0,a.useState)({width:void 0,height:void 0});return(0,a.useEffect)(()=>{{let e=()=>{t({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)}},[]),e}},33817:(e,t,s)=>{"use strict";s.d(t,{A0:()=>i,BF:()=>o,Hj:()=>c,XI:()=>n,nA:()=>u,nd:()=>d});var a=s(77145),r=s(95661),l=s(56024);let n=r.forwardRef((e,t)=>{let{className:s,containerClassName:r,...n}=e;return(0,a.jsx)("div",{className:(0,l.cn)("relative max-h-full w-full overflow-auto",r),children:(0,a.jsx)("table",{ref:t,className:(0,l.cn)("w-full caption-bottom text-sm",s),...n})})});n.displayName="Table";let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("thead",{ref:t,className:(0,l.cn)("[&_tr]:border-b",s),...r})});i.displayName="TableHeader";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,l.cn)("[&_tr:last-child]:border-0",s),...r})});o.displayName="TableBody",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,l.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...r})}).displayName="TableFooter";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tr",{ref:t,className:(0,l.cn)("border-b transition-colors data-[state=selected]:bg-muted hover:bg-muted/50",s),...r})});c.displayName="TableRow";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("th",{ref:t,className:(0,l.cn)("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...r})});d.displayName="TableHead";let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("td",{ref:t,className:(0,l.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...r})});u.displayName="TableCell",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("caption",{ref:t,className:(0,l.cn)("mt-4 text-sm text-muted-foreground",s),...r})}).displayName="TableCaption"},33895:(e,t,s)=>{"use strict";s.d(t,{I7:()=>n,Pf:()=>l,y:()=>i});var a=s(69850),r=s(99989);async function l(e,t){let s=r.y.workspaceMemberships({workspaceId:t});await e.cancelQueries({queryKey:s.queryKey})}function n(e,t,s,a,l,n){var i,o;let c=r.y.workspaceMemberships({workspaceId:t}),d=e.getQueryData(c.queryKey);if(d&&e.setQueryData(c.queryKey,{...d,members:a(d.members),total:n?n(d.total):d.total,limit:d.limit,offset:null!=(i=d.offset)?i:0,has_more:d.has_more}),s){let i=r.y.searchWorkspaceMemberships({workspaceId:t,params:s}),c=e.getQueryData(i.queryKey);if(c){let t=l?l(c.members):a(c.members);e.setQueryData(i.queryKey,{...c,members:t,total:n?n(c.total):c.total,limit:c.limit,offset:null!=(o=c.offset)?o:0,has_more:c.has_more})}}}function i(e,t,s,l){let n={refetchType:(null==l?void 0:l.refetch)?"active":"none"};if(null==l?void 0:l.invalidateAll){e.invalidateQueries({queryKey:[...a.workspaceKeys.detail(t),"memberships"],...n}),e.invalidateQueries({queryKey:a.workspaceKeys.detail(t),...n});return}e.invalidateQueries({queryKey:r.y.workspaceMemberships({workspaceId:t}).queryKey,...n}),s&&e.invalidateQueries({queryKey:r.y.searchWorkspaceMemberships({workspaceId:t,params:s}).queryKey,...n})}},33966:(e,t,s)=>{"use strict";s.d(t,{Cb:()=>Z,X5:()=>Q});var a=s(92912),r=s(95661),l=s(51762),n=s(39528),i=s(77145),o=s(40702),c=s(83220),d=s(61374),u=s(49974),p=s(28717),m=s(98805),h=s(54401),x=s(52811),g=s(20247),f=s(69730),v=s(27458),b=s(6698),j=s(31088),w=s(27835),y=s(83473),_=s(63851),N=s(72632);let C={pro:{usd:{lookupKey:"build_credit_pro",pricePerCredit:.25}},biz:{usd:{lookupKey:"build_credit_business",pricePerCredit:.5}}},P=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"usd",s=(0,N.m6)(e);if("pro"!==s&&"biz"!==s)throw Error("Invalid plan to buy build credit: ".concat(e));return C[s][t]},E=Array.from({length:20},(e,t)=>50+50*t);var k=s(67539);let I=e=>{let{selectedCredits:t,setSelectedCredits:s,workspacePlan:a}=e,r=P(a).pricePerCredit,l=(t*r).toFixed(2);return(0,i.jsxs)(k.l6,{value:t.toString(),onValueChange:e=>s(Number(e)),children:[(0,i.jsx)(k.bq,{className:"w-full justify-start bg-background",children:(0,i.jsxs)("span",{className:"flex min-w-0 flex-1 items-center gap-2",children:[(0,i.jsxs)("span",{className:"min-w-0 truncate",children:["+",t," additional credits"]}),(0,i.jsxs)("span",{className:"ml-auto shrink-0 whitespace-nowrap text-muted-foreground",children:["$",l]})]})}),(0,i.jsx)(k.gC,{children:E.map(e=>{let t=(e*r).toFixed(2);return(0,i.jsx)(k.tJ,{value:e.toString(),label:"+".concat(e," additional credits"),endContent:(0,i.jsxs)("span",{className:"text-muted-foreground",children:["$",t]}),showIndicator:!1,variant:"twilight"},e)})})]})};var A=s(56024);let S=e=>{let{selected:t,onClick:s,children:a}=e;return(0,i.jsxs)("div",{role:"radio","aria-checked":t,tabIndex:0,onClick:s,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),s())},className:(0,A.cn)("relative cursor-pointer rounded-lg p-3 transition-all sm:p-4",t?"bg-muted ring-2 ring-primary":"ring-2 ring-muted"),children:[(0,i.jsx)("div",{className:"absolute right-3 top-3 sm:right-4 sm:top-4",children:(0,i.jsx)("div",{className:"flex-shrink-0",children:(0,i.jsx)("div",{className:(0,A.cn)("h-5 w-5 rounded-full border-2 transition-colors",t?"border-primary bg-primary":"border-muted-foreground/30"),children:t&&(0,i.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,i.jsx)("div",{className:"h-2 w-2 rounded-full bg-primary-foreground"})})})})}),(0,i.jsx)("div",{children:a})]})},L=e=>{let{workspace:t,preSelectedOption:s,onClose:a,targetPlan:l,availablePlans:n,handleCancel:o,handleConfirm:d}=e,{handleUpgradeConfirmed:p}=(0,u.et)(),C=(0,c.j4)(e=>e.currentWorkspace),[k,A]=(0,r.useState)(s),[L,T]=(0,r.useState)(E[0]),[R,O]=(0,r.useState)(!1),[D,F]=(0,r.useState)(l),{handleTopUp:M,isLoading:U}=(e=>{let{workspaceId:t,workspacePlan:s,creditAmount:a=50,onSuccess:l}=e,[n,i]=(0,r.useState)(!1),o=(0,_.P)(),c=(0,b.n)({mutationFn:async()=>{let e=new URL(window.location.href),r=(e=>{let t=new URL("".concat(window.location.origin).concat("/topup-success")),s=new URL(e);return t.searchParams.set("redirect",s.toString()),t.toString()})(e),l=(e=>{let t=new URL(e);return t.searchParams.set(w.cK,w.Yv),t.searchParams.set(w.wB,"topup"),t.toString()})(e),n=P(s);return o.post("/workspaces/".concat(t,"/credits/topup"),{credit_amount:a,price_lookup_key:n.lookupKey,success_url:r,cancel_url:l})},onSuccess:async e=>{e.checkout_url?(i(!0),null==l||l(),window.location.assign(e.checkout_url)):j.toast.error("Failed to create checkout session. Please try again.")},onError:e=>{(0,y.Ni)(e)}}),d=c.isPending||n;return{handleTopUp:c.mutate,isLoading:d,isRedirecting:n}})({workspaceId:t.id,workspacePlan:t.plan,creditAmount:L}),W=(0,N.bn)(null==C?void 0:C.billing_period_end_date),B=async()=>{d(k,D,L),"upgrade"===k?(O(!0),await p(D)):M()},K="upgrade"===k?R:U;return(0,i.jsxs)(g.Cf,{className:"sm:max-w-[425px]",children:[(0,i.jsxs)("div",{className:"flex max-w-full flex-col gap-4 overflow-hidden pb-4",children:[(0,i.jsxs)(g.c7,{children:[(0,i.jsx)("div",{className:"flex py-4",children:(0,i.jsx)(v.Fy,{className:"h-12 w-12"})}),(0,i.jsx)(g.L3,{className:"text-2xl",children:"Add more credits"}),(0,i.jsx)(g.rr,{children:"Here's how you can add more credits"})]}),(0,i.jsxs)("div",{role:"radiogroup","aria-label":"Credit options",className:"flex flex-col gap-4 p-0.5",children:[(0,i.jsxs)(S,{selected:"upgrade"===k,onClick:()=>A("upgrade"),children:[(0,i.jsx)("h3",{className:"text-lg font-medium",children:"Upgrade your plan"}),(0,i.jsxs)("p",{className:"mt-1 text-sm text-muted-foreground",children:["Next billing cycle (",W,")"]}),(0,i.jsx)("div",{className:"mt-3",onClick:e=>e.stopPropagation(),children:(0,i.jsx)(h.D,{selectedPlan:D,setSelectedPlan:F,availablePlans:n,showCreditDifference:!0,showPlanDropdown:!0,showPriceInDropdown:!0})})]}),(0,i.jsxs)(S,{selected:"topup"===k,onClick:()=>A("topup"),children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("h3",{className:"text-lg",children:"Or top up credits"}),(0,i.jsx)(m.y,{children:"Beta"})]}),(0,i.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Purchase credits on demand"}),(0,i.jsx)("div",{className:"mt-3",onClick:e=>e.stopPropagation(),children:(0,i.jsx)(I,{selectedCredits:L,setSelectedCredits:T,workspacePlan:t.plan})})]})]})]}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)(x.$,{variant:"outline",onClick:()=>{o(k),a()},disabled:K,className:"flex-1",children:"Cancel"}),(0,i.jsx)(x.$,{onClick:B,disabled:K,className:"flex-1",children:K?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f.A,{name:"progress_activity",className:"animate-spin",size:"small"}),"Processing..."]}):"Continue"})]})]})};var T=s(51433),R=s(47226),O=s(92763),D=s(54557),F=s(74507),M=s(46753),U=s.n(M),W=s(85062);let B=()=>(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{children:"We couldn't load the data needed to upgrade your workspace."}),(0,i.jsxs)("p",{children:["Please refresh the page and try again. If the problem continues, contact our"," ",(0,i.jsx)(U(),{href:"/support",className:"underline",children:"Support"}),"."]})]}),K=e=>{let{hasFetchedWorkspace:t}=e;return(0,i.jsx)(g.Cf,{className:"max-h-[90vh] overflow-y-auto",size:"lg",children:(0,i.jsxs)(g.c7,{children:[(0,i.jsx)(g.L3,{className:"text-start text-3xl font-medium",children:"Building something big?"}),t?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(g.rr,{className:"text-sm text-muted-foreground",children:"Out of credits."}),(0,i.jsx)(W.O,{})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(g.rr,{className:"text-sm text-muted-foreground",children:"Loading..."}),(0,i.jsx)(B,{})]})]})})};var V=s(50758),z=s(25080);let Y=e=>{let{workspace:t,myWorkspaceRole:s,onSendPing:r,onDismiss:l,isSendingPing:o,canViewWorkspaceMembers:c}=e,d=async()=>{a.Ay.capture(n.lY.OUT_OF_CREDITS_DIALOG.SEND_PING_CLICKED,{workspace_id:t.id,workspace_plan:t.plan,workspace_plan_type:t.plan_type,user_role:s}),await r(),j.toast.success("Ping sent!",{description:"The workspace owner has been notified about the credit shortage."})},{owner:u}=(0,z.K4)({workspaceId:t.id,canViewWorkspaceMembers:c});return(0,i.jsxs)(g.Cf,{className:"max-h-[90vh] overflow-y-auto",size:"lg",children:[(0,i.jsx)(g.c7,{className:"flex flex-col gap-4",children:(0,i.jsxs)("div",{className:"flex flex-col items-start gap-1",children:[(0,i.jsx)(v.Fy,{className:"size-9"}),(0,i.jsx)(g.L3,{className:"text-start text-3xl font-medium",children:"Workspace out of credits"}),(0,i.jsx)(g.rr,{className:"text-start text-sm text-muted-foreground",children:"Only the workspace owner can upgrade and add more credits. Send a ping and continue building."})]})}),(0,i.jsx)("div",{className:"rounded-lg p-3",children:(0,i.jsx)(V.P,{id:(null==u?void 0:u.user_id)||t.owner_id,displayName:null==u?void 0:u.display_name,email:(null==u?void 0:u.email)||"",avatarClassName:"h-8 w-8",actionComponent:(0,i.jsx)("span",{className:"text-xs text-muted-foreground",children:"Owner"}),showBadge:!1})}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)(x.$,{variant:"outline",className:"flex-1",onClick:()=>{a.Ay.capture(n.lY.OUT_OF_CREDITS_DIALOG.DISMISS_CLICKED,{workspace_id:t.id,workspace_plan:t.plan,workspace_plan_type:t.plan_type,user_role:s}),l()},children:"Dismiss"}),(0,i.jsx)(x.$,{className:"h-8 flex-1",onClick:d,disabled:o,children:o?"Sending...":"Send a ping"})]})]})};var G=s(53792),Z=function(e){return e.INACTIVE_WORKSPACE="INACTIVE_WORKSPACE",e.FREE_DAILY_LIMIT="FREE_DAILY_LIMIT",e.FREE_MONTHLY_LIMIT="FREE_MONTHLY_LIMIT",e.LEGACY_DAILY_LIMIT="LEGACY_DAILY_LIMIT",e.PAID_MONTHLY_LIMIT="PAID_MONTHLY_LIMIT",e}({});let H={INACTIVE_WORKSPACE:{title:"Reactivate your workspace",subtitle:"Your workspace is inactive. Upgrade to continue building.",showCreditDifference:!1,showWhatsChanging:!1,showPlanFeatures:!0,showNextBillingCycle:!1,showPlanDropdown:!0},FREE_DAILY_LIMIT:{title:"Daily limit reached",subtitle:"You've used today's free credits. Upgrade to keep building.",showCreditDifference:!1,showWhatsChanging:!1,showPlanFeatures:!0,showNextBillingCycle:!1,showPlanDropdown:!0},FREE_MONTHLY_LIMIT:{title:"Monthly limit reached",subtitle:"You've used all your free credits this month. Upgrade to keep building.",showCreditDifference:!1,showWhatsChanging:!1,showPlanFeatures:!0,showNextBillingCycle:!1,showPlanDropdown:!0},LEGACY_DAILY_LIMIT:{title:"Daily limit reached",subtitle:"Your plan has daily limits. Upgrade to a modern plan with monthly credits.",showCreditDifference:!1,showWhatsChanging:!0,showPlanFeatures:!1,showNextBillingCycle:!0,showPlanDropdown:!0},PAID_MONTHLY_LIMIT:{title:"Need more credits?",subtitle:"You've used your monthly credits. Add more to continue this month.",showCreditDifference:!0,showWhatsChanging:!1,showPlanFeatures:!1,showNextBillingCycle:!0,showPlanDropdown:!0}};function $(e){let{workspace:t,membership:s,hasFetchedWorkspace:l,onClose:c,scenario:m,preSelectedOption:h}=e,{isAuthenticated:x,authUser:f}=(0,o.Z2)(),{userData:v}=(0,p.ur)(),{setPricingScenario:j,selectedProPlan:w,selectedBizPlan:C,currentPlan:P}=(0,u.et)(),{sendCreditsPing:E,isSendingPing:k}=function(e){let{workspaceId:t}=e,{mutateAsync:s,isPending:a}=(0,b.n)({mutationFn:async()=>(0,_.P)().post("/workspaces/".concat(t,"/credits-ping")),onError:e=>{(0,y.Ni)(e)}});return{sendCreditsPing:s,isSendingPing:a}}({workspaceId:(null==t?void 0:t.id)||""}),{permitted:I}=(0,d.J)(F.eZ.ViewWorkspaceMembers),{canTopUpCredits:A}=(0,O.S)(t);(0,r.useEffect)(()=>{j("outOfCredits")},[j]),(0,r.useEffect)(()=>{t&&a.Ay.capture(n.ZK.MODAL.OPENED,{current_plan:t.plan,pre_selected_option:h||"upgrade"})},[t,h]);let S=e=>{a.Ay.capture(n.ZK.MODAL.CANCEL_CLICKED,{current_plan:null==t?void 0:t.plan,selected_option:e}),null==c||c()},M=(e,s,r)=>{a.Ay.capture(n.ZK.MODAL.CONFIRM_CLICKED,{selected_option:e,current_plan:null==t?void 0:t.plan,selected_credits:"topup"===e?r:void 0,selected_plan:"upgrade"===e?s:void 0})},U=(0,r.useMemo)(()=>"biz"===(0,N.m6)(P.id)?C:w,[P.id,w,C]),W=H[(0,r.useMemo)(()=>m||(t?function(e){var t,s;let a=e.plan,{isFreePlan:r,isInactivePlan:l,isAmbassadorPlan:n,isPaidPlan:i,isLegacyPlan:o}=(0,N.cb)(a),c=(null!=(t=e.billing_period_credits_limit)?t:0)>0,d=r&&(null!=(s=e.total_credits_used_in_billing_period)?s:0)>=G.le;return l?"INACTIVE_WORKSPACE":r&&!d?"FREE_DAILY_LIMIT":r&&d?"FREE_MONTHLY_LIMIT":(o||n)&&!c?"LEGACY_DAILY_LIMIT":"PAID_MONTHLY_LIMIT"}(t):Z.FREE_DAILY_LIMIT),[m,t])],B=(0,r.useMemo)(()=>t?(0,D.Y)({currentPlan:P,targetPlanCategory:(0,N.m6)(U)}):[],[t,P,U]);if(!t)return(0,i.jsx)(K,{hasFetchedWorkspace:l});if(!x||!v)return(0,i.jsx)(g.Cf,{className:"max-h-[90vh] overflow-y-auto",size:"lg",children:(0,i.jsx)(R.E,{className:"h-[400px] w-full"})});let V=null==s?void 0:s.role;return(null==f?void 0:f.uid)!==t.owner_id?(0,i.jsx)(Y,{workspace:t,myWorkspaceRole:V,onSendPing:async()=>{await E()},onDismiss:()=>{null==c||c()},isSendingPing:k,canViewWorkspaceMembers:I}):A?(0,i.jsx)(L,{workspace:t,preSelectedOption:h,onClose:()=>null==c?void 0:c(),targetPlan:U,availablePlans:B,handleCancel:S,handleConfirm:M}):(0,i.jsx)(T.n,{targetPlan:U,availablePlans:B,title:W.title,subtitle:W.subtitle,showCreditDifference:W.showCreditDifference,showWhatsChanging:W.showWhatsChanging,showPlanFeatures:W.showPlanFeatures,showNextBillingCycle:W.showNextBillingCycle,showPlanDropdown:W.showPlanDropdown,handleCancel:S,handleConfirm:M})}let q=function(){let{onClose:e,scenario:t,preSelectedOption:s="upgrade"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{currentWorkspace:a,hasFetchedCurrentWorkspace:r,membership:l}=(0,c.j4)(e=>e);return(0,i.jsx)($,{workspace:a,membership:l,hasFetchedWorkspace:r,onClose:e,scenario:t,preSelectedOption:s})},Q=()=>{let e=(0,l.f)(q);return(0,r.useCallback)(function(){let{scenario:t,preSelectedOption:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e({childProps:{onClose:()=>e(!1),scenario:t,preSelectedOption:s},dialogProps:{onOpenChange:e=>{e||a.Ay.capture(n.ZK.MODAL.CLOSED,{pre_selected_option:s})}}})},[e])}},36704:(e,t,s)=>{"use strict";s.d(t,{L:()=>c});var a=s(87299),r=s(6698),l=s(31088),n=s(83473),i=s(63851),o=s(69850);let c=()=>{let e=(0,a.jE)(),{mutateAsync:t,isPending:s}=(0,r.n)({mutationFn:async e=>{let{projectId:t,accessLevel:s,message:a}=e;return(0,i.P)().post("/projects/".concat(t,"/access-requests"),{access_level:s,message:a||""})},onSuccess:()=>{l.toast.success("Access request sent",{description:"The project owner will be notified of your request."})},onError:e=>{(0,n.Ni)(e)}}),{mutateAsync:c,isPending:d}=(0,r.n)({mutationFn:async e=>(0,i.P)().get("/projects/".concat(e,"/access-requests/me")),onError:e=>{(0,n.Ni)(e)}}),{mutate:u,isPending:p}=(0,r.n)({mutationFn:async e=>{let{projectId:t,requestId:s}=e;return(0,i.P)().patch("/projects/".concat(t,"/access-requests/").concat(s),{status:"accepted"})},onSuccess:(t,s)=>{l.toast.success("Access request approved"),e.invalidateQueries({queryKey:o.gO.accessRequests(s.projectId)}),e.invalidateQueries({queryKey:o.gO.collaborators(s.projectId)}),s.workspaceId&&e.invalidateQueries({queryKey:o.workspaceKeys.projectAccessRequests(s.workspaceId)})},onError:e=>{(0,n.Ni)(e)}}),{mutate:m,isPending:h}=(0,r.n)({mutationFn:async e=>{let{projectId:t,requestId:s}=e,a=(0,i.P)();await a.patch("/projects/".concat(t,"/access-requests/").concat(s),{status:"rejected"})},onSuccess:(t,s)=>{l.toast.info("Access request declined"),e.invalidateQueries({queryKey:o.gO.accessRequests(s.projectId)}),s.workspaceId&&e.invalidateQueries({queryKey:o.workspaceKeys.projectAccessRequests(s.workspaceId)})},onError:e=>{(0,n.Ni)(e)}});return{getCurrentUserAccessRequestAsync:c,isGettingCurrentUserAccessRequest:d,createRequestAsync:t,acceptRequest:u,declineRequest:m,isCreating:s,isAccepting:p,isDeclining:h}}},39055:(e,t,s)=>{"use strict";s.d(t,{x:()=>o});var a=s(77145),r=s(67844),l=s(56024);let n={pro:"brand-twilight",business:"brand-twilight",enterprise:"brand-twilight",admin:"brand-saffron",labs:"brand-twilight",internal:"secondary",soon:"brand-saffron"},i={pro:"pro",business:"business",enterprise:"enterprise",admin:"admin",labs:"labs",internal:"internal",soon:"Coming Soon"},o=e=>{let{badge:t,className:s}=e;return(0,a.jsx)(r.E,{variant:n[t],className:(0,l.cn)("capitalize",s),children:i[t]})}},40488:(e,t,s)=>{"use strict";s.d(t,{nZ:()=>y,ZL:()=>w,lF:()=>_});var a=s(77145),r=s(92912),l=s(49974),n=s(64482),i=s(98805),o=s(81635),c=s(39528);let d=e=>{let{selectedPlan:t,isScheduled:s}=e,{planType:n,setPlanType:i}=(0,l.et)(),d="annual"===n;return s&&(d="annual"===s),(0,a.jsx)("div",{className:"flex flex-col gap-2",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(o.d,{checked:d,disabled:!!s,onCheckedChange:e=>{i(e?"annual":"monthly"),r.Ay.capture(c.aw.PLAN_TYPE_CHANGED,{plan_id:t,plan_type:e?"annual":"monthly"})},className:"data-[state=checked]:bg-brand-twilight-primary",thumbClassName:"bg-[hsl(45_40_98%)]"}),(0,a.jsx)("div",{className:"flex",children:(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Annual"})})]})})};var u=s(83022),p=s(95290),m=s(2231),h=s(73726),x=s(19620),g=s(53792),f=s(72632),v=s(51573),b=s(76058),j=s(56024);let w=e=>{let{children:t,className:s,suffix:r}=e,{pricingScenario:n}=(0,l.et)();return(0,a.jsx)("div",{className:"flex w-full justify-center",children:(0,a.jsxs)("div",{className:"flex w-fit flex-col justify-center gap-6",children:[(0,a.jsx)("div",{className:(0,j.cn)("grid w-fit grid-cols-1 gap-4","sm:grid-cols-2 lg:gap-6","lg:flex lg:justify-center","lg:max-w-none",s,{"max-w-[600px]":"billing"!==n}),children:t}),r]})})},y=e=>{let{children:t}=e,s=(0,l.et)();return(0,a.jsx)("div",{className:(0,j.cn)("flex flex-col gap-4",s.isLoggedOut?"min-h-72":"min-h-[350px]"),children:t})},_=()=>{let e=(0,l.et)(),t=(0,f.RL)(e.selectedProPlan),s=(0,n.f)();return(0,a.jsx)(p.kp,{label:"All features in Free, plus:",features:[(0,a.jsxs)("span",{className:"flex items-start gap-1",children:[t," monthly credits",(0,a.jsx)(h.V,{name:"info_circle",delay:300,tooltipContentClassName:"max-w-[25ch]",className:"mt-0.5 h-4 w-4 text-muted-foreground",children:(0,a.jsxs)("p",{children:[t," credits per month + 5 daily credits that reset each day"]})})]},"num-credits"),"5 daily credits (up to 150/month)",...s?[(0,a.jsxs)("span",{className:"flex items-start gap-1",children:["Usage-based Cloud + AI",(0,a.jsx)(h.V,{name:"info",delay:300,tooltipContentClassName:"max-w-[25ch]",className:"mt-0.5 h-4 w-4 text-muted-foreground",children:(0,a.jsxs)("p",{children:["Free $25 Cloud + $1 AI usage included. This offer lasts until the end of 2025."," ",(0,a.jsx)("a",{href:"https://docs.lovable.dev/features/cloud",target:"_blank",rel:"noopener noreferrer",className:"underline transition-colors hover:text-muted",children:"Read more"})]})}),(0,a.jsx)(i.y,{children:"New"})]},"lovable-cloud")]:[],(0,a.jsxs)("span",{className:"flex items-start gap-1",children:["Credit rollovers",(0,a.jsx)(h.V,{name:"info_circle",delay:300,tooltipContentClassName:"max-w-[25ch]",className:"mt-0.5 h-4 w-4 text-muted-foreground",children:(0,a.jsx)("p",{children:"Credits roll over for 1 month on monthly plans, or until the end of your annual plan."})})]},"credit-rollovers"),"Unlimited lovable.app domains","Custom domains","Remove the Lovable badge","User roles & permissions"]})},N=e=>{var t,s;let{scheduledPlan:n}=e,i=(0,l.et)(),{isBizPlan:o,isEnterprisePlan:h}=(0,f.cb)(i.currentPlan.id),x="newWorkspace"===i.pricingScenario;if(!x&&!i.showProPlan)return null;let v=(()=>{let e=i.selectedProPlan,t=e===i.currentPlan.id&&i.planType==i.currentPlan.type,s=i.isPlanDowngrade(e);return i.isLoggedOut?{type:"link",text:"Get Started",variant:"twilight",href:"/signup",disabled:!1,onClick:()=>{r.Ay.capture(c.aw.GET_STARTED_CLICKED,{plan_type:"pro",plan_id:e,plan_price:i.getDisplayPrice(e),user_status:"logged_out"}),i.handleLoggedOutUpgrade(e)}}:x?i.newWorkspaceSelectedPlan===e?{type:"button",text:"Selected",variant:"twilight",disabled:!1,onClick:void 0,loading:!1}:{type:"button",text:"Select",variant:"twilight",disabled:!1,onClick:()=>{i.setNewWorkspaceSelectedPlan(e)},loading:!1}:n?{type:"button",text:"Scheduled",variant:"muted",disabled:!0,onClick:void 0,loading:!1}:t&&i.scheduledPlan?{type:"button",text:"Reactivate",variant:"twilight",disabled:!1,onClick:()=>{i.createPortalSession()},loading:!1}:t?{type:"button",text:"Your current plan",variant:"muted",disabled:!0,onClick:void 0,loading:!1}:i.shouldDisableWorkspaceAdminActions?{type:"button",text:"Contact Admin",variant:i.proPlanButtonVariant,disabled:!0,onClick:void 0,loading:!1,showTooltip:!0,tooltipContent:"You need to be a workspace admin to manage plans"}:h?{type:"button",text:i.getButtonText(e),variant:i.proPlanButtonVariant,disabled:!0,onClick:void 0,loading:!1}:s?{type:"button",text:i.getButtonText(e),variant:"link",disabled:!1,loading:!1,onClick:()=>{r.Ay.capture(c.aw.PLAN_DOWNGRADE_CLICKED,{current_plan_id:i.currentPlan.id,current_plan_type:i.currentPlan.type,target_plan_id:e,target_plan_type:i.planType,plan_type:"pro",plan_price:i.getDisplayPrice(e)}),i.setTargetDowngradePlan(e),i.onDowngradeClick()}}:{type:"button",text:i.getButtonText(e),variant:o?"decline":"twilight",disabled:!1,loading:!1,testId:"pro-plan-button",onClick:async()=>{await i.handleUpgradeClicked(e)}}})(),b=n&&i.scheduledPlan?i.scheduledPlan.id:i.selectedProPlan,j=i.getSavingsAmount(b);return(0,a.jsx)(p.Mt,{name:"Pro",title:"Designed for fast-moving teams building together in real time.",plan:null!=(t=null==n?void 0:n.id)?t:i.selectedProPlan,planType:null!=(s=null==n?void 0:n.type)?s:i.planType,description:(0,a.jsx)(d,{selectedPlan:b,isScheduled:null==n?void 0:n.type}),isPopular:!o&&!n,savingsAmount:j,isScheduled:x||null==n?void 0:n.type,highlighted:x&&i.newWorkspaceSelectedPlan===i.selectedProPlan,priceSubtitle:"shared across unlimited users",children:(0,a.jsxs)(y,{children:[(0,a.jsxs)(p.vi,{children:[(0,a.jsx)(u.O,{...v}),x?(0,a.jsx)(m.h,{options:g.pB,selectedOption:i.selectedProPlan,onSelect:e=>{i.setNewWorkspaceSelectedPlan(e),i.setSelectedProPlan(e)}}):(0,a.jsx)(m.h,{options:g.pB,selectedOption:n&&i.scheduledPlan?i.scheduledPlan.id:i.selectedProPlan,disabled:!!n||i.shouldDisableWorkspaceAdminActions,onSelect:i.setSelectedProPlan})]}),(0,a.jsx)(_,{})]})})},C=e=>{var t,s;let{scheduledPlan:n}=e,o=(0,l.et)(),{isBizPlan:x,isEnterprisePlan:v}=(0,f.cb)(o.currentPlan.id),b="newWorkspace"===o.pricingScenario,j=(0,f.RL)(o.selectedBizPlan);if(!b&&!o.showBizPlan)return null;let w=(()=>{let e=o.selectedBizPlan,t=e==o.currentPlan.id&&o.planType==o.currentPlan.type,s=o.isPlanDowngrade(e);return o.isLoggedOut?{type:"link",text:"Get Started",variant:"decline",href:"/signup",disabled:!1,onClick:()=>{r.Ay.capture(c.aw.GET_STARTED_CLICKED,{plan_type:"business",plan_id:e,plan_price:o.getDisplayPrice(e),user_status:"logged_out"})}}:b?o.newWorkspaceSelectedPlan===e?{type:"button",text:"Selected",variant:"twilight",disabled:!1,onClick:void 0,loading:!1}:{type:"button",text:"Select",variant:"twilight",disabled:!1,onClick:()=>{o.setNewWorkspaceSelectedPlan(e)},loading:!1}:n?{type:"button",text:"Scheduled",variant:"muted",disabled:!0,onClick:void 0,loading:!1}:t&&o.scheduledPlan?{type:"button",text:"Reactivate",variant:"twilight",disabled:!1,onClick:()=>{o.createPortalSession()},loading:!1}:t?{type:"button",text:"Your current plan",variant:"ghost",disabled:!0,onClick:void 0,loading:!1}:o.shouldDisableWorkspaceAdminActions?{type:"button",text:"Contact Admin",variant:x?"twilight":"twilight-muted",disabled:!0,onClick:void 0,loading:!1,showTooltip:!0,tooltipContent:"You need to be a workspace admin to manage plans"}:v?{type:"button",text:o.getButtonText(e),variant:"twilight-muted",disabled:!0,onClick:void 0,loading:!1}:s?{type:"button",text:o.getButtonText(e),variant:"link",disabled:!1,loading:!1,onClick:()=>{r.Ay.capture(c.aw.PLAN_DOWNGRADE_CLICKED,{current_plan_id:o.currentPlan.id,current_plan_type:o.currentPlan.type,target_plan_id:e,target_plan_type:o.planType,plan_type:"business",plan_price:o.getDisplayPrice(e)}),o.setTargetDowngradePlan(e),o.onDowngradeClick()}}:{type:"button",text:o.getButtonText(e),variant:x?"twilight":"decline",disabled:!1,loading:!1,onClick:async()=>{await o.handleUpgradeClicked(e)}}})(),_=n&&o.scheduledPlan?o.scheduledPlan.id:o.selectedBizPlan,N=o.getSavingsAmount(_);return(0,a.jsx)(p.Mt,{name:"Business",title:"Advanced controls and power features for growing departments",plan:null!=(t=null==n?void 0:n.id)?t:o.selectedBizPlan,planType:null!=(s=null==n?void 0:n.type)?s:o.planType,highlighted:b&&o.newWorkspaceSelectedPlan===o.selectedBizPlan,description:(0,a.jsx)(d,{selectedPlan:_,isScheduled:null==n?void 0:n.type}),savingsAmount:N,isPopular:x&&!n,isScheduled:null==n?void 0:n.type,priceSubtitle:"shared across unlimited users",children:(0,a.jsxs)(y,{children:[(0,a.jsxs)(p.vi,{children:[(0,a.jsx)(u.O,{...w}),b?(0,a.jsx)(m.h,{options:g.mR,selectedOption:o.selectedBizPlan,onSelect:e=>{o.setNewWorkspaceSelectedPlan(e),o.setSelectedBizPlan(e)}}):(0,a.jsx)(m.h,{options:g.mR,selectedOption:_,disabled:!!n||o.shouldDisableWorkspaceAdminActions,onSelect:o.setSelectedBizPlan})]}),(0,a.jsx)(p.kp,{label:"All features in Pro, plus:",features:[(0,a.jsxs)("span",{className:"flex items-start gap-1",children:[j," monthly credits",(0,a.jsx)(h.V,{name:"info_circle",delay:300,tooltipContentClassName:"max-w-[25ch]",className:"mt-0.5 h-4 w-4 text-muted-foreground",children:(0,a.jsxs)("p",{children:[j," credits per month + 5 daily credits that reset each day"]})})]},"num-credits"),(0,a.jsxs)("span",{className:"flex items-start gap-1",children:["Internal publish",(0,a.jsx)(h.V,{name:"info_circle",delay:300,tooltipContentClassName:"max-w-[25ch]",className:"mt-0.5 h-4 w-4 text-muted-foreground",children:(0,a.jsx)("p",{children:"Publish websites that are only accessible to logged in workspace members."})}),(0,a.jsx)(i.y,{children:"New"})]},"internal-publishing"),"SSO","Personal Projects","Opt out of data training","Design templates"]})]})})};w.Free=()=>{let e=(0,l.et)(),{isFreePlan:t,isInactivePlan:s,isEnterprisePlan:o}=(0,f.cb)(e.currentPlan.id),d=(0,n.f)();if(!e.showFreePlan)return null;let m=(()=>{var a;return e.isLoggedOut?{type:"link",text:"Get Started",variant:"decline",href:"/signup",disabled:!1,onClick:()=>{r.Ay.capture(c.aw.GET_STARTED_CLICKED,{plan_type:"free",plan_id:"free",plan_price:0,user_status:"logged_out"})}}:(null==(a=e.scheduledPlan)?void 0:a.id)==="free"?{type:"button",text:"Scheduled",variant:"muted",disabled:!0,onClick:void 0,loading:!1}:t?{type:"button",text:"Your current plan",variant:"ghost",disabled:!0,onClick:void 0,loading:!1}:s?{type:"button",text:"Only for first workspace",variant:e.freePlanButtonVariant,disabled:!0,onClick:void 0,loading:!1}:o?{type:"button",text:"Downgrade (Contact us)",variant:e.freePlanButtonVariant,disabled:!0,onClick:void 0,loading:!1}:e.shouldDisableWorkspaceAdminActions?{type:"button",text:"Contact Admin",variant:e.freePlanButtonVariant,disabled:!0,onClick:void 0,loading:!1,showTooltip:!0,tooltipContent:"You need to be a workspace admin to manage plans"}:{type:"button",text:"Downgrade",variant:e.freePlanButtonVariant,disabled:!1,loading:e.isCreatePortalSessionLoading,onClick:()=>{r.Ay.capture(c.aw.PLAN_DOWNGRADE_CLICKED,{current_plan_id:e.currentPlan.id,current_plan_type:e.currentPlan.type,target_plan_id:"free",plan_type:"free"}),e.setFreePlanAsTarget(),e.onDowngradeClick()}}})();return(0,a.jsx)(p.Mt,{name:"Free",title:"Discover what Lovable can do for you",description:"Free forever",plan:v.VL.FREE,planType:"monthly",priceSubtitle:"No credit card needed",children:(0,a.jsxs)(y,{children:[(0,a.jsx)(p.vi,{children:(0,a.jsx)(u.O,{...m})}),(0,a.jsx)(p.kp,{label:"Free for everyone",features:["5 daily credits (up to 30/month)","Public projects","Unlimited collaborators","5 lovable.app domains",...d?[(0,a.jsxs)("span",{className:"flex items-start gap-2",children:["Cloud",(0,a.jsx)(i.y,{children:"New"})]},"lovable-cloud")]:[]]})]})})},w.Ktlo=()=>{let e=(0,l.et)();if(!e.showKtloPlan)return null;let t=(()=>{let t=e.isLitePlan;return e.isLoggedOut?{type:"link",text:"Get Started",variant:"twilight",href:"/signup",disabled:!1,onClick:()=>{r.Ay.capture(c.aw.GET_STARTED_CLICKED,{plan_type:"ktlo",plan_price:15,user_status:"logged_out"})}}:t&&e.scheduledPlan?{type:"button",text:"Reactivate",variant:"twilight",disabled:!1,onClick:()=>{e.createPortalSession()},loading:!1}:t?{type:"button",text:"Your current plan",variant:"ghost",disabled:!0,onClick:void 0,loading:!1}:e.isScheduledLitePlan?{type:"button",text:"Scheduled",variant:"muted",disabled:!0,onClick:void 0,loading:!1}:e.shouldDisableWorkspaceAdminActions?{type:"button",text:"Contact Admin",variant:"twilight",disabled:!0,onClick:void 0,loading:!1,showTooltip:!0,tooltipContent:"You need to be a workspace admin to manage plans"}:{type:"button",text:"Switch to KTLO",variant:"twilight",disabled:!1,loading:!1,onClick:async()=>{var t;if(!(null==(t=b.y4[b.G.KTLO])?void 0:t.PRODUCT_ID))return void x.logging.error("KTLO product ID not found");r.Ay.capture(c.aw.PLAN_UPGRADE_CLICKED,{current_plan_id:e.currentPlan.id,current_plan_type:e.currentPlan.type,target_plan_id:"ktlo",plan_type:"ktlo",plan_price:15}),await e.handleUpgradeConfirmed(v.VL.KTLO)}}})();return(0,a.jsx)(p.Mt,{name:"Lite",title:"Keep your projects running with essential features",plan:e.selectedLitePlan,planType:"monthly",description:"Monthly",children:(0,a.jsxs)(y,{children:[(0,a.jsx)(p.vi,{children:(0,a.jsx)(u.O,{...t})}),(0,a.jsx)(p.kp,{label:"Everything in Free, plus:",features:["5 daily credits (up to 150/month)","User roles & permissions","Custom domains","Remove the Lovable badge"]})]})})},w.Scheduled=()=>{let{scheduledPlan:e}=(0,l.et)(),{isProPlan:t,isBizPlan:s}=(0,f.cb)(null==e?void 0:e.id);return e&&t?(0,a.jsx)(N,{scheduledPlan:e}):e&&s?(0,a.jsx)(C,{scheduledPlan:e}):void 0},w.Pro=N,w.Biz=C,w.Enterprise=()=>{let e=(0,l.et)(),{isEnterprisePlan:t}=(0,f.cb)(e.currentPlan.id);if(!e.showEnterprisePlan)return null;let s=t?{type:"button",text:"Your current plan",variant:"ghost",disabled:!0,onClick:void 0,loading:!1}:{type:"link",text:"Book a demo",variant:"decline",href:"https://enterpriseform.lovable.app/",disabled:!1,isExternal:!0,onClick:()=>{r.Ay.capture(c.aw.CONTACT_US_CLICKED,{plan_type:"enterprise",current_plan_id:e.currentPlan.id,current_plan_type:e.currentPlan.type,user_status:e.isLoggedOut?"logged_out":"logged_in"})}};return(0,a.jsx)(p.Mt,{name:"Enterprise",title:"Built for large orgs needing flexibility, scale, and governance.",plan:v.VL.ENTERPRISE,planType:e.planType,description:"Flexible plans",hidePrice:!1,customPriceLabel:(0,a.jsx)("span",{className:"flex items-start gap-1 pb-3 pt-7 text-xl text-muted-foreground",children:"Custom"}),children:(0,a.jsxs)(y,{children:[(0,a.jsx)(p.vi,{children:(0,a.jsx)(u.O,{...s})}),(0,a.jsx)(p.kp,{label:"All features in Business, plus:",features:["Dedicated support","Onboarding services","Custom connections","Group-based access control","Custom design systems"]})]})})}},40911:(e,t,s)=>{"use strict";s.d(t,{I:()=>c,d:()=>d});var a=s(18502),r=s(87299),l=s(95661),n=s(40702),i=s(61374),o=s(15365);function c(e){var t;let{permission:s,...r}=e,{isAuthenticated:l}=(0,n.Z2)(),c=(0,o.WW)(),{permissions:d,isLoading:u}=(0,i.S)(),p=d.includes(s),m=u&&0===d.length,h=(null==(t=r.enabled)||t)&&!m&&l&&(p||c);return(0,a.I)({...r,enabled:h})}function d(){let e=(0,r.jE)(),{isAuthenticated:t}=(0,n.Z2)(),s=(0,o.WW)(),{permissions:a,isLoading:c}=(0,i.S)();return(0,l.useCallback)(r=>{let{permission:l,enabled:n,...i}=r;if(c)return;let o=a.includes(l);t&&(o||s)&&(null==n||n)&&e.prefetchQuery(i)},[e,t,s,a,c])}},43610:(e,t,s)=>{"use strict";s.d(t,{$:()=>p});var a=s(18502),r=s(48184),l=s(95661),n=s(40702),i=s(61374),o=s(63851),c=s(69850),d=s(89931),u=s(74507);let p=e=>{var t,s,p,h,x,g,f,v,b,j,w,y,_,N,C,P;let{isAuthenticated:E,authUser:k}=(0,n.Z2)(),{permitted:I}=(0,i.J)(u.eZ.ViewWorkspaceUsage),{data:A}=(0,a.I)({queryKey:[...c.workspaceKeys.detail(null!=(t=null==e?void 0:e.id)?t:""),"users",null!=(s=null==k?void 0:k.uid)?s:"","monthly-usage"],queryFn:async()=>{if(!(null==e?void 0:e.id)||!(null==k?void 0:k.uid))return{user_monthly_usage:0,max_usage:null};try{let t=(0,o.P)();return await t.get("/workspaces/".concat(null==e?void 0:e.id,"/user-monthly-usage"))}catch(e){return console.error("Error fetching user monthly usage:",e),{user_monthly_usage:0,max_usage:null}}},enabled:!!(null==e?void 0:e.id)&&!!(null==k?void 0:k.uid)&&I}),S=(0,l.useMemo)(()=>{var t,s,a;if(e&&E)return!!((null!=(t=e.credits_granted)?t:0)-e.credits_used>0)||!!((null!=(s=e.topup_credits_used)?s:0)<(null!=(a=e.topup_credits_limit)?a:0))||!!(e.daily_credits_used<e.daily_credits_limit)||!!((e.billing_period_credits_used||0)<e.billing_period_credits_limit)},[e,E]),L=null!=(p=null==e?void 0:e.daily_credits_limit)?p:0,T=null!=(h=null==e?void 0:e.daily_credits_used)?h:0,R=null!=(x=null==e?void 0:e.billing_period_credits_limit)?x:0,O=null!=(g=null==e?void 0:e.billing_period_credits_used)?g:0,D=null!=(f=null==e?void 0:e.topup_credits_used)?f:0,F=null!=(v=null==e?void 0:e.topup_credits_limit)?v:0,M=(null==e?void 0:e.topup_credits_purchased_at)?(0,r.e)((0,d.ay)(e.topup_credits_purchased_at),1):null,U=null!=(b=null==e?void 0:e.rollover_credits_used)?b:0,W=null!=(j=null==e?void 0:e.rollover_credits_limit)?j:0,B=null!=(w=null==e?void 0:e.credits_granted)?w:0,K=null!=(y=null==e?void 0:e.credits_used)?y:0,V=null!=(_=null==e?void 0:e.total_credits_used_in_billing_period)?_:0,z=null!=(N=null==A?void 0:A.max_usage)?N:null;return{dailyCreditLimit:L,dailyCreditsUsed:T,billingPeriodCreditLimit:R,billingPeriodCreditsUsed:O,rolloverCreditsLimit:W,rolloverCreditsUsed:U,topUpCredits:F-D,topUpCreditsExpireDate:M,bonusCredits:B-K,totalCreditsUsedInBillingPeriod:V,areCreditsAvailable:S,billingPeriodEndDate:m(null==e?void 0:e.billing_period_end_date),userMonthlyUsage:null!=(C=null==A?void 0:A.user_monthly_usage)?C:0,maxUserMonthlyUsage:z,hasCreditLimit:null!==z&&z>0,workspaceDefaultLimit:null!=(P=null==e?void 0:e.default_monthly_member_credit_limit)?P:void 0}},m=e=>e?"string"==typeof e?new Date(e):e.toDate():null},43987:(e,t,s)=>{"use strict";s.d(t,{M:()=>o});var a=s(77145);s(95661);var r=s(72632),l=s(56024),n=s(27458),i=s(58295);let o=e=>{let{workspace:t,requiredPlanCategory:s,className:o,...c}=e,d=(0,r.TP)(s),u=(0,r._R)(t.plan),p=(0,r.m6)(t.plan),m=!(0,r.my)(p,s);return(0,a.jsxs)(i.m_,{children:[(0,a.jsx)(i.k$,{asChild:!0,children:(0,a.jsxs)("div",{className:(0,l.cn)("flex h-5 cursor-pointer items-center gap-1 rounded-sm bg-brand-twilight px-2 py-px text-xs font-medium text-brand-twilight-foreground hover:bg-brand-twilight/80",o),...c,children:[(0,a.jsx)(n.gu,{name:"LovableMonotone",className:"h-3 w-3"}),(0,a.jsx)("p",{className:(0,l.cn)("flex",{hidden:!m}),children:d})]})}),(0,a.jsx)(i.ZI,{children:m?(0,a.jsxs)("p",{children:["Upgrade to ",d," to access this feature."]}):(0,a.jsxs)("p",{children:["Included in ",u]})})]})}},45756:(e,t,s)=>{"use strict";s.d(t,{C:()=>a});var a=function(e){return e.SUBMITTED="submitted",e.SKIPPED="skipped",e.NOT_SHOWN="not_shown",e}({})},45830:(e,t,s)=>{"use strict";s.d(t,{d:()=>r});var a=s(95661);function r(e,t){let[s,r]=(0,a.useState)(e);return(0,a.useEffect)(()=>{let s=setTimeout(()=>{r(e)},t);return()=>{clearTimeout(s)}},[e,t]),s}},47226:(e,t,s)=>{"use strict";s.d(t,{E:()=>l});var a=s(77145),r=s(56024);function l(e){let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,r.cn)("animate-pulse rounded-md bg-primary/10",t),...s})}},47679:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i,t:()=>o});var a=s(77145),r=s(13410),l=s(95661);let n=(0,l.createContext)(void 0),i=e=>{let{children:t}=e,[s,i]=(0,l.useState)(null),o=(0,r.useSearchParams)(),c=(0,r.usePathname)(),d=(0,r.useRouter)(),u=(0,l.useCallback)(e=>{i(null!=e?e:null)},[]),p=(0,l.useCallback)(()=>{let e=new URLSearchParams(o);e.delete("settings");let t=e.toString(),s=t?"".concat(c,"?").concat(t):c;d.replace(s),i(null)},[o,c,d]),m=(0,l.useRef)(null);(0,l.useEffect)(()=>{let e=o.get("settings");null!=e?u(e):c!==m.current&&i(null),m.current=c},[o,u,c]);let h=(0,l.useMemo)(()=>({activeTab:s,openSettings:u,closeSettings:p}),[s,u,p]);return(0,a.jsx)(n.Provider,{value:h,children:t})},o=()=>{let e=(0,l.useContext)(n);if(void 0===e)throw Error("useSettings must be used within a SettingsProvider");return e}},49974:(e,t,s)=>{"use strict";s.d(t,{LS:()=>_,ET:()=>C,et:()=>P});var a=s(77145),r=s(87299),l=s(92912),n=s(95661),i=s(31088),o=s(51762),c=s(51433),d=s(54557),u=s(72632);let p={PRO_TO_PRO_UPGRADE:{title:"Add more credits",subtitle:"Here's what happens if you upgrade:",showCreditDifference:!0,showWhatsChanging:!1,showPlanFeatures:!1,showNextBillingCycle:!0,showPlanDropdown:!0},PRO_TO_BIZ_UPGRADE:{title:"Upgrade to Business",subtitle:"Here's what happens if you upgrade:",showCreditDifference:!0,showWhatsChanging:!0,showPlanFeatures:!1,showNextBillingCycle:!0,showPlanDropdown:!0},BIZ_TO_BIZ_UPGRADE:{title:"Add more credits",subtitle:"Here's what happens if you upgrade:",showCreditDifference:!0,showWhatsChanging:!1,showPlanFeatures:!1,showNextBillingCycle:!0,showPlanDropdown:!0}},m=e=>{let{targetPlan:t,scenario:s}=e,{currentPlan:r}=P(),l=p[s],n=(0,d.Y)({currentPlan:r,targetPlanCategory:(0,u.m6)(t)});return(0,a.jsx)(c.n,{targetPlan:t,availablePlans:n,title:l.title,subtitle:l.subtitle,showCreditDifference:l.showCreditDifference,showWhatsChanging:l.showWhatsChanging,showPlanFeatures:l.showPlanFeatures,showNextBillingCycle:l.showNextBillingCycle,showPlanDropdown:l.showPlanDropdown})};var h=s(3201),x=s(91169),g=s(21016),f=s(39528),v=s(53792),b=s(51573),j=s(69850),w=s(40702),y=s(83220);let _="pendingPlanSelection",N=(0,n.createContext)(void 0),C=e=>{let{children:t,pricingScenario:s}=e,c=(0,r.jE)(),d=(0,y.j4)(e=>e.currentWorkspace),p=(0,y.j4)(e=>{var t;return null==(t=e.membership)?void 0:t.role}),C=(0,y.Dx)(),{authUser:P}=(0,w.Z2)(),{toCheckout:E,createPortalSession:k,checkoutLoading:I,isCreatePortalSessionLoading:A,cancelSubscription:S,isCancelSubscriptionLoading:L,cancelSubscriptionChanges:T,isCancelSubscriptionChangesLoading:R}=(0,x.R)(),[O,D]=(0,n.useState)(null!=s?s:"billing"),F=(0,n.useCallback)(async()=>{(null==d?void 0:d.id)?await k({workspaceId:d.id}):i.toast.error("Something went wrong.",{description:"Please, refresh the page and try again."})},[k,null==d?void 0:d.id]),M=(0,n.useCallback)(async(e,t)=>{(null==d?void 0:d.id)?(await e({workspaceId:d.id}),(null==C?void 0:C.store)&&C.store.setState({currentWorkspace:{...d,...t(d)}}),await new Promise(e=>setTimeout(async()=>{await c.invalidateQueries({queryKey:j.workspaceKeys.all}),e(void 0)},1e3))):i.toast.error("Something went wrong.",{description:"Please, refresh the page and try again."})},[d,null==C?void 0:C.store,c]),U=(0,n.useCallback)(()=>M(S,()=>({plan_scheduled:b.VL.FREE,plan_type_scheduled:void 0})),[M,S]),W=(0,n.useCallback)(()=>M(T,()=>({plan_scheduled:void 0,plan_type_scheduled:void 0})),[M,T]),B=(0,n.useMemo)(()=>{var e,t;return{id:null!=(e=null==d?void 0:d.plan)?e:b.VL.FREE,type:null!=(t=null==d?void 0:d.plan_type)?t:"monthly"}},[d]),K=(0,n.useMemo)(()=>{if(null==d?void 0:d.plan_scheduled){var e,t;return{id:null!=(e=null==d?void 0:d.plan_scheduled)?e:b.VL.FREE,type:null!=(t=null==d?void 0:d.plan_type_scheduled)?t:"monthly"}}},[d]),V="loggedOut"===O,{isFreePlan:z,isLitePlan:Y,isLegacyPlan:G}=(0,u.cb)(B.id),{isLitePlan:Z}=(0,u.cb)(null==K?void 0:K.id),H=!!(!V&&P&&d&&P.uid===d.owner_id),$=!V&&"member"===p,q=!V&&(!!p||H),Q=!V&&!q&&!H,J=.2*!!G,[X,ee]=(0,n.useState)(B.type),et=(0,n.useMemo)(()=>(0,u.yw)(B),[B]),es=(0,n.useMemo)(()=>(0,u.LL)(B),[B]),[ea,er]=(0,n.useState)(et),[el,en]=(0,n.useState)(es),ei=(0,n.useMemo)(()=>Y?B.id:Z&&K?K.id:b.VL.KTLO,[Y,Z,B.id,K]),[eo,ec]=(0,n.useState)(null),[ed,eu]=(0,n.useState)(v.pB[0]);(0,n.useEffect)(()=>{er(et),en(es),ec(null),ee(B.type)},[et,es,O,B]);let ep=(0,n.useCallback)(e=>(0,u.jL)({id:e,type:X}),[X]),em="loggedOut"===O||(null==K?void 0:K.id)==="free",eh=Y||Z,ex=!K&&!eh,eg=(0,n.useCallback)(e=>{if("monthly"===B.type&&"annual"===X&&e===B.id)return!1;let t=(0,u.jL)({...B,type:"monthly"}),s=(0,u.jL)({id:e,type:X,type:"monthly"}),a=(0,u.RL)(B.id),r=(0,u.RL)(e),l=(0,u.m6)(B.id),n=(0,u.m6)(e);return"biz"==l?"biz"==n?s<t:r<=a:"biz"==n?r<a:s<t},[B,X]),ef=(0,n.useCallback)(e=>e===B.id&&X===B.type?"current":z||(0,u.jL)(B)===ep(e)?"upgrade":"enterprise"===B.id?"downgrade":e===B.id&&"annual"===X&&"monthly"===B.type?"switchToAnnual":eg(e)?"downgrade":"upgrade",[B,z,ep,X,eg]),ev=(0,n.useCallback)(e=>{let t=ef(e);if("current"===t)return"Your current plan";if("switchToAnnual"===t)return"Switch to annual";let{isProPlan:s,isBizPlan:a}=(0,u.cb)(B.id),{isProPlan:r,isBizPlan:l}=(0,u.cb)(e);return"upgrade"===t?s&&r||a&&l?"Upgrade current plan":"Upgrade":"enterprise"===B.id?"Downgrade (Contact us)":"Downgrade"},[ef,B]),eb=(0,n.useMemo)(()=>{var e,t,s;return(null==P?void 0:P.email)||(null==P||null==(s=P.firebase)||null==(t=s.identities)||null==(e=t.email)?void 0:e[0])||"xxxxx"},[P]),ej=(0,g.A)("sm"),ew=(0,n.useMemo)(()=>ej?1:[em,eh,!0,!0,ex].filter(Boolean).length,[ej,em,eh,!0,!0,ex]),ey=(0,n.useCallback)(e=>{let t=ef(e);return"upgrade"===t||"switchToAnnual"===t?"twilight":"link"},[ef]),e_=ey(ea),eN=ey(el),eC=(0,n.useCallback)(e=>{if("free"===e){window.location.href="/signup";return}let t={planId:e,planType:"pro",timestamp:Date.now(),price:ep(e),limit:(0,u.RL)(e)};localStorage.setItem(_,JSON.stringify(t)),window.location.href="/signup"},[ep]),eP=(()=>{let e=(0,o.f)(m);return t=>{let{targetPlan:s,scenario:a}=t;e({childProps:{targetPlan:s,scenario:a,onClose:()=>e(!1)}})}})(),eE=(0,n.useCallback)(async e=>{(null==d?void 0:d.id)&&await E({plan:e,workspaceId:d.id,grandfatheredDiscount:G,planType:X,changeType:"upgrade",useStudentDiscount:"studentDiscount"==O})},[d,E,G,X,O]),ek=(0,n.useCallback)(async e=>{l.Ay.capture(f.aw.PLAN_UPGRADE_CLICKED,{current_plan_id:B.id,current_plan_type:B.type,target_plan_id:e,target_plan_type:X,plan_type:(0,u.m6)(e),plan_price:ep(e)});let t=function(e,t,s){if("annual"===s||"annual"===e.type)return null;let a=(0,u.m6)(e.id),r=(0,u.m6)(t);return"biz"===a&&"pro"===r?null:"pro"===a&&"biz"===r?"PRO_TO_BIZ_UPGRADE":"pro"===a&&"pro"===r?"PRO_TO_PRO_UPGRADE":"biz"===a&&"biz"===r?"BIZ_TO_BIZ_UPGRADE":null}(B,e,X);t?eP({targetPlan:e,scenario:t}):await eE(e)},[B,X,ep,eE,eP]),eI=(0,n.useCallback)(()=>{ec(b.VL.FREE)},[]),eA=(0,n.useCallback)(e=>{if("annual"===X)return 2*(0,u.jL)({id:e,type:"monthly"})},[X]),eS=(0,o.f)(h.u),eL=(0,n.useCallback)(()=>{d&&eS({childProps:{workspace:d,onClose:()=>eS(!1)},dialogProps:{onOpenChange:e=>{e||ec(null)}}})},[eS,d]);return(0,a.jsx)(N.Provider,{value:{isLitePlan:Y,isScheduledLitePlan:Z,currentPlan:B,selectedProPlan:ea,setSelectedProPlan:er,selectedBizPlan:el,setSelectedBizPlan:en,selectedLitePlan:ei,planType:X,setPlanType:ee,pricingScenario:O,setPricingScenario:D,getDisplayPrice:ep,showFreePlan:em,showKtloPlan:eh,showProPlan:!0,showBizPlan:!0,showEnterprisePlan:ex,showProDropdown:!V,showBizDropdown:!V,isLoggedOut:V,isOwner:H,isEditor:$,isMemberOfWorkspace:q,shouldDisableWorkspaceAdminActions:!V&&($||Q||!V&&"viewer"===p||!V&&"collaborator"===p),userEmail:eb,scheduledPlan:K,discountPercent:J,getSavingsAmount:eA,handleUpgradeClicked:ek,handleUpgradeConfirmed:eE,handleLoggedOutUpgrade:eC,getButtonVariant:ey,getButtonText:ev,getPlanComparisonStatus:ef,createPortalSession:F,isCreatePortalSessionLoading:A,cancelSubscription:U,isCancelSubscriptionLoading:L,cancelSubscriptionChanges:W,isCancelSubscriptionChangesLoading:R,checkoutLoading:I,numberOfPlansShown:ew,freePlanButtonVariant:V?"twilight":"link",proPlanButtonVariant:e_,bizPlanButtonVariant:eN,isPlanDowngrade:eg,targetDowngradePlan:eo,setTargetDowngradePlan:ec,setFreePlanAsTarget:eI,newWorkspaceSelectedPlan:ed,setNewWorkspaceSelectedPlan:eu,onDowngradeClick:eL},children:t})},P=()=>{let e=(0,n.useContext)(N);if(!e)throw Error("usePricing must be used within a PricingProvider");return e}},50758:(e,t,s)=>{"use strict";s.d(t,{P:()=>i});var a=s(77145),r=s(51385),l=s(67844),n=s(56024);let i=e=>{let{id:t,displayName:s,avatarClassName:i,actionComponent:o,email:c,isCurrentUser:d=!1,isInvited:u=!1,showBadge:p=!0}=e;return(0,a.jsxs)("div",{className:"flex items-center justify-start gap-3 py-1 md:flex-nowrap",children:[(0,a.jsx)(r.UserAvatar,{user:{id:t,username:null!=s?s:c},className:(0,n.cn)(i,u&&"opacity-60","h-8 w-8"),isInteractive:!1}),(0,a.jsx)("div",{className:"flex min-w-0 flex-shrink items-center gap-4 ".concat(u&&"opacity-60"),children:(0,a.jsxs)("div",{className:"flex min-w-0 flex-col gap-0",children:[(0,a.jsxs)("div",{className:"flex-shrink truncate text-sm font-medium leading-tight",children:[s," ",d&&(0,a.jsx)("span",{className:"font-normal",children:"(you)"})]}),(0,a.jsx)("span",{className:"max-w-[150px] flex-shrink truncate text-xs text-muted-foreground",children:c})]})}),u&&p&&(0,a.jsx)(l.E,{variant:"outline",className:"hidden gap-1 bg-muted text-xs font-medium text-muted-foreground md:flex",children:"Invite sent"}),o&&(0,a.jsx)("div",{className:"ml-auto flex-shrink-0",children:o})]})}},51328:(e,t,s)=>{"use strict";s.d(t,{s:()=>d});var a=s(87299),r=s(6698),l=s(83473),n=s(63851),i=s(99989),o=s(21789),c=s(33895);function d(e){let{workspaceId:t}=e,s=(0,a.jE)(),d=(0,o.H)(),{mutateAsync:u,isPending:p}=(0,r.n)({mutationFn:async e=>{let{email:s,role:a="member"}=e;return(0,n.P)().post("/workspaces/".concat(t,"/memberships"),{email:s,role:a})},onSuccess:async e=>{if(e){let r=i.y.workspaceMemberships({workspaceId:t}),l=s.getQueryData(r.queryKey);if(l&&!l.members.some(t=>t.user_id===e.user_id)){var a;s.setQueryData(r.queryKey,{...l,members:[...l.members,e],total:l.total+1,limit:l.limit,offset:null!=(a=l.offset)?a:0,has_more:l.has_more})}if(d&&(!d.query||""===d.query.trim())){let a=i.y.searchWorkspaceMemberships({workspaceId:t,params:d}),r=s.getQueryData(a.queryKey);r&&(r.members.some(t=>t.user_id===e.user_id)||s.setQueryData(a.queryKey,{...r,members:[...r.members,e],total:r.total+1,limit:r.limit,offset:r.offset,has_more:r.has_more}))}}(0,c.y)(s,t,d,{invalidateAll:!0})},onError:e=>{(0,l.Ni)(e)}});return{inviteWorkspaceMember:u,isInvitingMember:p}}},51385:(e,t,s)=>{"use strict";s.d(t,{UserAvatar:()=>o});var a=s(77145),r=s(18502),l=s(59142),n=s(90249),i=s(6971);let o=e=>{var t,s;let{isInteractive:o=!1,className:c,user:d,zIndex:u,...p}=e,m=(0,n.Q)(d.id),h=(null==(t=d.attributes)?void 0:t.display_name)||(d.username&&d.username!==d.id?d.username:d.id),{data:x}=(0,r.I)({...i.Y.publicProfile({username:d.id}),enabled:!!d.id}),g=null!=(s=null==x?void 0:x.avatar_url)?s:void 0;return(0,a.jsx)(l._,{name:h,isInteractive:o,photoSrc:g,userColor:m,className:c,zIndex:u,...p})}},51433:(e,t,s)=>{"use strict";s.d(t,{n:()=>f});var a=s(77145),r=s(95661),l=s(83220),n=s(49974),i=s(54401),o=s(52811),c=s(20247),d=s(69730),u=s(27458),p=s(72632);let m=["User roles & permissions","Custom domains","Remove the Lovable badge"],h=["SSO","Personal Projects","Opt out of data training","Design templates"],x=["Downgrade anytime","Credits rollover"],g=e=>{let{features:t}=e;return(0,a.jsx)("div",{className:"mt-3 space-y-3",children:t.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-start gap-[6px]",children:[(0,a.jsx)(d.A,{name:"check",weight:"medium",size:"small",className:"relative top-0.5"}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:e})]},t))})},f=e=>{let{targetPlan:t,availablePlans:s,title:d,subtitle:f,showCreditDifference:v=!0,showWhatsChanging:b=!0,showPlanFeatures:j=!0,showNextBillingCycle:w=!0,showPlanDropdown:y=!0,handleCancel:_,handleConfirm:N}=e,{getDisplayPrice:C,handleUpgradeConfirmed:P,currentPlan:E,checkoutLoading:k}=(0,n.et)(),I=(0,p.RL)(E.id),A=(0,p.m6)(t),[S,L]=(0,r.useState)(t),T=(0,p.RL)(S),R=(0,l.j4)(e=>e.currentWorkspace),O=w&&!j,D=(0,p.bn)(null==R?void 0:R.billing_period_end_date),F=(0,p.jL)(E),M=C(S),U=T-I,W=C(S),B=async()=>{null==N||N("upgrade",S),await P(S)};return(0,a.jsxs)(c.Cf,{className:"max-h-[90vh] max-w-[425px] overflow-y-auto",children:[(0,a.jsxs)(c.c7,{className:"space-y-4",children:[(0,a.jsx)(u.Fy,{className:"size-9 shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsx)(c.L3,{className:"mb-2 text-3xl font-medium",children:d}),(0,a.jsx)("p",{className:"text-sm text-foreground",children:f})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,a.jsxs)("div",{className:"rounded-lg border-2 border-muted-border p-4",children:[(0,a.jsx)("div",{className:"text-lg font-medium",children:"Upgrade Fee"}),(0,a.jsx)(i.D,{selectedPlan:S,setSelectedPlan:L,availablePlans:s,showCreditDifference:v,showPlanDropdown:y})]}),b&&(0,a.jsxs)("div",{className:"rounded-lg bg-muted p-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:"What's changing?"}),(0,a.jsxs)("p",{className:"mt-1.5 text-sm text-muted-foreground",children:["You are unlocking all business features"," ",U?"and receiving ".concat(U," credits today"):"but your credits will stay the same"]})]}),j&&(0,a.jsxs)("div",{className:"rounded-lg bg-muted p-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:"You will unlock:"}),(0,a.jsx)(g,{features:[..."biz"===A?h:m,...O?[]:x]})]}),w&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm font-medium",children:["Next billing cycle (",D,")"]}),(0,a.jsx)(g,{features:["Your plan will update to $".concat(W," / month for ").concat((0,p.RL)(S)," credits"),...O?x:[]]})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 border-t pt-4",children:[(0,a.jsx)(c.HM,{asChild:!0,children:(0,a.jsx)(o.$,{variant:"decline",className:"flex-1",onClick:()=>{null==_||_("upgrade")},children:"Cancel"})}),(0,a.jsx)(o.$,{className:"flex-1",variant:"default",onClick:B,loading:!!k,children:M>F?"Upgrade":"Confirm"})]})]})}},51762:(e,t,s)=>{"use strict";s.d(t,{RootDialog:()=>c,f:()=>o});var a=s(77145),r=s(95661),l=s(84510),n=s(20247);let i=(0,l.vt)(e=>({openDialog:null,setOpenDialog:t=>{e({openDialog:t})}}));function o(e){let t=i(e=>e.setOpenDialog);return(0,r.useCallback)(s=>{s?t({component:e,...s}):t(null)},[e,t])}let c=()=>{let e=i(e=>e.openDialog),t=i(e=>e.setOpenDialog);if((0,r.useEffect)(()=>{if(e){var t,s;null==(s=e.dialogProps)||null==(t=s.onOpen)||t.call(s)}},[e]),!e)return null;let{component:s,dialogProps:l,childProps:o}=e;return(0,a.jsx)(n.lG,{...l,open:!!e,onOpenChange:e=>{var s;e||t(null),null==l||null==(s=l.onOpenChange)||s.call(l,e)},children:(0,a.jsx)(s,{...o})})}},53384:(e,t,s)=>{"use strict";s.d(t,{s:()=>g});var a=s(77145),r=s(92912),l=s(49974),n=s(40488),i=s(39528),o=s(30849),c=s(46753),d=s.n(c),u=s(52811),p=s(52873),m=s(56024);let h=()=>(0,a.jsx)("div",{className:"flex w-full justify-center",children:(0,a.jsx)(p.Zp,{className:(0,m.cn)("w-full max-w-[360px] rounded-xl border-input bg-transparent p-6 sm:max-w-none"),children:(0,a.jsxs)("div",{className:"flex flex-col items-center justify-between gap-4 sm:flex-row",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:gap-6",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,a.jsx)(p.ZB,{className:"text-lg font-medium",children:"Security and Compliance"}),(0,a.jsx)(p.BT,{className:"text-sm",children:"Enterprise-grade security and compliance certifications"})]}),(0,a.jsx)("div",{className:"flex items-center justify-center sm:justify-start",children:(0,a.jsx)("div",{className:"flex h-[100px] items-center justify-center overflow-hidden",children:(0,a.jsx)(o.default,{src:"/img/security/industry-recognized-security.png",alt:"Security certifications: ISO 27001, GDPR, SOC 2 Type II",width:300,height:75,className:"h-auto w-full max-w-[240px]"})})})]}),(0,a.jsx)(u.$,{asChild:!0,variant:"outline",size:"lg",className:"w-full bg-transparent px-8 sm:w-auto sm:shrink-0 lg:min-w-[180px]",children:(0,a.jsx)(d(),{href:"https://lovable.dev/security",target:"_blank",rel:"noopener noreferrer",children:"Learn more"})})]})})}),x=()=>(0,a.jsx)("div",{className:"flex w-full justify-center",children:(0,a.jsx)(p.Zp,{className:(0,m.cn)("w-full max-w-[360px] rounded-xl border-input bg-transparent sm:max-w-none"),children:(0,a.jsxs)("div",{className:"flex flex-col items-center justify-between gap-4 sm:flex-row",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,a.jsx)(p.ZB,{className:"text-lg font-medium",children:"Student discount"}),(0,a.jsx)(p.BT,{className:"text-sm",children:"Verify student status and get access to up to 50% off Lovable Pro."})]}),(0,a.jsx)(u.$,{asChild:!0,variant:"outline",size:"lg",className:"w-full bg-transparent px-8 sm:w-auto sm:shrink-0 lg:min-w-[180px]",children:(0,a.jsx)(d(),{href:"/students",target:"_blank",rel:"noopener noreferrer",children:"Learn more"})})]})})}),g=e=>{let{className:t,showStudentDiscountCard:s}=e,{pricingScenario:o}=(0,l.et)();return r.Ay.capture(i.aw.PLAN_VIEWED,{plan_context:o}),(0,a.jsxs)(n.ZL,{className:t,suffix:(0,a.jsxs)(a.Fragment,{children:[s&&(0,a.jsx)(x,{}),(0,a.jsx)(h,{})]}),children:[(0,a.jsx)(n.ZL.Free,{}),(0,a.jsx)(n.ZL.Ktlo,{}),(0,a.jsx)(n.ZL.Scheduled,{}),(0,a.jsx)(n.ZL.Pro,{}),(0,a.jsx)(n.ZL.Biz,{}),(0,a.jsx)(n.ZL.Enterprise,{})]})}},54401:(e,t,s)=>{"use strict";s.d(t,{D:()=>o});var a=s(77145),r=s(49974),l=s(2231),n=s(72632),i=s(56024);let o=e=>{let{selectedPlan:t,setSelectedPlan:s,availablePlans:o,showCreditDifference:c=!0,showPlanDropdown:d=!0,showPriceInDropdown:u=!1}=e,{getDisplayPrice:p,currentPlan:m}=(0,r.et)(),h=(0,n.RL)(m.id),x=(0,n.jL)(m),g=p(t),f=Math.max(0,g-x);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:(0,i.cn)("flex items-center",{"mb-3":d}),children:[(0,a.jsxs)("span",{className:"text-4xl font-medium",children:["$",c?f:g]}),(0,a.jsx)("span",{className:"ml-2 text-base text-foreground",children:c?"due today":"per month"})]}),d&&(0,a.jsx)(l.h,{options:o,selectedOption:t,onSelect:s,showCreditDifference:c,currentPlanLimit:h,priceInDropdown:{show:u,getDisplayPrice:p}})]})}},54436:(e,t,s)=>{"use strict";s.d(t,{R:()=>a});let a=e=>{if("undefined"==typeof document)return;let t="; ".concat(document.cookie).split("; ".concat(e,"="));if(2===t.length){var s;return null==(s=t.pop())?void 0:s.split(";").shift()}}},54557:(e,t,s)=>{"use strict";s.d(t,{Y:()=>r});var a=s(72632);function r(e){let{currentPlan:t,targetPlanCategory:s}=e,r=(0,a.m6)(t.id)===s;if("pro"!==s&&"biz"!==s&&"enterprise"!==s)throw Error("Target plan category must be pro or biz");return"enterprise"===s?[]:r?(0,a.yQ)(t.id,s):(0,a.Bq)(t.id,s)}},59142:(e,t,s)=>{"use strict";s.d(t,{_:()=>o});var a=s(77145),r=s(95661),l=s(86652),n=s(58295),i=s(56024);let o=e=>{let{name:t,isInteractive:s,className:o,photoSrc:c,userColor:d,isWorkspace:u=!1,tooltipContent:p=t,zIndex:m,...h}=e,x=t?t.charAt(0).toUpperCase():"",[g,f]=(0,r.useState)(!1);return(0,a.jsxs)(n.m_,{open:!!s&&!!t&&g,onOpenChange:f,children:[(0,a.jsx)(n.k$,{asChild:!0,children:(0,a.jsxs)(l.eu,{className:(0,i.cn)("h-[26px] w-[26px] shrink-0 items-center border border-transparent text-xs",{["hover:bg-".concat(d)]:!c&&!u&&s,"cursor-pointer":s,["hover:border-".concat(d)]:s,["group-[.avatars]:hover:border-".concat(d)]:s,"group-[.avatars]:border-background":!0,"rounded-[8px] hover:border-transparent":u},o),style:{zIndex:m},...h,children:[(0,a.jsx)(l.BK,{className:"aspect-auto object-cover",src:c}),(0,a.jsx)(l.q5,{className:(0,i.cn)("items-center border-none font-medium text-white","bg-".concat(d),u&&"rounded-lg"),children:x})]})}),(0,a.jsx)(n.ZI,{children:p})]})}},60607:(e,t,s)=>{"use strict";function a(e){return Number.isInteger(e)?e.toString():e.toFixed(2)}s.d(t,{Q:()=>a})},61374:(e,t,s)=>{"use strict";s.d(t,{J:()=>h,S:()=>m});var a=s(18502),r=s(95661),l=s(53789),n=s(72490),i=s(63851),o=s(69850);let c={permissions:e=>{let{workspaceId:t,projectId:s}=e;return(0,l.j)({queryKey:o.QO.get(t,s),queryFn:async()=>{if(!s&&!t)return[];let e=(0,i.P)(),a=new URLSearchParams;return s?a.append("projectId",s):t&&a.append("workspaceId",t),e.get("/permissions?".concat(a.toString()))},refetchOnMount:!0,refetchOnWindowFocus:!1,staleTime:3e5,retry:3,placeholderData:n.rX})}};var d=s(82149),u=s(40702),p=s(83220);function m(){let e=(0,d.mb)(e=>e.projectId),t=(0,p.j4)(e=>{var t;return null==(t=e.currentWorkspace)?void 0:t.id}),{isAuthenticated:s}=(0,u.Z2)(),{data:l,isLoading:n}=(0,a.I)({...c.permissions({workspaceId:t,projectId:e}),enabled:s});return{permissions:(0,r.useMemo)(()=>s&&Array.isArray(l)?l:[],[s,l]),isLoading:n}}function h(e,t){let s=(0,d.mb)(e=>e.projectId),l=(0,p.j4)(e=>{var t;return null==(t=e.currentWorkspace)?void 0:t.id}),{isAuthenticated:n}=(0,u.Z2)(),{data:i,isLoading:o}=(0,a.I)({...c.permissions({workspaceId:l,projectId:null!=t?t:s}),enabled:n});return{permitted:(0,r.useMemo)(()=>n&&Array.isArray(i)&&i.includes(e),[n,i,e]),isLoading:o}}},63424:(e,t,s)=>{"use strict";s.d(t,{bT:()=>d,bY:()=>m,x_:()=>c});var a=s(77145),r=s(95661),l=s(58295),n=s(87252);let i={GAP_SCALE_FACTOR:.002,MIN_GAP_WIDTH:2,MIN_INDICATOR_WIDTH:7,PROGRESS_BAR_HEIGHT:11,FALLBACK_MIN_WIDTH_PERCENTAGE:2},o=["bg-blue-800","bg-blue-600","bg-blue-400","bg-blue-200","bg-blue-50"],c=(e,t)=>{if(!e)return"bg-muted-foreground";if("granted"===e)return"bg-brand-twilight-primary";let s=t.filter(e=>"granted"!==e.name).findIndex(t=>t.name===e);return -1===s?"bg-muted-foreground":o[Math.min(s,o.length-1)]},d=e=>{switch(e){case"daily":return"Daily credits used first";case"rollover":return"Using rollover credits";case"billing":return"Using monthly credits";case"topup":return"Using topup credits";case"granted":return"Using bonus credits";case null:return"You are out of credits"}},u={granted:"Bonus",billing:"Monthly",rollover:"Rollover",topup:"Topup",daily:"Daily"},p=e=>u[e],m=e=>{let{progressData:t}=e,s=(0,r.useRef)(null),[o,d]=(0,r.useState)(0);(0,r.useLayoutEffect)(()=>{let e=()=>{s.current&&d(s.current.offsetWidth)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let u=Math.max(i.MIN_GAP_WIDTH,o*i.GAP_SCALE_FACTOR),m=i.MIN_INDICATOR_WIDTH,h=(0,r.useMemo)(()=>t.hasCredits?t.sources.map((e,s)=>{let a=Math.max(t.totalAllocation>0?e.remaining/t.totalAllocation*100:0,o>0?m/o*100:i.FALLBACK_MIN_WIDTH_PERCENTAGE),r=s===t.sources.length-1,l=c(e.name,t.sources);return{...e,widthPercentage:a,isFirst:0===s,isLast:r,colorClass:l}}):[],[t.hasCredits,t.sources,t.totalAllocation,o,m]),x=(0,r.useMemo)(()=>{if(!t.hasCredits||0===h.length)return[];let e=o>0?u/o*100:.4,s=Math.max(0,h.length-1)*e,a=h.reduce((e,t)=>e+t.widthPercentage,0)+s,r=a>100?100/a:1,l=e*r,n=0;return h.map(e=>{let t=e.widthPercentage*r,s=n;return n+=t+(e.isLast?0:l),{...e,widthPercentage:t,leftOffset:s}})},[t.hasCredits,h,o,u]);return t.hasCredits?(0,a.jsx)("div",{className:"flex w-full items-center gap-2",children:(0,a.jsx)("div",{ref:s,className:"relative flex-1 overflow-hidden rounded-lg bg-muted-active",style:{height:"".concat(i.PROGRESS_BAR_HEIGHT,"px")},children:x.map(e=>(0,a.jsxs)(l.m_,{delayDuration:0,children:[(0,a.jsx)(l.k$,{asChild:!0,children:(0,a.jsx)("div",{className:"absolute h-full cursor-pointer ".concat(e.colorClass," transition-all ").concat(e.isFirst?"rounded-bl-lg rounded-tl-lg":""," ").concat(e.isLast?"rounded-br-lg rounded-tr-lg":""),style:{left:"".concat(e.leftOffset,"%"),width:"".concat(e.widthPercentage,"%")}})}),(0,a.jsx)(l.ZI,{className:"border border-gray-200 bg-white shadow-lg",children:(0,a.jsx)("div",{className:"justify-center text-xs font-normal leading-none text-black",children:["granted","topup"].includes(e.name)?"".concat((0,n.Q)(e.remaining)," ").concat(p(e.name)," credits"):"".concat((0,n.Q)(e.remaining),"/").concat((0,n.Q)(e.limit)," ").concat(p(e.name)," credits")})})]},e.name))})}):(0,a.jsx)("div",{className:"flex w-full items-center gap-2",children:(0,a.jsx)("div",{className:"relative h-2.5 flex-1 overflow-hidden rounded-lg bg-muted-active"})})}},64482:(e,t,s)=>{"use strict";s.d(t,{H:()=>i,f:()=>n});var a=s(95661),r=s(83220),l=s(8904);let n=()=>{let e=(0,r.j4)(e=>e.currentWorkspace);return(0,a.useMemo)(()=>{var t;return!!(null==e||null==(t=e.experimental_features)?void 0:t.lovable_cloud)},[e])},i=e=>{let{supabaseIntegrationData:t}=(0,l.U)(null==e?void 0:e.id);return(0,a.useMemo)(()=>!!e&&!!t&&!!t.is_managed_by_lovable,[t,e])}},69994:(e,t,s)=>{"use strict";s.d(t,{D:()=>o});var a=s(43610),r=s(53792),l=s(72632),n=s(87252);let i=e=>e?"string"==typeof e?new Date(e):e.toDate():null,o=e=>{let{billingPeriodCreditLimit:t,billingPeriodCreditsUsed:s,dailyCreditLimit:o,dailyCreditsUsed:c,bonusCredits:d,billingPeriodEndDate:u,totalCreditsUsedInBillingPeriod:p,topUpCredits:m,topUpCreditsExpireDate:h,rolloverCreditsLimit:x,rolloverCreditsUsed:g}=(0,a.$)(e),f=(null==e?void 0:e.plan)==="free"?Math.max(0,Math.min(r.le-(null!=p?p:0),null!=o?o:0)):null!=o?o:0,v={granted:(0,n.V)(d),billing:(0,n.V)(t),rollover:(0,n.V)(x),topup:(0,n.V)(m),daily:(0,n.V)(f)},b={granted:0,topup:0,billing:(0,n.V)(Math.min(s,v.billing)),rollover:(0,n.V)(Math.min(g,v.rollover)),daily:(0,n.V)(Math.min(c,v.daily))},j=(e=>{if(!e)return!1;let{isLegacyPlan:t,isAmbassadorPlan:s,isLitePlan:a}=(0,l.cb)(e.plan);return(t||s||a)&&(0===e.billing_period_credits_limit||void 0===e.billing_period_credits_limit)})(e),w={granted:(0,n.V)(v.granted-b.granted),billing:j?0:(0,n.V)(v.billing-b.billing),rollover:(0,n.V)(v.rollover-b.rollover),topup:(0,n.V)(v.topup-b.topup),daily:(0,n.V)(v.daily-b.daily)},y=(0,n.V)(w.granted+w.billing+w.rollover+w.topup+w.daily),_=(0,n.V)(b.billing+b.rollover+b.topup+b.daily),N=(0,n.V)(j?v.granted+v.rollover+v.topup+v.daily:v.granted+v.billing+v.rollover+v.topup+v.daily),C=[{name:"granted",remaining:w.granted,limit:v.granted},{name:"topup",remaining:w.topup,limit:v.topup},{name:"billing",remaining:w.billing,limit:v.billing},{name:"rollover",remaining:w.rollover,limit:v.rollover},{name:"daily",remaining:w.daily,limit:v.daily}].filter(e=>e.remaining>0);return{totalRemaining:y,totalAllocation:N,totalUsed:_,sources:C,hasCredits:N>0,currentlyConsuming:w.daily>0?"daily":w.rollover>0?"rollover":w.billing>0?"billing":w.topup>0?"topup":w.granted>0?"granted":null,billingPeriodEndDate:u,creditsResetDate:(e=>{if(!e)return null;if("annual"===e.plan_type){let t=i(e.last_rollover_period||e.billing_period_start_date||e.billing_period_end_date);if(t){let e=t.getMonth()+1,s=t.getFullYear(),a=t.getDate(),r=new Date(s,e+1,0).getDate();return new Date(s,e,Math.min(a,r))}return null}return e.billing_period_end_date?i(e.billing_period_end_date):null})(e),totalCreditsUsedInBillingPeriod:null!=p?p:0,topUpCreditsExpireDate:h}}},72015:(e,t,s)=>{"use strict";s.d(t,{t:()=>c});var a=s(77145),r=s(95661),l=s(8711),n=s(69730),i=s(56024),o=s(58295);let c=e=>{let{label:t,isSelected:s,onClick:c,disabled:d,className:u,destructive:p,tooltip:m,rightElement:h}=e,[x,g]=(0,r.useState)(!1);return(0,a.jsxs)(o.m_,{open:void 0!==m&&x,onOpenChange:g,children:[(0,a.jsx)(o.k$,{asChild:!0,children:(0,a.jsxs)(l._2,{onClick:c,disabled:d,className:(0,i.cn)("flex items-center justify-between",{"bg-muted":s,"cursor-default":d,"text-destructive-primary focus:bg-destructive focus:text-destructive-foreground":p},u),children:[(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[t,h]}),s&&(0,a.jsx)(n.A,{name:"check",size:"small"})]})}),(0,a.jsx)(o.ZI,{side:"right",className:"max-w-[30ch]",children:m})]})}},73726:(e,t,s)=>{"use strict";s.d(t,{A:()=>i,V:()=>n});var a=s(77145);s(95661);var r=s(69730),l=s(58295);let n=e=>{let{name:t="question_circle",children:s,size:n="small",delay:i,tooltipContentClassName:o,...c}=e;return(0,a.jsxs)(l.m_,{delayDuration:i,children:[(0,a.jsx)(l.k$,{asChild:!0,children:(0,a.jsx)(r.I,{name:t,size:n,...c})}),(0,a.jsx)(l.ZI,{className:o,children:s})]})},i=n},76449:(e,t,s)=>{"use strict";s.d(t,{F:()=>c});var a=s(77145),r=s(29485);s(95661);var l=s(56024),n=s(98324),i=s.n(n);let o=(0,r.F)("",{variants:{variant:{default:i().shimmerText,success:i().shimmerTextSuccess}},defaultVariants:{variant:"default"}}),c=e=>{let{children:t,className:s,isShimmering:r=!1,variant:n,...i}=e;return(0,a.jsx)("span",{className:(0,l.cn)(s,r&&o({variant:n})),...i,children:t})}},81818:(e,t,s)=>{"use strict";s.d(t,{m:()=>ec,$:()=>ed});var a=s(77145),r=s(46753),l=s.n(r),n=s(26158),i=s(40911),o=s(63851),c=s(74507),d=s(18502),u=s(95661),p=s(31088),m=s(61374),h=s(98635),x=s(27623),g=s(52811),f=s(91604),v=s(69730),b=s(6397),j=s(58295),w=s(45830),y=s(72632),_=s(99989),N=s(86912),C=s(53861),P=s(51328),E=s(79306),k=s(24072),I=s(51385),A=s(33817),S=s(36704),L=s(39528),T=s(58058);let R=e=>{let{requests:t}=e,{acceptRequest:s,declineRequest:r,isAccepting:n,isDeclining:i}=(0,S.L)(),o=(0,k.sf)();return(0,a.jsxs)(A.XI,{children:[(0,a.jsx)(A.A0,{children:(0,a.jsxs)(A.Hj,{children:[(0,a.jsx)(A.nd,{className:"w-[250px]",children:"User"}),(0,a.jsx)(A.nd,{children:"Project"}),(0,a.jsx)(A.nd,{children:"Role"}),(0,a.jsx)(A.nd,{children:"Requested"}),(0,a.jsx)(A.nd,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(A.BF,{children:t.map(e=>(0,a.jsxs)(A.Hj,{children:[(0,a.jsx)(A.nA,{children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(I.UserAvatar,{user:{id:e.user_id,username:e.user_name||e.user_id},className:"h-8 w-8"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:e.user_name||e.user_email}),e.user_email&&e.user_name&&(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:e.user_email})]})]})}),(0,a.jsx)(A.nA,{children:(0,a.jsx)(l(),{href:"/projects/".concat(e.project_id),className:"text-sm underline underline-offset-4",children:e.project_name||e.project_id})}),(0,a.jsx)(A.nA,{children:(0,a.jsx)("span",{className:"text-sm capitalize",children:T.P[e.access_level]})}),(0,a.jsx)(A.nA,{children:(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:(0,E.m)(new Date(e.created_at),{addSuffix:!0})})}),(0,a.jsx)(A.nA,{className:"text-right",children:(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(g.$,{size:"sm",variant:"outline",onClick:()=>(e=>{r({projectId:e.project_id,requestId:e.id,workspaceId:e.workspace_id}),o.capture(L.$6.COLLABORATION.PROJECT_ACCESS_REQUEST_REJECTED,{project_id:e.project_id,request_id:e.id,workspace_id:e.workspace_id,component:"access_requests_table"})})(e),disabled:n||i,children:"Deny"}),(0,a.jsx)(g.$,{size:"sm",onClick:()=>(e=>{s({projectId:e.project_id,requestId:e.id,workspaceId:e.workspace_id}),o.capture(L.$6.COLLABORATION.PROJECT_ACCESS_REQUEST_ACCEPTED,{project_id:e.project_id,request_id:e.id,workspace_id:e.workspace_id,component:"access_requests_table"})})(e),disabled:n||i,children:"Approve"})]})})]},"".concat(e.user_id,"-").concat(e.project_id)))})]})};var O=s(8974),D=s(40702),F=s(51762),M=s(20247);let U=e=>{let{memberName:t,memberRole:s,onConfirm:r,onCancel:l}=e,[n,i]=(0,u.useState)(!1),o=async()=>{i(!0);try{await r()}finally{i(!1)}},d=s===c.j6.COLLABORATOR;return(0,a.jsxs)(M.Cf,{size:"sm",children:[(0,a.jsxs)(M.c7,{children:[(0,a.jsx)(M.L3,{children:"Remove workspace member"}),(0,a.jsxs)(M.rr,{children:["Are you sure you want to remove ",t," from this workspace?"," ",!d&&"They will no longer have access to any workspace projects or resources."]})]}),d&&(0,a.jsxs)("div",{className:"flex gap-3 rounded-md border border-warning-primary/30 bg-warning-primary/10 p-4",children:[(0,a.jsx)(v.A,{name:"warning",className:"h-5 w-5 shrink-0 text-warning-primary"}),(0,a.jsxs)("p",{className:"text-sm",children:[(0,a.jsx)("strong",{children:"Warning:"})," Since this user is a collaborator, removing them will remove their project-specific access to ALL projects they collaborate on in this workspace."]})]}),(0,a.jsxs)(M.Es,{className:"gap-2 sm:justify-end",children:[(0,a.jsx)(g.$,{variant:"outline",onClick:l,disabled:n,children:"Cancel"}),(0,a.jsx)(g.$,{variant:"destructive",onClick:o,disabled:n,loading:n,children:n?"Removing...":"Remove"})]})]})};var W=s(67844),B=s(8711),K=s(72015),V=s(43987),z=s(83473),Y=s(214),G=s(60607),Z=s(87299),H=s(6698),$=s(82149),q=s(69850),Q=s(21789),J=s(33895);let X={owner:"Owner",admin:"Admin",member:"Editor",viewer:"Viewer",collaborator:"Collaborator"},ee={owner:"Owners can manage all collaborators, projects, and connections.",admin:"Admins can manage editors, projects, and connections.",member:"Editors can only create and edit projects.",viewer:"Viewers can only view projects.",collaborator:"Collaborators only have access to projects they have been invited to."},et=e=>{var t;let{currentMembership:s,workspaceId:r,workspace:l,permissions:n,currentMonthUsage:i,totalUsage:d,dateJoined:p}=e,[m,h]=(0,u.useState)(null!=(t=s.monthly_credit_limit)?t:void 0),[f,w]=(0,u.useState)(!1),_=(0,u.useRef)(null),{authUser:N}=(0,D.Z2)(),C=s.user_id===(null==N?void 0:N.uid),P=(0,F.f)(U),E=!s.joined_at||""===s.joined_at,{isPaidPlan:k}=(0,y.cb)(l.plan),S=(0,x.BK)(),L=c.ss.some(e=>n.includes(e)),T=n.includes(c.eZ.AddWorkspaceCollaborators),R=n.includes(c.eZ.AddWorkspaceViewers),M=n.includes(c.eZ.AddWorkspaceEditors),et=n.includes(c.eZ.AddWorkspaceAdmins),es=n.includes(c.eZ.AddWorkspaceOwners),ea=(0,c.mk)(s.role,C,n),er=n.includes(c.eZ.UpdateWorkspaceCreditLimit),{updateWorkspaceMemberRole:el}=function(e){let{workspaceId:t}=e,s=(0,Z.jE)(),a=(0,Q.H)(),{mutateAsync:r}=(0,H.n)({mutationFn:async e=>{let{userId:s,role:a}=e,r=(0,o.P)();return await r.put("/workspaces/".concat(t,"/memberships/").concat(s),{role:a})},onMutate:async e=>{await (0,J.Pf)(s,t),(0,J.I7)(s,t,a,t=>t.map(t=>t.user_id===e.userId?{...t,role:e.role}:t))},onSuccess:async e=>{e&&(0,J.I7)(s,t,a,t=>t.map(t=>t.user_id===e.user_id?e:t)),await s.invalidateQueries({queryKey:[...q.workspaceKeys.detail(t),"memberships"],refetchType:"all"}),await s.invalidateQueries({queryKey:q.workspaceKeys.detail(t),refetchType:"all"})},onError:()=>{(0,J.y)(s,t,a,{refetch:!0})}});return{updateWorkspaceMemberRole:r}}({workspaceId:r}),{updateWorkspaceMemberCreditLimit:en}=function(e){let{workspaceId:t}=e,s=(0,Z.jE)(),a=(0,Q.H)(),{mutateAsync:r}=(0,H.n)({mutationFn:async e=>{let{userId:s,monthlyCreditLimit:a}=e,r=(0,o.P)();await r.put("/user/workspaces/".concat(t,"/memberships/").concat(s),{monthly_credit_limit:null!=a?a:-1})},onMutate:async e=>{await (0,J.Pf)(s,t),(0,J.I7)(s,t,a,t=>t.map(t=>t.user_id===e.userId?{...t,monthly_credit_limit:-1===e.monthlyCreditLimit?null:e.monthlyCreditLimit}:t))},onError:e=>{(0,z.Ni)(e)},onSettled:()=>{(0,J.y)(s,t,a)}});return{updateWorkspaceMemberCreditLimit:r}}({workspaceId:r}),{removeWorkspaceMember:ei}=function(e){let{workspaceId:t}=e,s=(0,Z.jE)(),a=(0,Q.H)(),r=(0,$.mb)(e=>{var t;return null==(t=e.project)?void 0:t.id}),{mutateAsync:l}=(0,H.n)({mutationFn:async e=>{let{userId:s}=e,a=(0,o.P)();await a.delete("/workspaces/".concat(t,"/memberships/").concat(s))},onMutate:async e=>{await (0,J.Pf)(s,t),(0,J.I7)(s,t,a,t=>t.filter(t=>t.user_id!==e.userId),void 0,e=>Math.max(0,e-1))},onError:e=>{(0,z.Ni)(e)},onSettled:()=>{(0,J.y)(s,t,a,{refetch:!0,invalidateAll:!0}),r&&s.invalidateQueries({queryKey:q.gO.collaborators(r),refetchType:"active"})}});return{removeWorkspaceMember:l}}({workspaceId:r}),eo=(0,u.useCallback)(async e=>{E||await en({userId:s.user_id,monthlyCreditLimit:isNaN(null!=e?e:0)?-1:e})},[s.user_id,E,en]);(0,u.useEffect)(()=>{let e=e=>{f&&_.current&&!_.current.contains(e.target)&&eo(m).then(()=>{w(!1)})};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[f,m,en,eo]);let ec=async e=>{if(!E){if("admin"===e&&!k)return void S(x.KU.PRO_CHANGE_ADMIN_ROLE);if("viewer"===e&&!k)return void S(x.KU.PRO_CHANGE_VIEWER_ROLE);try{await el({userId:s.user_id,role:e})}catch(e){(0,z.Ni)(e)}}},ed=()=>{P({childProps:{memberName:s.display_name||s.email||s.username,memberRole:s.role,onConfirm:async()=>{await ei({userId:s.user_id}),P(!1)},onCancel:()=>P(!1)}})},eu=(0,Y.ZS)();return(0,a.jsxs)(A.Hj,{className:E?"opacity-60":"",children:[(0,a.jsx)(A.nA,{children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(I.UserAvatar,{user:{id:s.user_id,username:s.display_name||s.email}}),(0,a.jsx)("div",{className:"flex flex-col",children:(0,a.jsxs)("span",{className:"font-medium",children:[s.display_name||s.email,C&&(0,a.jsx)("span",{className:"font-normal",children:" (you)"})]})})]})}),(0,a.jsx)(A.nA,{children:(0,a.jsx)("span",{className:"text-sm",children:s.email})}),(0,a.jsx)(A.nA,{children:(0,a.jsxs)(B.rI,{children:[(0,a.jsxs)(j.m_,{children:[(0,a.jsx)(j.k$,{asChild:!0,children:(0,a.jsx)(B.ty,{asChild:!0,disabled:!ea||!L,children:(0,a.jsxs)(g.$,{"aria-haspopup":"true",variant:"ghost",size:"sm",className:"h-auto px-2 py-1 font-normal",children:[X[s.role],ea&&L&&(0,a.jsx)(v.A,{name:"chevron_down",size:"small",className:"ml-1 h-4 w-4 opacity-50"})]})})}),(0,a.jsx)(j.ZI,{className:"max-w-[30ch]",children:E?"This user has been invited to join as ".concat(X[s.role]):ee[s.role]})]}),(0,a.jsx)(B.SQ,{align:"end",children:E?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(K.t,{label:"Remove",destructive:!0,onClick:ed,disabled:!ea})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(K.t,{label:X.owner,isSelected:"owner"===s.role,onClick:()=>ec("owner"),disabled:!es||!ea,tooltip:ee.owner}),(0,a.jsx)(K.t,{label:X.admin,isSelected:"admin"===s.role,onClick:()=>ec("admin"),disabled:(!et||!ea)&&k,tooltip:ee.admin,rightElement:(0,a.jsx)(V.M,{workspace:l,requiredPlanCategory:"pro"})}),(0,a.jsx)(K.t,{label:X.member,isSelected:"member"===s.role,onClick:()=>ec("member"),disabled:!M||!ea,tooltip:ee.member}),(0,a.jsx)(K.t,{label:X.viewer,isSelected:"viewer"===s.role,onClick:()=>ec("viewer"),disabled:(!R||!ea)&&k,tooltip:k?ee.viewer:"Viewer role requires a Pro plan. Click to upgrade.",rightElement:(0,a.jsx)(V.M,{workspace:l,requiredPlanCategory:"pro"})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(K.t,{label:X.collaborator,isSelected:"collaborator"===s.role,onClick:()=>ec("collaborator"),disabled:!T||!ea||"collaborator"!==s.role,tooltip:"collaborator"===s.role?ee.collaborator:void 0}),"collaborator"!==s.role&&(0,a.jsxs)(j.m_,{delayDuration:0,disableHoverableContent:!1,children:[(0,a.jsx)(j.k$,{asChild:!0,children:(0,a.jsx)("div",{className:"absolute right-4 top-1/2 z-10 -translate-y-1/2 cursor-default select-none rounded p-0.5 hover:bg-accent",onPointerDown:e=>{e.stopPropagation(),e.preventDefault()},onClick:e=>{e.stopPropagation(),e.preventDefault()},children:(0,a.jsx)(v.A,{name:"info",size:"xsmall",className:"opacity-60 hover:opacity-100"})})}),(0,a.jsx)(j.ZI,{className:"max-w-[280px]",side:"right",onPointerDownOutside:e=>e.preventDefault(),onClick:e=>e.preventDefault(),children:"You can only add collaborators by inviting them to individual projects. Existing workspace members cannot be changed to collaborators."})]})]}),(0,a.jsx)(K.t,{label:C?"Leave":"Remove",destructive:!0,onClick:ed,disabled:!ea})]})})]})}),(0,a.jsx)(A.nA,{children:E?(0,a.jsx)(W.E,{variant:"secondary",children:"Pending"}):(0,a.jsx)(W.E,{variant:"default",children:"Active"})}),(0,a.jsx)(A.nA,{className:"text-right",children:i?(0,a.jsxs)("span",{className:"text-sm",children:[(0,G.Q)(i)," credits"]}):(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"-"})}),(0,a.jsx)(A.nA,{className:"text-right",children:d?(0,a.jsxs)("span",{className:"text-sm font-medium",children:[(0,G.Q)(d)," credits"]}):(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"-"})}),(0,a.jsx)(A.nA,{className:"text-right",children:(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:(e=>{if(!e||""===e)return"Not yet joined";try{let t=new Date(e);if(isNaN(t.getTime()))return"Not yet joined";return(0,O.GP)(t,"MMM d, yyyy")}catch(e){return"Not yet joined"}})(p||s.joined_at)})}),(0,a.jsx)(A.nA,{children:(0,a.jsx)("div",{className:"flex items-center justify-end gap-2",children:er&&eu&&!E&&(0,a.jsxs)(j.m_,{delayDuration:600,children:[(0,a.jsx)(j.k$,{asChild:!0,children:f?(0,a.jsx)("div",{ref:_,className:"relative flex items-center",children:(0,a.jsx)(b.p,{placeholder:"Limit",value:m||"",className:"h-7 w-20 text-xs",onChange:e=>h(parseInt(e.target.value)),onKeyDown:e=>{if("Enter"===e.key)eo(m).then(()=>{w(!1)});else if("Escape"===e.key){var t;h(null!=(t=s.monthly_credit_limit)?t:void 0),w(!1)}},autoFocus:!0})}):(0,a.jsx)(g.$,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs",onClick:()=>w(!0),children:(null==s?void 0:s.monthly_credit_limit)?"".concat(s.monthly_credit_limit,"/mo"):"No limit"})}),(0,a.jsx)(j.ZI,{className:"max-w-[30ch]",children:"Update credit limits for this member"})]})})})]})},es={owner:5,admin:4,member:3,viewer:2,collaborator:1},ea=e=>{let{members:t,workspace:s,permissions:r,currentMonthUsage:l,totalUsage:n,isLoading:i}=e,{authUser:o}=(0,D.Z2)(),c=null==o?void 0:o.uid,[d,p]=(0,u.useState)(null),[m,h]=(0,u.useState)("asc"),[x]=(0,u.useState)(()=>new Date().getMonth()+1),[f]=(0,u.useState)(()=>new Date().getFullYear()),b=(0,u.useMemo)(()=>t.map(e=>{let t=null==l?void 0:l.user_usages.find(t=>t.user_id===e.user_id),s=null==n?void 0:n.find(t=>t.user_id===e.user_id);return{...e,currentMonthUsage:(null==t?void 0:t.count)||0,totalUsage:(null==s?void 0:s.count)||0,dateJoined:e.joined_at}}),[t,l,n]),j=(0,u.useMemo)(()=>{let e=d?[...b]:b;if(d&&(e=e.sort((e,t)=>{let s,a;switch(d){case"name":s=e.display_name||e.email,a=t.display_name||t.email;break;case"email":s=e.email,a=t.email;break;case"role":s=es[e.role]||0,a=es[t.role]||0;break;case"currentUsage":s=e.currentMonthUsage||0,a=t.currentMonthUsage||0;break;case"totalUsage":s=e.totalUsage||0,a=t.totalUsage||0;break;case"dateJoined":s=e.dateJoined||"",a=t.dateJoined||"";break;default:return 0}return"currentUsage"===d||"totalUsage"===d||"role"===d?"asc"===m?s-a:a-s:s<a?"asc"===m?-1:1:s>a?"asc"===m?1:-1:0})),!d&&c){let t=e.findIndex(e=>e.user_id===c);t>0&&(e=[e[t],...e.slice(0,t),...e.slice(t+1)])}return e},[b,d,m,c]),w=e=>{d===e?h("asc"===m?"desc":"asc"):(p(e),h("asc"))},y=e=>{let{field:t}=e;return d!==t?(0,a.jsx)(v.A,{name:"unfold_more",className:"ml-2 h-4 w-4"}):"asc"===m?(0,a.jsx)(v.A,{name:"chevron_up",className:"ml-2 h-4 w-4"}):(0,a.jsx)(v.A,{name:"chevron_down",className:"ml-2 h-4 w-4"})};return i?(0,a.jsx)("div",{className:"flex items-center justify-center py-8 text-sm text-muted-foreground",children:"Loading members..."}):0===t.length?(0,a.jsx)("div",{className:"flex items-center justify-center py-8 text-sm text-muted-foreground",children:"No members found"}):(0,a.jsx)("div",{className:"w-full",children:(0,a.jsxs)(A.XI,{children:[(0,a.jsx)(A.A0,{children:(0,a.jsxs)(A.Hj,{children:[(0,a.jsx)(A.nd,{className:"w-[250px]",children:(0,a.jsxs)(g.$,{variant:"ghost",className:"h-auto p-0 font-medium hover:bg-transparent",onClick:()=>w("name"),children:["Member",(0,a.jsx)(y,{field:"name"})]})}),(0,a.jsx)(A.nd,{children:(0,a.jsxs)(g.$,{variant:"ghost",className:"h-auto p-0 font-medium hover:bg-transparent",onClick:()=>w("email"),children:["Email",(0,a.jsx)(y,{field:"email"})]})}),(0,a.jsx)(A.nd,{children:(0,a.jsxs)(g.$,{variant:"ghost",className:"h-auto p-0 font-medium hover:bg-transparent",onClick:()=>w("role"),children:["Role",(0,a.jsx)(y,{field:"role"})]})}),(0,a.jsx)(A.nd,{children:"Status"}),(0,a.jsx)(A.nd,{className:"text-right",children:(0,a.jsxs)(g.$,{variant:"ghost",className:"h-auto p-0 font-medium hover:bg-transparent",onClick:()=>w("currentUsage"),children:[(0,O.GP)(new Date(f,x-1),"MMM")," Usage",(0,a.jsx)(y,{field:"currentUsage"})]})}),(0,a.jsx)(A.nd,{className:"text-right",children:(0,a.jsxs)(g.$,{variant:"ghost",className:"h-auto p-0 font-medium hover:bg-transparent",onClick:()=>w("totalUsage"),children:["Total Usage",(0,a.jsx)(y,{field:"totalUsage"})]})}),(0,a.jsx)(A.nd,{className:"text-right",children:(0,a.jsxs)(g.$,{variant:"ghost",className:"h-auto p-0 font-medium hover:bg-transparent",onClick:()=>w("dateJoined"),children:["Date Joined",(0,a.jsx)(y,{field:"dateJoined"})]})}),(0,a.jsx)(A.nd,{className:"text-right",children:"Limits"})]})}),(0,a.jsx)(A.BF,{children:j.map(e=>(0,a.jsx)(et,{currentMembership:e,workspace:s,workspaceId:s.id,permissions:r,currentMonthUsage:e.currentMonthUsage,totalUsage:e.totalUsage,dateJoined:e.dateJoined},"".concat(e.email,"-").concat(e.user_id)))})]})})},er=[{label:"All",value:"all"},{label:"Active",value:"active"},{label:"Pending",value:"pending"}],el=[{label:"Owner",value:"owner"},{label:"Admin",value:"admin"},{label:"Editor",value:"member"},{label:"Viewer",value:"viewer"},{label:"Collaborator",value:"collaborator"}],en=e=>{let{currentPage:t,totalPages:s,onPreviousPage:r,onNextPage:l,onFirstPage:n,onLastPage:i,totalCount:o,pageSize:c}=e;if(s<=1)return null;let d=Math.min(t*c,o);return(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Showing ",(t-1)*c+1,"-",d," of ",o," members"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(g.$,{variant:"outline",size:"sm",onClick:n,disabled:1===t,children:(0,a.jsx)(v.A,{name:"first_page",className:"h-4 w-4"})}),(0,a.jsx)(g.$,{variant:"outline",size:"sm",onClick:r,disabled:1===t,children:(0,a.jsx)(v.A,{name:"chevron_left",className:"h-4 w-4"})}),(0,a.jsxs)("span",{className:"text-sm font-medium",children:[t," of ",s]}),(0,a.jsx)(g.$,{variant:"outline",size:"sm",onClick:l,disabled:t===s,children:(0,a.jsx)(v.A,{name:"chevron_right",className:"h-4 w-4"})}),(0,a.jsx)(g.$,{variant:"outline",size:"sm",onClick:i,disabled:t===s,children:(0,a.jsx)(v.A,{name:"last_page",className:"h-4 w-4"})})]})]})},ei=e=>{var t;let{memberships:s,workspace:r,searchParams:l,search:n,total:o,isLoading:E,PAGE_SIZE:k}=e,[I,A]=(0,u.useState)(l.status||"all"),[S,L]=(0,u.useState)(l.query||""),[T,O]=(0,u.useState)(l.roles||el.map(e=>e.value)),[D]=(0,u.useState)(()=>new Date().getMonth()+1),[F]=(0,u.useState)(()=>new Date().getFullYear()),{permissions:M}=(0,m.S)(),U=M.includes(c.eZ.ViewWorkspaceUsage),W=M.includes(c.eZ.ViewWorkspaceMembers)&&U,B=c.ss.some(e=>M.includes(e)),{data:K}=(0,i.I)({..._.y.workspaceUsage({workspaceId:r.id,month:D,year:F}),permission:c.eZ.ViewWorkspaceUsage,enabled:U}),{data:V}=(0,i.I)({..._.y.workspaceUserTotalUsage({workspaceId:r.id}),permission:c.eZ.ViewWorkspaceUsage,enabled:U}),{data:z}=(0,d.I)(_.y.projectAccessRequests(r.id)),Y=(0,w.d)(S,250);(0,u.useEffect)(()=>{if(0===T.length)return;let e=Y;e.length<3&&(e=""),n({query:e,offset:0,status:I,roles:T.length===el.length?void 0:T})},[Y,I,T,n]);let G="free"===(0,y.m6)(r.plan),Z=(0,x.BK)(),{inviteWorkspaceMember:H,isInvitingMember:$}=(0,P.s)({workspaceId:r.id}),{exportMembers:q,isExporting:Q}=function(e){let[t,s]=(0,u.useState)(!1);return{exportMembers:async()=>{try{s(!0);let t=await C.tokenManager.getValidToken(),a={};t&&(a.Authorization="Bearer ".concat(t));let r=(0,N.N)(),l=await fetch("".concat(r,"/workspaces/").concat(e,"/memberships/export"),{method:"GET",headers:a,credentials:"include"});if(!l.ok)throw Error("Export failed: ".concat(l.statusText));let n=l.headers.get("Content-Disposition"),i=new Date,o=e=>String(e).padStart(2,"0"),c="workspace_members_".concat(i.getUTCFullYear(),"-").concat(o(i.getUTCMonth()+1),"-").concat(o(i.getUTCDate()),"_").concat(o(i.getUTCHours()),"-").concat(o(i.getUTCMinutes()),".csv");if(n){let e=n.match(/filename="([^"]+)"/i);(null==e?void 0:e[1])&&(c=e[1])}let d=await l.blob(),u=URL.createObjectURL(d),p=document.createElement("a");return p.href=u,p.download=c,p.style.visibility="hidden",document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(u),{success:!0}}catch(e){return console.error("Failed to export members:",e),{success:!1,error:e}}finally{s(!1)}},isExporting:t}}(r.id),J=async()=>{let e=p.toast.loading("Preparing CSV export..."),t=await q();(null==t?void 0:t.success)?p.toast.success("Export ready. Download should begin shortly.",{id:e,duration:4e3}):p.toast.error("Export failed. Please try again.",{id:e})},X=async e=>{let{emails:t,role:s}=e;if(0===t.length)return{success:!1};if("admin"===s&&G)return Z(x.KU.PRO_SEND_ADMIN_INVITE),{success:!1};if("viewer"===s&&G)return Z(x.KU.PRO_SEND_VIEWER_INVITE),{success:!1};let a=0;for(let e of t)await H({email:e,role:s}),a++;return{success:a>0}},ee=e=>{L(e)};return(0,a.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"Invite new members"}),(0,a.jsx)(h.M,{onInvite:e=>{let{emails:t,role:s}=e;return X({emails:t,role:s})},isInviting:$,roleOptions:[{value:"admin",label:"Admin"},{value:"member",label:"Editor"},{value:"viewer",label:"Viewer"}],defaultRole:"member",placeholder:"Add emails",completelyDisabled:!B,workspace:r})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"Members"}),(S||"all"!==I||T.length<el.length)&&(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:[o," members found"]})]}),W&&(0,a.jsxs)(j.m_,{children:[(0,a.jsx)(j.k$,{asChild:!0,children:(0,a.jsx)(g.$,{variant:"outline",size:"sm",onClick:J,disabled:Q,"aria-label":"Export members CSV",children:Q?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v.A,{name:"refresh",className:"mr-1 h-4 w-4 animate-spin"}),"Exporting..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v.A,{name:"download",className:"mr-1 h-4 w-4"}),"Export"]})})}),(0,a.jsx)(j.ZI,{align:"end",children:"Exports all workspace members as a CSV, including monthly usage and credit limits."})]})]}),z&&z.length>0&&(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("h4",{className:"text-sm font-medium",children:["Access Requests (",z.length,")"]}),(0,a.jsx)("div",{className:"rounded-lg border",children:(0,a.jsx)(R,{requests:z})})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(v.A,{name:"search",className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,a.jsx)(b.p,{type:"text",placeholder:"Search members by name or email...",value:S,onChange:e=>ee(e.target.value),className:"pl-9"}),S&&(0,a.jsx)(g.$,{variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 h-6 w-6 -translate-y-1/2 p-0",onClick:()=>ee(""),children:(0,a.jsx)(v.A,{name:"x",className:"h-3 w-3"})})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:justify-between",children:[(0,a.jsx)("div",{className:"flex gap-2",children:er.map(e=>{let{label:t,value:s}=e;return(0,a.jsx)(g.$,{variant:I===s?"default":"outline",size:"sm",onClick:()=>{A(s)},className:"text-xs",children:t},s)})}),(0,a.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,a.jsx)("h5",{className:"m-2 text-xs font-medium text-muted-foreground",children:"Filter by role"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-3",children:el.map(e=>{let{label:t,value:s}=e;return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(f.S,{id:"role-".concat(s),checked:T.includes(s),onCheckedChange:()=>(e=>{O(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])})(s)}),(0,a.jsx)("label",{htmlFor:"role-".concat(s),className:"cursor-pointer select-none text-sm",children:t})]},s)})})]})]}),(0,a.jsx)("div",{className:"rounded-lg border",children:0===T.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,a.jsx)(v.A,{name:"person",className:"mb-4 h-12 w-12 text-muted-foreground"}),(0,a.jsx)("h3",{className:"mb-2 text-lg font-medium",children:"No roles selected"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Please select at least one role above to view members"})]}):(0,a.jsx)(ea,{members:s,workspace:r,permissions:M,currentMonthUsage:K,totalUsage:V,isLoading:E})}),T.length>0&&(0,a.jsx)(en,{currentPage:Math.floor((null!=(t=l.offset)?t:0)/k)+1,totalPages:Math.ceil(o/k),onPreviousPage:()=>{var e;return n({offset:Math.max(0,(null!=(e=l.offset)?e:0)-k)})},onNextPage:()=>{var e;return n({offset:(null!=(e=l.offset)?e:0)+k})},onFirstPage:()=>n({offset:0}),onLastPage:()=>n({offset:Math.floor((o-1)/k)*k}),totalCount:o,pageSize:k})]})]})};var eo=s(25080);let ec=20,ed=e=>{let{workspace:t}=e,{maxSeats:s,isLoadingMaxSeats:r,memberCount:d}=function(e){let{data:t,isLoading:s}=(0,i.I)({queryKey:["workspace",e,"maxSeats"],queryFn:async()=>{let t=(0,o.P)();return(await t.get("/workspaces/".concat(e,"/max-seats"))).max_seats},permission:c.eZ.ViewWorkspaceMembers,enabled:!!e}),{builderCount:a}=(0,eo.Ft)({workspaceId:e});return{maxSeats:t,isLoadingMaxSeats:s,memberCount:a}}(t.id),u=function(e,t,s,r){return(0,a.jsxs)(a.Fragment,{children:["Inviting people to ",(0,a.jsx)("strong",{children:e.name||"the workspace"})," gives access to workspace shared projects and credits."," ",null!=s?(0,a.jsxs)(a.Fragment,{children:["You're using ",t,"/",r?"...":s," builder",1===t?"":"s",". Need more?"," ",(0,a.jsx)(l(),{className:"underline",target:"_blank",href:"https://enterpriseform.lovable.app/",children:"Contact us"}),"."]}):(0,a.jsxs)(a.Fragment,{children:["You have ",t," builder",1===t?"":"s"," in this workspace."]})]})}(t,d,s,r),{members:p,total:m,isLoading:h,search:x,searchParams:g}=(0,eo._A)({workspaceId:t.id});return(0,a.jsx)(n.Pt,{title:"People",value:"people",description:u,docsLink:"https://docs.lovable.dev/user-guides/teams",children:(0,a.jsx)(Q.k,{searchParams:g,children:(0,a.jsx)(ei,{memberships:p,workspace:t,searchParams:g,search:x,total:m,isLoading:h,PAGE_SIZE:ec})})})}},82149:(e,t,s)=>{"use strict";s.d(t,{ProjectProvider:()=>j,vd:()=>N,mb:()=>C,Om:()=>y,Iw:()=>_});var a=s(77145),r=s(6698),l=s(81496),n=s(13410),i=s(95661),o=s(31088),c=s(84510),d=s(40702),u=s(83220),p=s(28717),m=s(87299),h=s(63851),x=s(19620),g=s(69850),f=s(35418),v=s(7204);let b=(0,i.createContext)(null),j=e=>{let{children:t,projectId:s}=e;return(0,a.jsx)(w,{projectId:s,children:t},s)},w=e=>{let{children:t,projectId:s}=e,j=(0,i.useRef)((0,c.vt)(()=>({projectId:s,project:void 0,isLoading:!0,isDeleting:!1,hasPermissionDenied:!1}))),[w,y]=(0,i.useState)(0),_=(0,n.useRouter)(),{isAuthenticated:N}=(0,d.Z2)(),{userData:C}=(0,p.ur)(),P=(0,u.Ic)(),E=(0,u.zC)(),k=(0,u.j4)(e=>e.currentWorkspace);!function(e,t){let s=(0,i.useRef)(!1),a=(0,m.jE)();(0,i.useEffect)(()=>{e&&t&&!s.current&&(async()=>{try{let r=(0,h.P)();await r.post("/projects/".concat(e,"/mark-viewed"),{workspace_id:t}),s.current=!0,a.invalidateQueries({queryKey:[...g.workspaceKeys.detail(t),"recently-viewed-projects"],exact:!1}),a.refetchQueries({queryKey:[...g.workspaceKeys.detail(t),"recently-viewed-projects"],exact:!1,type:"active"})}catch(s){x.logging.error("Failed to mark project viewed",{error:s,projectId:e,workspaceId:t})}})()},[e,t,a])}(s,null==k?void 0:k.id),(0,i.useEffect)(()=>{if(!s)return;let e=(0,l.H9)(f.db,"projects",s),t=(0,l.aQ)(e,e=>{let t=e.data();t&&!t.deleted_at?(j.current.setState({project:t,isLoading:!1,hasPermissionDenied:!1}),t.workspace_id&&P(s,t.workspace_id)):j.current.getState().isDeleting||(x.logging.error("PROJECT NOT FOUND",{projectId:s,docExists:e.exists(),userId:null==C?void 0:C.id}),_.push("/projects/not-found"))},e=>{x.logging.error("PROJECT PERMISSION ERROR",{error:e,projectId:s}),"permission-denied"===e.code?j.current.setState({hasPermissionDenied:!0,isLoading:!1}):(j.current.setState({isLoading:!1}),o.toast.error("Error",{description:"Failed to fetch project."}))});return()=>{t(),E()}},[s,C,N,_,w,E,P]);let I=(0,r.n)({mutationFn:async e=>{let{project:t}=j.current.getState();if(!t)return;let a=(0,h.P)();await a.put("/projects/".concat(s),e)},onMutate:e=>{let t=j.current,{project:s}=t.getState();s&&t.setState({project:{...s,...e}})},throwOnError:!0}),A=(0,r.n)({mutationFn:e=>e?(0,h.P)().put("/projects/".concat(s,"/visibility"),{visibility:e}):Promise.resolve(),onSuccess:(e,t)=>{"public"===t?o.toast.success("Visibility updated",{description:"Your project is now public."}):"private"===t?o.toast.success("Visibility updated",{description:"Your project is now private."}):"draft"===t?o.toast.success("Visibility updated",{description:"Your project is now personal."}):o.toast.success("Visibility updated")},onError:()=>{o.toast.error("Error",{description:"Failed to update visibility"})}}),S=(0,r.n)({mutationFn:async e=>{let t=(0,h.P)(),a=await t.post("/projects/".concat(s,"/badge/visibility"),{hide_badge:e});try{await (0,v.o)({projectId:s})}catch(e){x.logging.error("Error updating deployment",{error:e})}return a}});((e,t)=>{let s=(0,i.useRef)(void 0);return(0,i.useEffect)(()=>{"pending"===e?s.current=o.toast.loading(t.pending.title,t.pending.options):"success"===e?s.current?(o.toast.success(t.success.title,{id:s.current,...t.success.options,duration:3e3,dismissible:!1}),s.current=void 0):o.toast.success(t.success.title,t.success.options):"error"===e&&(s.current?(o.toast.error(t.error.title,{id:s.current,...t.error.options,duration:3e3,dismissible:!1}),s.current=void 0):o.toast.error(t.error.title,t.error.options))},[e])})(S.status,{pending:{title:"Updating badge visibility..."},success:{title:"Badge visibility updated"},error:{title:"Failed to update badge visibility",options:{duration:3,description:"We couldn't update the badge visibility right now. Please try again in a few minutes."}}});let L=(0,i.useCallback)(()=>{y(e=>e+1)},[]),T=(0,r.n)({mutationFn:e=>(0,h.P)().put("/projects/".concat(s),{publish_visibility:e}),onError:e=>{o.toast.error("Error",{description:e.message||"Failed to update website access"})}}),R={store:j.current,updateProject:(e,t)=>{I.mutate(e,{onSuccess:()=>{(null==t?void 0:t.onSuccess)&&t.onSuccess()},onError:e=>{(null==t?void 0:t.onError)&&t.onError(e)}})},setVisibilityMutation:A,setBadgeVisibility:S.mutateAsync,setPublishVisibility:T,refetchProject:L};return(0,a.jsx)(b.Provider,{value:R,children:t})};function y(){let e=(0,i.useContext)(b);if(!e)throw Error("useProjectContext must be used within a ProjectProvider");return e}function _(e){let{store:t}=y();return t(e)}function N(){let e=(0,i.useContext)(b);if(e)return e}function C(e){let t=N();return null==t?void 0:t.store(e)}},83022:(e,t,s)=>{"use strict";s.d(t,{O:()=>c});var a=s(77145),r=s(46753),l=s.n(r),n=s(95290),i=s(52811),o=s(19695);let c=e=>{let{type:t,variant:s,onClick:r,href:c,isExternal:d,text:u,showTooltip:p,tooltipContent:m,disabled:h,loading:x,testId:g}=e;return"link"===t?(0,a.jsx)(i.$,{variant:s,asChild:!0,onClick:r,className:d?"h-9 w-full whitespace-nowrap":"h-9",children:(0,a.jsx)(l(),{href:c,passHref:!0,target:d?"_blank":void 0,children:u})}):(0,a.jsx)(o.Q,{showTooltip:p||!1,tooltipContent:m||"",delayDuration:300,children:(0,a.jsx)(n.oO,{onClick:r,variant:s,disabled:h,loading:x,className:"h-9","data-testid":g,children:u})})}},83220:(e,t,s)=>{"use strict";s.d(t,{cA:()=>C,zC:()=>L,Dx:()=>P,j4:()=>k,QY:()=>A,nu:()=>I,Ic:()=>S});var a=s(77145),r=s(18502),l=s(13410),n=s(95661),i=s(31088),o=s(84510),c=s(40702),d=s(28717),u=s(92034),p=s(56455),m=s(19620),h=s(99989),x=s(49493),g=s(87299),f=s(6698),v=s(83473),b=s(63851),j=s(69850),w=s(49974),y=s(91169),_=s(45756);let N=(0,n.createContext)(null);function C(e){var t,s,C,P;let E,{children:k,initialWorkspaceId:I}=e,{allWorkspaces:A,isLoading:S}=(0,x.Mu)(e=>({allWorkspaces:e.workspaces,isLoading:e.isLoading})),L=null!=(t=null==A?void 0:A[0])?t:null,T=(0,n.useRef)((0,o.vt)(e=>({currentWorkspace:null,membership:null,hasFetchedCurrentWorkspace:!1,projectId:null,projectWorkspaceId:null,currentUserSelectedWorkspaceId:null,setProjectWorkspaceOverride:(t,s)=>e({projectId:t,projectWorkspaceId:s}),clearProjectWorkspaceOverride:()=>e({projectId:null,projectWorkspaceId:null}),setCurrentUserSelectedWorkspaceId:t=>e({currentUserSelectedWorkspaceId:t})}))),R=T.current,O=R(e=>e.projectId),D=R(e=>e.projectWorkspaceId),F=!!O&&!!D,M=R(e=>e.currentUserSelectedWorkspaceId),U=(0,p.dA)(e=>e.active),{authUser:W}=(0,c.Z2)(),{userData:B}=(0,d.ur)(),K=(0,l.useRouter)(),V=(0,l.usePathname)(),z=(0,l.useSearchParams)(),Y=z.get("workspaceId"),G=(E=null!=(s=null==W?void 0:W.uid)?s:"","".concat("lovable-current-workspace-id","-").concat(E)),[Z,H]=(0,n.useState)(I),$=F?D:Z,q=(0,n.useCallback)(e=>{if(F)return void m.logging.debug("Cannot change workspace in project context",{newId:e});H(e),R.getState().setCurrentUserSelectedWorkspaceId(e);try{e?window.localStorage.setItem(G,e):window.localStorage.removeItem(G)}catch(t){m.logging.debug("Error setting current workspace id to localstorage",{error:t,newId:e})}},[G,F,R]),Q=(0,n.useCallback)(()=>{let e=new URLSearchParams(z);e.delete("workspace");let t=e.toString(),s=window.location.hash,a="".concat(V).concat(t?"?".concat(t):"").concat(s);K.replace(a,{scroll:!1})},[K,V,z]),J=(0,n.useRef)(!1);(0,n.useEffect)(()=>{F||W&&!S&&(()=>{if(J.current){!Z&&(null==L?void 0:L.id)&&q(L.id);return}if(I&&A){if(A.some(e=>e.id===I)){q(I),Q(),J.current=!0;return}i.toast.error("The workspace you're trying to access is not available"),Q()}try{let e=window.localStorage.getItem(G);if(e&&A&&A.some(t=>t.id===e)){q(e),J.current=!0;return}}catch(e){m.logging.debug("Error getting current workspace id from localstorage",{error:e})}if(null==L?void 0:L.id){q(L.id),J.current=!0;return}q(null),J.current=!0})()},[W,A,S,I,null==L?void 0:L.id,Z,G,q,Q,F]);let{data:X,isLoading:ee,isError:et}=(0,r.I)({...h.y.detail({workspaceId:null!=$?$:"",projectId:F?O:void 0}),enabled:!!$&&!U});!et||U||F||q(null!=(C=null==L?void 0:L.id)?C:null);let{data:es}=(0,r.I)({...h.y.detail({workspaceId:null!=Y?Y:"",projectId:void 0}),enabled:!F&&!!Y});!function(e){let{authUser:t,currentWorkspaceId:s,userData:a,isLoadingAllWorkspaces:r,currentWorkspace:l,isProjectScoped:i}=e,[o,c]=(0,n.useState)(!1),{toCheckout:d}=(0,y.R)(),u=(0,n.useCallback)(async()=>{if((null==t?void 0:t.uid)&&s&&!o)try{let e=localStorage.getItem(w.LS);if(!e)return;let t=JSON.parse(e),a=Date.now()-t.timestamp;if(localStorage.removeItem(w.LS),a>36e5)return;c(!0),await d({plan:t.planId,workspaceId:s})}catch(e){m.logging.error("Error processing pending plan selection",{error:e,userId:null==t?void 0:t.uid,workspaceId:s}),localStorage.removeItem(w.LS)}},[null==t?void 0:t.uid,s,o,d]);(0,n.useEffect)(()=>{i||!t||!s||r||o||(null==a?void 0:a.segmentation_form_status)!==_.C.SUBMITTED||(null==l?void 0:l.plan)==="free"&&u()},[i,t,null==l?void 0:l.plan,s,r,o,u,null==a?void 0:a.segmentation_form_status])}({authUser:W,currentWorkspaceId:Z,userData:null!=B?B:null,isLoadingAllWorkspaces:S,currentWorkspace:null!=(P=null==X?void 0:X.workspace)?P:null,isProjectScoped:F}),function(e){let{allWorkspaces:t,isLoadingAllWorkspaces:s,workspaceDataForUnacceptedInvites:a,setCurrentWorkspaceId:r,authUser:o,isProjectScoped:c}=e,d=(0,l.useRouter)(),u=(0,l.usePathname)(),p=(0,l.useSearchParams)(),m=(0,n.useRef)(new Set),h=p.get("workspaceId"),{store:w}=(0,x.k9)(),y=(0,g.jE)(),_=(0,n.useCallback)(()=>{let e=new URLSearchParams(p);e.delete("workspaceId"),d.replace("".concat(u,"?").concat(e.toString()),{scroll:!1})},[d,u,p]),{mutate:N}=(0,f.n)({mutationFn:async e=>{let t=(0,b.P)();return await t.put("/user/workspaces/".concat(e.id,"/accept-invite")),e},onSuccess:e=>{r(e.id),_(),m.current.has(e.id)||(i.toast.success(e.name?'Switched to "'.concat(e.name,'" workspace'):"Switched to workspace"),null==w||w.setState({workspaces:[...t,e]})),m.current.add(e.id)},onError:(e,t)=>{m.current.has(t.id)||(_(),m.current.add(t.id),(0,v.Ni)(e))},onSettled:()=>{y.invalidateQueries({queryKey:j.workspaceKeys.all})},retry:!1});(0,n.useEffect)(()=>{if(!c){if(h&&!o&&!s)return void d.replace("/login");h&&!s&&(null==a?void 0:a.workspace)&&!m.current.has(a.workspace.id)&&N(a.workspace)}},[c,N,s,null==a?void 0:a.workspace,h,o,d,u,p])}({allWorkspaces:A,isLoadingAllWorkspaces:S,authUser:W,workspaceDataForUnacceptedInvites:null!=es?es:{workspace:null},setCurrentWorkspaceId:q,isProjectScoped:F}),(0,n.useEffect)(()=>{var e,t;T.current.setState({currentWorkspace:null!=(e=null==X?void 0:X.workspace)?e:null,membership:null!=(t=null==X?void 0:X.current_member)?t:null})},[null==X?void 0:X.workspace,null==X?void 0:X.current_member]),(0,n.useEffect)(()=>{T.current.setState({hasFetchedCurrentWorkspace:!ee})},[ee]),(0,n.useEffect)(()=>{W||(T.current.setState({currentWorkspace:null,membership:null,hasFetchedCurrentWorkspace:!1}),J.current=!1)},[W]);let ea=(0,u.O)();(0,n.useEffect)(()=>(F?null==ea||ea.setProjectWorkspaceId(null!=$?$:null):null==ea||ea.setCurrentWorkspaceId(null!=Z?Z:null),()=>{F?null==ea||ea.setProjectWorkspaceId(null):null==ea||ea.setCurrentWorkspaceId(null)}),[Z,$,ea,F]);let er=(0,n.useMemo)(()=>({store:T.current,setCurrentWorkspaceId:F?()=>{}:q,currentWorkspaceId:F?D:Z,currentUserSelectedWorkspaceId:M,isProjectScoped:F}),[T.current,F,Z,M,q]);return(0,a.jsx)(N.Provider,{value:er,children:k})}function P(){let e=(0,n.useContext)(N);if(!e)throw Error("useCurrentWorkspaceContext must be used within a CurrentWorkspaceProvider");return e}function E(){return(0,n.useContext)(N)}function k(e){let{store:t}=P();if(!t)throw Error("useCurrentWorkspaceStore must be used within a CurrentWorkspaceProvider");return t(e)}function I(e){let t=E(),s=null==t?void 0:t.store;return s?s(e):null}function A(){var e;let t=E();return null!=(e=null==t?void 0:t.isProjectScoped)&&e}function S(){let{store:e}=P();if(!e)throw Error("useSetProjectWorkspaceOverride must be used within a CurrentWorkspaceProvider");return e.getState().setProjectWorkspaceOverride}function L(){let{store:e}=P();if(!e)throw Error("useClearProjectWorkspaceOverride must be used within a CurrentWorkspaceProvider");return e.getState().clearProjectWorkspaceOverride}},85062:(e,t,s)=>{"use strict";s.d(t,{O:()=>i});var a=s(77145),r=s(52873),l=s(47226),n=s(56024);let i=e=>{let{showEnterpriseCard:t=!1,className:s}=e;return(0,a.jsxs)("div",{className:(0,n.cn)("flex w-full flex-col gap-4",s),children:[(0,a.jsxs)("div",{className:"grid w-full grid-cols-1 gap-5 sm:grid-cols-3",children:[(0,a.jsxs)(r.Zp,{className:"flex h-full flex-col gap-3 px-4 py-6",children:[(0,a.jsx)(l.E,{className:"h-6 w-24"}),(0,a.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,a.jsx)(l.E,{className:"h-9 w-20"}),(0,a.jsx)(l.E,{className:"h-5 w-16"})]}),(0,a.jsx)(l.E,{className:"h-4 w-full"}),(0,a.jsx)(l.E,{className:"mb-2 h-9 w-full"}),(0,a.jsx)(l.E,{className:"h-9 w-full"}),(0,a.jsxs)("div",{className:"mt-2 flex flex-col gap-4",children:[(0,a.jsx)(l.E,{className:"h-4 w-32"}),(0,a.jsx)("div",{className:"flex flex-col gap-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)(l.E,{className:"h-4 w-4"}),(0,a.jsx)(l.E,{className:"h-4 w-full"})]})})]})]}),(0,a.jsxs)(r.Zp,{className:"flex h-full flex-col gap-3 px-4 py-6",children:[(0,a.jsx)(l.E,{className:"h-6 w-24"}),(0,a.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,a.jsx)(l.E,{className:"h-9 w-20"}),(0,a.jsx)(l.E,{className:"h-5 w-16"})]}),(0,a.jsx)(l.E,{className:"h-4 w-full"}),(0,a.jsx)(l.E,{className:"mb-2 h-9 w-full"}),(0,a.jsx)(l.E,{className:"h-9 w-full"}),(0,a.jsxs)("div",{className:"mt-2 flex flex-col gap-4",children:[(0,a.jsx)(l.E,{className:"h-4 w-32"}),(0,a.jsx)("div",{className:"flex flex-col gap-4",children:[1,2,3,4,5].map(e=>(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)(l.E,{className:"h-4 w-4"}),(0,a.jsx)(l.E,{className:"h-4 w-full"})]},e))})]})]}),(0,a.jsxs)(r.Zp,{className:"flex h-full flex-col gap-3 px-4 py-6",children:[(0,a.jsx)(l.E,{className:"h-6 w-24"}),(0,a.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,a.jsx)(l.E,{className:"h-9 w-20"}),(0,a.jsx)(l.E,{className:"h-5 w-16"})]}),(0,a.jsx)(l.E,{className:"h-4 w-full"}),(0,a.jsx)(l.E,{className:"mb-2 h-9 w-full"}),(0,a.jsx)(l.E,{className:"h-9 w-full"}),(0,a.jsxs)("div",{className:"mt-2 flex flex-col gap-4",children:[(0,a.jsx)(l.E,{className:"h-4 w-32"}),(0,a.jsx)("div",{className:"flex flex-col gap-4",children:[1,2,3].map(e=>(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)(l.E,{className:"h-4 w-4"}),(0,a.jsx)(l.E,{className:"h-4 w-full"})]},e))})]})]})]}),t&&(0,a.jsxs)(r.Zp,{className:"flex w-full flex-col items-center justify-between gap-4 px-4 py-6 md:flex-row",children:[(0,a.jsxs)("div",{className:"flex flex-shrink flex-col gap-2",children:[(0,a.jsx)(l.E,{className:"h-6 w-32"}),(0,a.jsx)(l.E,{className:"h-4 w-64"})]}),(0,a.jsx)(l.E,{className:"h-9 w-36"})]})]})}},87252:(e,t,s)=>{"use strict";s.d(t,{Q:()=>o,V:()=>i});let a={MAX_DISPLAY_DECIMAL_PLACES:1},r=a.MAX_DISPLAY_DECIMAL_PLACES+1,l=Math.pow(10,a.MAX_DISPLAY_DECIMAL_PLACES),n=Math.pow(10,r),i=e=>Number.isFinite(e)?Math.round(e*n)/n:0,o=e=>{if(!Number.isFinite(e)||e<0)return"0";let t=Math.round(e*l)/l;return t===Math.floor(t)?t.toLocaleString():t.toLocaleString(void 0,{minimumFractionDigits:a.MAX_DISPLAY_DECIMAL_PLACES,maximumFractionDigits:a.MAX_DISPLAY_DECIMAL_PLACES})}},90249:(e,t,s)=>{"use strict";s.d(t,{Q:()=>l});var a=s(95661);let r=["brand-ocean-primary","brand-twilight-primary","brand-flamingo-primary","brand-bubblegum-primary","brand-saffron-primary","brand-tiger-primary"];function l(e){return(0,a.useMemo)(()=>{e||(e="fake-user");let t=function(e){let t=0;for(let s=0;s<e.length;s++)t=(t<<5)-t+e.charCodeAt(s),t&=t;return Math.abs(t)}(e)%r.length;return r[t]},[e])}},91169:(e,t,s)=>{"use strict";s.d(t,{R:()=>C,d:()=>P});var a=s(77145),r=s(6698),l=s(13410),n=s(92912),i=s(95661),o=s(31088),c=s(92918),d=s(28717),u=s(24500),p=s(83473),m=s(63851),h=s(19620),x=s(39528),g=s(72632),f=s(76058),v=s(21227),b=s(27835);let j="settings",w="billing",y="plan_type",_="redirect",N=(0,i.createContext)(void 0),C=()=>{let e=(0,i.useContext)(N);if(!e)throw Error("useSubscription must be used within a SubscriptionProvider");return e},P=e=>{let{children:t}=e,[s,C]=(0,i.useState)(!1),[P,E]=(0,i.useState)(!1),[k,I]=(0,i.useState)(!1),[A,S]=(0,i.useState)(!1),L=(0,l.useSearchParams)(),{userData:T}=(0,d.ur)(),R=(0,c._C)(c.PostHogExperiment.LITE_PRICING),O=L.get("checkoutCode"),D=null==T?void 0:T.pending_promotion_code,F=O||D||void 0,M=(0,r.n)({mutationFn:async e=>{var t;let{plan:s,workspaceId:a,grandfatheredDiscount:r=!1,planType:l="monthly",changeType:n,useStudentDiscount:i=!1}=e;C(s);let o=new URL(window.location.href),c=(e=>{let{currentUrl:t,planId:s,changeType:a}=e,r=new URL(t);return r.searchParams.set("payment_status",b.Yv),r.searchParams.set(b.a_,s),a&&r.searchParams.set(b.wB,a),r.toString()})({currentUrl:o,planId:s,changeType:n}),d=(e=>{let{currentUrl:t,planId:s,planType:a,changeType:r}=e,l=new URL("".concat(window.location.origin).concat("/purchase-success"));if("/profile/plans"===window.location.pathname)l.searchParams.set(_,window.location.origin);else{let e=new URL(t);t.searchParams.has(j)&&t.searchParams.get(j)===w&&e.searchParams.set(j,w),r&&e.searchParams.set(b.wB,r),e.searchParams.set(y,a),l.searchParams.set(_,e.toString())}return l.searchParams.set(b.a_,s),l.searchParams.set(y,a),l.toString()})({currentUrl:o,planId:s,planType:l,changeType:n}),u=(0,g.h5)(s,l);if(u===f.Sf.KTLO&&R)switch(R){case"variant1":u=f.Q3.KTLO_1;break;case"variant2":u=f.Q3.KTLO_2}let p=(0,v.D)(),h={price_lookup_key:u,quantity:1,cancel_url:c,success_url:d,client_reference_id:null==(t=window.Rewardful)?void 0:t.referral,workspace_id:a,with_discount:r,coupon_code:F,use_student_discount:i,tracking_data:p};return(0,m.P)().post("/workspaces/".concat(a,"/stripe/checkout"),h)},onSuccess:e=>{window.location.assign(e.url)},onMutate:e=>{let{plan:t}=e;C(t),n.Ay.capture(x.nA.CREDIT_PLAN_CHECKOUT_CLICKED,{coupon_code:F,new_plan:t})},onError:e=>{h.logging.error("error_creating_checkout_session",{error:e}),(0,p.Ni)(e)},onSettled:()=>{C(!1)}}),U=async e=>{let{plan:t,workspaceId:s,grandfatheredDiscount:a=!1,planType:r="monthly",changeType:l,useStudentDiscount:n=!1}=e;try{await M.mutateAsync({plan:t,workspaceId:s,grandfatheredDiscount:a,planType:r,changeType:l,useStudentDiscount:n})}catch(e){}},W=async e=>{let{workspaceId:t}=e;try{E(!0);let e=(0,m.P)(),s=await e.post("/workspaces/".concat(t,"/stripe/portal-session"),{return_url:window.location.href});window.location.assign(s.url)}catch(e){e instanceof u.L&&"network_error"===e.type&&o.toast.error("Network error: Please check your internet connection and try again."),h.logging.error("error_creating_portal_session",{error:e})}finally{E(!1)}},B=async e=>{let{workspaceId:t}=e;try{I(!0);let e=(0,m.P)();await e.post("/workspaces/".concat(t,"/stripe/cancel-subscription")),o.toast.success("Subscription canceled successfully",{description:"Your subscription will remain active until the end of your current billing period."})}catch(e){(0,p.Ni)(e)}finally{I(!1)}},K=async e=>{let{workspaceId:t}=e;try{S(!0);let e=(0,m.P)();await e.post("/workspaces/".concat(t,"/stripe/cancel-changes")),o.toast.success("Subscription changes canceled successfully",{description:"Any pending subscription changes have been canceled."})}catch(e){(0,p.Ni)(e)}finally{S(!1)}};return(0,a.jsx)(N.Provider,{value:{checkoutLoading:s,isCreatePortalSessionLoading:P,isCancelSubscriptionLoading:k,isCancelSubscriptionChangesLoading:A,toCheckout:U,createPortalSession:W,cancelSubscription:B,cancelSubscriptionChanges:K},children:t})}},92034:(e,t,s)=>{"use strict";s.d(t,{B:()=>o,O:()=>c});var a=s(77145),r=s(92912),l=s(95661),n=s(84510);let i=(0,l.createContext)(null),o=e=>{let{children:t}=e,s=(0,l.useRef)((0,n.vt)(()=>({projectWorkspaceId:null,currentWorkspaceId:null}))),o=(0,l.useCallback)(()=>{let{projectWorkspaceId:e,currentWorkspaceId:t}=s.current.getState();r.Ay.group("workspace",e||t||"none"),r.Ay.reloadFeatureFlags()},[]),c=(0,l.useCallback)(e=>{s.current.setState({projectWorkspaceId:e}),o()},[o]),d=(0,l.useCallback)(e=>{s.current.setState({currentWorkspaceId:e}),o()},[o]),u={store:s.current,setProjectWorkspaceId:c,setCurrentWorkspaceId:d};return(0,a.jsx)(i.Provider,{value:u,children:t})};function c(){let e=(0,l.useContext)(i);if(!e)throw Error("usePostHogGroupContext must be used within a PostHogGroupProvider");return e}},92763:(e,t,s)=>{"use strict";s.d(t,{S:()=>i});var a=s(92918),r=s(69994),l=s(72632),n=s(94087);let i=e=>{let t=(0,r.D)(null!=e?e:null),s=(0,n.Q)(a.PostHogExperiment.BUILD_CREDIT_TOP_UPS,{control:!1,test:!0});if(!e)return{canTopUpCredits:!1,isLowOnCredits:!1};let{isProPlan:i,isBizPlan:o}=(0,l.cb)(e.plan);return{canTopUpCredits:s&&(i||o),isLowOnCredits:t.totalRemaining<5}}},92918:(e,t,s)=>{"use strict";s.d(t,{Jp:()=>f,PostHogExperiment:()=>x,Tp:()=>b,_C:()=>j,ct:()=>N,jD:()=>w});var a=s(77145),r=s(13410),l=s(92912),n=s(24072),i=s(95661),o=s(55966),c=s(15365),d=s(19620),u=s(680),p=s(40702),m=s(40074);let h=(0,i.lazy)(()=>Promise.all([s.e(6415),s.e(1131),s.e(6975)]).then(s.bind(s,46975)).then(e=>({default:e.FeatureFlagDebugDialog})));var x=function(e){return e.LITE_PRICING="lite-plan-pricing-test",e.CLONE_BUTTON="clone-button",e.BUILD_CREDIT_TOP_UPS="build-topup-credits",e.DASHBOARD_V2_EXPERIMENT="dashboard-v2-experiment",e}({});let g=(0,i.createContext)(void 0),f=()=>{let e=(0,i.useContext)(g);if(!e)throw Error("useFeatureFlagContext must be used within a PostHogFlagsContext in the PosthogProvider");return e},v={},b=e=>{let{featureFlags:t,featureFlagOverrides:s}=f();return void 0!==s[e]?s[e]:!!(null==t?void 0:t[e])},j=e=>{let{featureFlags:t}=f();return null==t?void 0:t[e]},w=()=>({openFeatureFlagDebugDialog:f().openFeatureFlagDebugDialog}),y="phc_xdBVCyOkYw40Pqd7xp5Er88lGq2IGFd4kZHRiKvvkjr",_=y&&!0;function N(e){let{children:t,bootstrapData:s}=e,{authUser:d}=(0,p.Z2)(),x=(0,p.Nm)(),f=(0,i.useMemo)(()=>null==d?void 0:d.uid,[null==d?void 0:d.uid]),b=(0,i.useMemo)(()=>null==d?void 0:d.displayName,[null==d?void 0:d.displayName]),j=(0,c.E$)(),[w,N]=(0,i.useState)(!1),[C,P]=(0,i.useState)(v);(0,o.vC)("ctrl+shift+f",e=>{e.preventDefault(),N(e=>!e)},{enabled:!!j},[j]);let E=(0,i.useMemo)(()=>({featureFlags:null==s?void 0:s.featureFlags,featureFlagOverrides:C,openFeatureFlagDebugDialog:j?()=>N(!0):void 0}),[null==s?void 0:s.featureFlags,C,j]),k=(0,i.useCallback)(e=>{let{target:t,action:s}=e;if("bulk"===t){let e=Object.values(u.x);switch(s){case"enable_all":P(Object.fromEntries(e.map(e=>[e,!0])));break;case"disable_all":P(Object.fromEntries(e.map(e=>[e,!1])));break;case"clear_all":P(v)}}else P(e=>({...e,[t]:s}))},[]);(0,i.useEffect)(()=>{f&&o11y.setUser({id:f})},[f]),(0,i.useEffect)(()=>{_&&f&&(l.Ay.identify(f,{email:x,name:b}),l.Ay.capture("github_branch",{branch:m.env.BRANCH||null}))},[f,x,b]),(0,i.useEffect)(()=>{_&&l.Ay.init(y,{api_host:"https://lovable.dev/ingest",ui_host:"https://us.posthog.com",bootstrap:s,session_recording:{maskAllInputs:!1,maskInputOptions:{password:!0}},autocapture:{element_allowlist:["button"]},verbose:!1})},[s]);let I=(0,r.usePathname)();return(0,i.useEffect)(()=>{l.Ay.capture("$pageview")},[I]),(0,a.jsx)(g.Provider,{value:E,children:(0,a.jsxs)(n.so,{client:l.Ay,children:[t,j&&w&&(0,a.jsx)(i.Suspense,{fallback:null,children:(0,a.jsx)(h,{open:w,onOpenChange:N,featureFlagOverrides:C,onFeatureFlagOverrideChange:k,originalFlags:(null==s?void 0:s.featureFlags)||{}})})]})})}y||d.logging.info("Missing NEXT_PUBLIC_POSTHOG_KEY in env; set to 'skip' to disable")},94087:(e,t,s)=>{"use strict";s.d(t,{Q:()=>l});var a=s(92912),r=s(92918);function l(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"control",l=(0,r._C)(e),n=t[s];return(a.Ay.capture("$feature_flag_called",{$feature_flag_response:l,$feature_flag:e}),"boolean"!=typeof l&&l&&l in t)?t[l]:n}},95290:(e,t,s)=>{"use strict";s.d(t,{Mt:()=>u,kp:()=>h,oO:()=>p,vi:()=>m});var a=s(77145),r=s(95661),l=s(76449),n=s(67844),i=s(52811),o=s(69730),c=s(72632),d=s(56024);let u=e=>{let{name:t,title:s,plan:r,planType:i,description:o,discountedPrice:u,children:p,savingsAmount:m,showSavingsAsPercentage:h=!1,hidePrice:x=!1,isPopular:g=!1,customPriceLabel:f,priceSuffix:v,isScheduled:b,className:j,highlighted:w,priceSubtitle:y}=e,_=(0,c.jL)({id:r,type:i});return(0,a.jsxs)("div",{className:(0,d.cn)("flex h-full w-full max-w-[360px] flex-col gap-4 rounded-xl border border-muted-border p-4 pb-6 sm:max-w-none lg:max-w-[280px]",{"bg-muted":g},{"border-brand-twilight-primary bg-brand-twilight-primary/10":w},j),children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,a.jsx)("p",{className:"text-xl font-medium",children:t}),(0,a.jsx)("div",{className:"min-h-11 text-sm text-foreground lg:min-h-16",children:s})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsx)("div",{className:(0,d.cn)("flex items-baseline",{invisible:x}),children:f?(0,a.jsx)("span",{className:"flex min-h-11 items-center text-base tabular-nums text-muted-foreground",children:f}):(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"flex min-h-11 items-center gap-2",children:[(0,a.jsxs)("p",{className:(0,d.cn)("text-3xl font-medium tabular-nums",u&&"text-muted-foreground line-through"),children:["$",_]}),u&&(0,a.jsxs)("p",{className:"px-1 text-3xl font-medium tabular-nums",children:["$",u]}),(0,a.jsx)("p",{className:"text-base text-muted-foreground",children:null!=v?v:"per month"})]})})}),y&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:y})]}),(0,a.jsx)("div",{className:"-mx-4 flex h-16 items-center border-y border-muted-border px-4 py-2",children:(0,a.jsxs)("div",{className:"flex w-full items-center gap-2",children:["string"==typeof o?(0,a.jsx)("p",{className:"flex-1 text-sm text-muted-foreground",children:o}):(0,a.jsx)("div",{className:"flex-1",children:o}),m&&"Coming soon"!==o&&!b&&m>0&&(0,a.jsx)(n.E,{variant:"success",className:"rounded-full bg-success",children:(0,a.jsx)(l.F,{isShimmering:!0,variant:"success",className:(0,d.cn)("flex min-h-8 flex-col justify-center text-base font-normal text-success-foreground","md:text-sm xl:text-base",{"md:text-xs":m>=100}),children:(0,a.jsx)("div",{className:"text-center",children:h?"Save ".concat(m,"%"):"Save $".concat(m.toLocaleString())})})})]})}),p]})},p=e=>{let{children:t,onClick:s,className:l,...n}=e,[o,c]=(0,r.useState)(!1),u=async()=>{c(!0),await (null==s?void 0:s()),c(!1)};return(0,a.jsx)(i.$,{onClick:u,...n,loading:o,className:(0,d.cn)("w-full",l),children:t})},m=e=>{let{children:t,className:s}=e;return(0,a.jsx)("div",{className:(0,d.cn)("flex flex-col justify-start gap-2",s),children:t})},h=e=>{let{label:t,features:s}=e;return(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsx)("p",{className:"text-sm text-foreground",children:t}),(0,a.jsx)("ul",{className:"flex flex-col gap-4 text-base md:text-sm",children:s.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)(o.A,{name:"check",size:"small",className:"relative top-[2px]"}),(0,a.jsx)("span",{className:"text-foreground",children:e})]},t))})]})}},98324:e=>{e.exports={shimmerText:"ShimmeringText_shimmerText__SMwG_",shimmer:"ShimmeringText_shimmer__1AZHS",shimmerTextSuccess:"ShimmeringText_shimmerTextSuccess__itzB9"}},98635:(e,t,s)=>{"use strict";s.d(t,{M:()=>h});var a=s(77145),r=s(95661),l=s(55966),n=s(31088),i=s(52811),o=s(8711),c=s(69730),d=s(51747),u=s(5379),p=s(43987);let m=e=>{var t,s;let{selectedRole:l,onRoleChange:n,roleOptions:d,disabled:u=!1,workspace:m}=e,[h,x]=(0,r.useState)(!1);return u?(0,a.jsx)(i.$,{variant:"ghost",size:"sm",className:"flex-shrink-0 gap-1.5 font-normal",disabled:!0,children:null==(s=d.find(e=>e.value===l))?void 0:s.label}):(0,a.jsxs)(o.rI,{open:h,onOpenChange:x,children:[(0,a.jsx)(o.ty,{asChild:!0,children:(0,a.jsxs)(i.$,{variant:"ghost",size:"sm",className:"flex-shrink-0 gap-1.5 font-normal",children:[null==(t=d.find(e=>e.value===l))?void 0:t.label,(0,a.jsx)(c.A,{name:"chevron_down",size:"small"})]})}),(0,a.jsx)(o.SQ,{children:(0,a.jsx)(o.Hr,{value:l,onValueChange:e=>{n(e),x(!1)},children:d.map(e=>(0,a.jsxs)(o.Ht,{value:e.value,className:"hover:bg-accent",children:[e.label,("read"===e.value||"viewer"===e.value||"admin"===e.value)&&m&&(0,a.jsx)(p.M,{workspace:m,requiredPlanCategory:"pro"})]},e.value))})})]})},h=e=>{let{onInvite:t,isInviting:s,roleOptions:o,defaultRole:c,placeholder:p="Add emails",completelyDisabled:h=!1,onInputChange:x,workspace:g}=e,[f,v]=(0,r.useState)([]),[b,j]=(0,r.useState)(""),[w,y]=(0,r.useState)(c),_=f.length>0||""!==b.trim(),N=async()=>{let e=[...f],s=b.trim();if(""===s||f.includes(s)||(e.push(s),v(e),j("")),0===e.length)return;if(e.length>0&&!e.every(e=>(0,d.xf)(e)))return void(1===e.length?n.toast.error("Invalid email address",{description:"Please check the email address and try again."}):n.toast.error("Invalid email address",{description:"One or more email addresses are invalid. Please check and try again."}));let{success:a}=await t({emails:e,role:w});a&&(v([]),j(""),null==x||x(""))};(0,l.vC)("mod+enter",e=>{e.preventDefault(),s||N()},{enableOnFormTags:!0});let C=""===b.trim()&&0===f.length;return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(u.u,{tags:f,setTags:v,inputValue:b,setInputValue:e=>{j(e),null==x||x(e)},placeholder:p,disabled:h,className:"min-w-0 flex-1",validateItem:e=>(0,d.xf)(e)?null:"This is not a valid email."}),_&&(0,a.jsx)(m,{selectedRole:w,onRoleChange:y,roleOptions:o,workspace:g}),(0,a.jsx)(i.$,{onClick:N,variant:"affirmative",className:"flex-shrink-0",disabled:s||C||h,loading:s,children:"Invite"})]})}}}]);